import{p as I}from"./index-1qao1M8l.js";import{_ as V,B as E}from"./index-Dr3A69Vy.js";import{m as w,A as g,z as i,f as z,l as U,I as N,n as G,R,E as J}from"./vuetify-8yKwgmF2.js";import{a2 as _,a3 as f,a4 as a,u as l,a6 as p,W as n,a7 as y,Y as h,ac as $,a9 as S,G as M,$ as F,Q as O,S as T}from"./@vue-CVhpfiSJ.js";import{_ as P,a as L}from"./CustomTextFieldTranslit-_r0XMlwr.js";import{_ as H}from"./CustomEntitySelector-Dr1atJmJ.js";import{_ as W}from"./BlockContacts-BCeKsCVJ.js";import{_ as Y}from"./index-CPWUxclh.js";import{C as q}from"./cropperjs-BcPO2UKZ.js";import{_ as Q}from"./CustomDate-CfhxorUI.js";import{_ as K}from"./CustomGender-NBBuUwfP.js";import{b as A}from"./route-block-B_A1xBdJ.js";import"./arabic-transliterate-CaB0grAR.js";import"./@turf-BykKS3Vs.js";import"./md5-Ct8Y5Pza.js";import"./crypt-VTvMai_Y.js";import"./charenc-DuOFFKym.js";import"./is-buffer-DMJNLjvk.js";import"./dot-object-sCKibp8s.js";import"./uuid-C6aID195.js";/* empty css             */import"./pinia-DJQ_g8GY.js";import"./pinia-plugin-persistedstate-Bx52SgID.js";import"./destr-BPvN1X9m.js";import"./deep-pick-omit-CegYQlcN.js";import"./pinia-shared-state-C4xqZbDc.js";import"./broadcast-channel-TeH36tNo.js";import"./oblivious-set-DL5W-sud.js";import"./dexie-DU0pVwlp.js";import"./@azure-suSn7m2_.js";import"./bson-objectid-DhxNlv_d.js";import"./joi-BOBjTjze.js";import"./comlink-B8fJUUNV.js";import"./vue-i18n-rpOKKwMw.js";import"./@intlify-DAAxr81y.js";import"./axios-xsH4HHeE.js";import"./jszip-B9I6jZYU.js";import"./echarts-B3RPNoSA.js";import"./zrender-BxIUiisS.js";import"./@faker-js-9AjqWMS-.js";import"./jwt-decode-VWaDGczM.js";import"./vue-router-V8rnRB0-.js";import"./maska-DMix1GTA.js";import"./debouncer-Whu4ZLob.js";import"./CustomTag-Dg3cr3e-.js";import"./CustomEmail-Pezh8A6E.js";import"./CustomPhone-XOzdDG_n.js";const{users:X}=I,Z={name:"BlockSumbission",inject:["$confirm","$error","$loading","$showResult"],props:{modelValue:{type:Object,default:()=>({})},table:{type:String,default:"entity"}},computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},isAdmin(){var e,t,s;return(s=(t=(e=this.appStore)==null?void 0:e.user)==null?void 0:t.role)==null?void 0:s.includes("Admin")}},methods:{async save(){if(!await this.$confirm({title:"Save entity",description:"Would you like to save the entity?"}))return!1;this.$loading(!0),this.model=X.preprocess(this.model),await this.$nextTick(),this.model.role=["Partner Manager"],this.model.privacyConsent=!0,this.model.termsConsent=!0;let t;try{const s=this.$storage.users;this.model.id||(t=await s.push(this.model)),this.model.id&&(t=await s.update(this.model.id,this.model))}catch(s){t=!1,await this.$error(s)}if(this.$loading(!1),!t)return!1;this.model.id=t.id,this.$route.fullPath==="/users/me"&&(this.appStore.user=this.model),await this.$showResult(),this.goBack()},async remove(){if(!await this.$confirm({title:"Delete entity",description:"Would you like to save the entity?"}))return!1;this.$loading(!0);try{const t=this.$storage.users;await delete t[this.model.id]}catch(t){return await this.$error(t),this.$loading(!1)}await this.$showResult(),this.goBack()},goBack(){var t,s,d;if(((d=(s=(t=this.$router.options)==null?void 0:t.history)==null?void 0:s.state)==null?void 0:d.back)===this.$route.path||this.$route.path.match(/\/login/))return this.$router.push("/");this.$goToPreviousPage()}}},x={class:"text-h5 mb-2 offset-md1 black--text"};function ee(e,t,s,d,c,o){return f(),_(U,{class:"data-block user-sumbission pt-sm-4 pb-sm-4 pb-md-16",rounded:"0"},{default:a(()=>[l(w,null,{default:a(()=>[l(g,{class:"mb-sm-4 mt-4"},{default:a(()=>[l(i,{cols:"12",md:"3",class:"pl-md-16"},{default:a(()=>[p("div",x,n(e.$t("Submission")),1),p("div",null,n(e.$t("Please verify and submit your data")),1)]),_:1}),l(i,{cols:"12",md:"9",class:"pr-md-16"},{default:a(()=>[l(z,{onClick:o.save,block:e.$vuetify.display.xs,color:"primary","prepend-icon":"mdi-pencil",class:"mb-2 mr-4"},{default:a(()=>[h(n(e.$t("Save")),1)]),_:1},8,["onClick","block"]),o.isAdmin&&e.appStore.user.id!==o.model.id?(f(),_(z,{key:0,onClick:o.remove,block:e.$vuetify.display.xs,color:"error","prepend-icon":"mdi-pencil",class:"mb-2 mr-4"},{default:a(()=>[h(n(e.$t("Delete")),1)]),_:1},8,["onClick","block"])):y("",!0),l(z,{onClick:t[0]||(t[0]=u=>e.$router.go(-1)),block:e.$vuetify.display.xs,variant:"text",color:"warning","prepend-icon":"mdi-close",class:"mb-sm-2 mr-4"},{default:a(()=>[h(n(e.$t("Cancel")),1)]),_:1},8,["block"])]),_:1})]),_:1})]),_:1})]),_:1})}const te=V(Z,[["render",ee]]),le=["Not initiated","Secret is issued","TOTP is set"],ae=["Admin","Partner Representative","Partner Manager","Partner IM","Partner Editor","Distributor","Coordinator","Signer","Donor"],oe={name:"UserSecurityBlock",props:{modelValue:{type:Object,default:()=>({})}},computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},mfaStatuses(){return le},roles(){return ae}}},se={class:"text-h5 mb-2 offset-md1 black--text"};function ie(e,t,s,d,c,o){const u=P;return f(),_(U,{class:"data-block",rounded:"0"},{default:a(()=>[l(w,null,{default:a(()=>[l(g,{class:"mb-4 mt-4"},{default:a(()=>[l(i,{cols:"12",md:"3",class:"pl-md-16"},{default:a(()=>[p("div",se,[$(e.$slots,"header",{},()=>[h(n(e.$t("Security data")),1)])]),p("div",null,[$(e.$slots,"description",{},()=>[h(n(e.$t("Information about the account security")),1)])])]),_:3}),l(i,{cols:"12",md:"9",class:"pr-md-16 pt-4"},{default:a(()=>[l(g,{class:"pt-0 pb-0"},{default:a(()=>[l(i,{class:"pb-0",cols:"12",lg:"6"},{default:a(()=>[l(u,{modelValue:o.model.role[0],"onUpdate:modelValue":t[0]||(t[0]=r=>o.model.role[0]=r),items:o.roles,label:e.$t("User role")},null,8,["modelValue","items","label"])]),_:1}),e.$network.online?(f(),_(i,{key:0,class:"pb-4",cols:"12",lg:"6"},{default:a(()=>[l(u,{modelValue:o.model.mfa,"onUpdate:modelValue":t[1]||(t[1]=r=>o.model.mfa=r),items:o.mfaStatuses,label:e.$t("Multi-factor authentication")},null,8,["modelValue","items","label"])]),_:1})):y("",!0)]),_:1})]),_:1})]),_:3})]),_:3})]),_:3})}const re=V(oe,[["render",ie]]),ne=["Active","Blocked"],de={name:"UserStatusBlock",props:{modelValue:{type:Object,default:()=>({})}},computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},statuses(){return ne},isAdmin(){var e,t,s;return(s=(t=(e=this.appStore)==null?void 0:e.user)==null?void 0:t.role)==null?void 0:s.includes("Admin")}}},me={class:"text-h5 mb-2 offset-md1 black--text"},ue={class:"d-flex align-center text-body-1 mt-2",style:{height:"100%"}},pe={key:0,class:"ml-4 font-weight-bold"},ce={key:1,class:"ml-4 font-weight-bold"};function fe(e,t,s,d,c,o){const u=P;return f(),_(U,{class:"data-block user-status",rounded:"0"},{default:a(()=>[l(w,null,{default:a(()=>[l(g,{class:"mb-4 mt-4"},{default:a(()=>[l(i,{cols:"12",md:"3",class:"pl-md-16"},{default:a(()=>[p("div",me,[$(e.$slots,"itemset-header",{},()=>[h(n(e.$t("User information")),1)])]),p("div",null,[$(e.$slots,"itemset-description",{},()=>[h(n(e.$t("Additional information about the user")),1)])])]),_:3}),l(i,{cols:"12",md:"9",class:"pr-md-16 pt-4"},{default:a(()=>[l(g,{class:"pt-0 pb-0"},{default:a(()=>[l(i,{cols:"12"},{default:a(()=>[o.isAdmin?(f(),_(N,{key:0,modelValue:o.model.email,"onUpdate:modelValue":t[0]||(t[0]=r=>o.model.email=r),label:e.$t("User authentication email"),id:"email",name:"email",variant:"underlined"},null,8,["modelValue","label"])):y("",!0)]),_:1}),l(i,{cols:"12",lg:"6"},{default:a(()=>[l(u,{modelValue:o.model.status,"onUpdate:modelValue":t[1]||(t[1]=r=>o.model.status=r),items:o.statuses,label:e.$t("User status")},null,8,["modelValue","items","label"])]),_:1}),l(i,{cols:"12",lg:"6"},{default:a(()=>[p("div",ue,[l(G,{icon:"mdi-check",color:"green"}),o.model.verified?(f(),S("div",pe,n(e.$t("Email is verified")),1)):(f(),S("div",ce,n(e.$t("Email is not verified")),1))])]),_:1}),l(i,{cols:"12",class:"mt-2"},{default:a(()=>[l(R,{modelValue:o.model.privacyConsent,"onUpdate:modelValue":t[3]||(t[3]=r=>o.model.privacyConsent=r)},{label:a(()=>[p("div",null,[h(n(e.$t("I confirm that I am 18 years or older and I consent to UNHCR processing my personal data in accordance with"))+" ",1),l(J,{location:"bottom"},{activator:a(({props:r})=>[p("a",M({href:"https://vuetifyjs.com",target:"_blank"},r,{onClick:t[2]||(t[2]=F(()=>{},["stop"]))}),n(e.$t("Privacy notice")),17)]),default:a(()=>[h(" "+n(e.$t("Opens in new window")),1)]),_:1})])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:3})]),_:3})]),_:3})}const he=V(de,[["render",fe]]),ge={name:"UserOrganizationBlock",props:{modelValue:{type:Object,default:()=>({})}},$_localize:["model"],computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},disabled(){return!1}},watch:{"model.organization"(e,t){this.model.responsibleOrganization||(this.model.responsibleOrganization=[]);let s=this.model.responsibleOrganization.map(d=>d.name).indexOf(e==null?void 0:e.name);return s>-1&&this.model.responsibleOrganization.splice(s,1),!t||!Object.keys(t).length||(this.model.responsibleOrganization=[...this.model.responsibleOrganization,t]),!1}}},be={class:"text-h5 mb-2 offset-md1 black--text"};function _e(e,t,s,d,c,o){const u=H;return f(),_(U,{class:"data-block user-organization",rounded:"0"},{default:a(()=>[l(w,null,{default:a(()=>[l(g,{class:"mb-4 mt-4"},{default:a(()=>[l(i,{cols:"12",md:"3",class:"pl-md-16"},{default:a(()=>[p("div",be,[$(e.$slots,"personal-header",{},()=>[h(n(e.$t("Organization")),1)])]),p("div",null,[$(e.$slots,"personal-description",{},()=>[h(n(e.$t("Information about your organization")),1)])])]),_:3}),l(i,{cols:"12",md:"9",class:"pr-md-16 pt-0"},{default:a(()=>[l(g,null,{default:a(()=>[l(i,{cols:"12",class:"mt-1 mb-2"},{default:a(()=>[p("div",null,n(e.$t("The organization you represent and your job title")),1)]),_:1}),l(i,{cols:"12"},{default:a(()=>[l(u,{modelValue:o.model.organization,"onUpdate:modelValue":t[0]||(t[0]=r=>o.model.organization=r),disabled:o.disabled,label:e.$t("Organization name"),field:e.$i18n.locale==="en"?"name":"translation.uk.name",fields:["id","name","code","translation.uk.name"],entity:"organizations",id:"organization",name:"organization",variant:"underlined"},null,8,["modelValue","disabled","label","field"])]),_:1}),l(i,{cols:"12"},{default:a(()=>[l(N,{modelValue:e.$l_model.jobTitle,"onUpdate:modelValue":t[1]||(t[1]=r=>e.$l_model.jobTitle=r),label:e.$t("Job title"),placeholder:e.$i18n.locale==="en"?"":o.model.name,hint:e.$i18n.locale==="en"?e.$t("Translate this field by switching languages"):e.$t("This is a translated field, please don't forget to switch to English and proide the data"),id:"jobTitle",name:"jobTitle",variant:"underlined"},null,8,["modelValue","label","placeholder","hint"])]),_:1}),l(i,{cols:"12",class:"mt-1 mb-2"},{default:a(()=>[p("div",null,n(e.$t("Your profile is visible to the following organizations")),1)]),_:1}),l(i,{cols:"12",lg:"12"},{default:a(()=>[l(u,{modelValue:o.model.responsibleOrganization,"onUpdate:modelValue":t[2]||(t[2]=r=>o.model.responsibleOrganization=r),label:e.$t("List of organizations"),fields:["name","code","translation.uk.name"],field:e.$i18n.locale==="en"?"name":"translation.uk.name",entity:"organizations",multiple:"",id:"responsibleOrganization",name:"responsibleOrganization",variant:"underlined"},null,8,["modelValue","label","field"])]),_:1})]),_:1})]),_:1})]),_:3})]),_:3})]),_:3})}const $e=V(ge,[["render",_e]]);var Ve={STATIC_ASSETS_PATH:"http://localhost:3000/static/"};const ye={name:"CustomImage",props:{modelValue:{type:Array,default:()=>[]}},computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},imagePath(){return Ve.STATIC_ASSETS_PATH}},data(){return{cropper:void 0}},emits:["cropped","update:modelValue"],methods:{crop(){const e=this.cropper.getCroppedCanvas({width:1024,height:1024});this.model[0].base64=e.toDataURL("image/jpeg"),this.cropper=void 0,document.querySelector(".cropper-container").remove(),this.$emit("cropped")},setToCrop(){const e=this;setTimeout(()=>{const t=e.$refs.image,s=new q(t,{ready(){const d=this.cropper.getContainerData(),c=this.cropper.getCropBoxData(),o=Math.min(c.height,c.width);this.cropper.setCropBoxData({left:(d.width-o)/2,width:o})},cropmove(){const d=this.cropper.getCropBoxData();this.cropper.setCropBoxData({width:d.height})}});e.cropper=s},100)}}},ve={class:"crop-image"},ke={id:"image-crop-container",style:{width:"100%","max-width":"440px","min-width":"60px"}},we=["src"];function Ue(e,t,s,d,c,o){const u=Y;return f(),S("div",ve,[c.cropper?y("",!0):(f(),_(u,{key:0,modelValue:o.model,"onUpdate:modelValue":[t[0]||(t[0]=r=>o.model=r),o.setToCrop],mode:"edit",path:"images",accept:"image/png, image/gif, image/jpeg"},null,8,["modelValue","onUpdate:modelValue"])),O(p("div",ke,[o.model&&o.model.length?(f(),S("img",{key:0,ref:"image",class:"image-crop",src:o.model[0].base64||o.imagePath+o.model[0].path},null,8,we)):y("",!0)],512),[[T,c.cropper]]),O(l(z,{onClick:o.crop,color:"grey-lighten-2",class:"mt-2"},{default:a(()=>[h(n(e.$t("Save")),1)]),_:1},8,["onClick"]),[[T,c.cropper]])])}const Ne=V(ye,[["render",Ue]]),Se={name:"UserImageBlock",props:{modelValue:{type:Object,default:()=>({})}},computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},methods:{async saveImage(){const e=this.model.image[0],t=e.path.replace(/^.*?\/([^\/]+)$/,"$1"),s=e.path.replace(/^\/(.*?)\/[^\/]+$/,"$1"),d=e.base64,c=E(t,d);await this.$api.files.replace({files:[c],path:s})}}},Ce={class:"text-h5 mb-2 offset-md1 black--text"};function ze(e,t,s,d,c,o){const u=Ne;return f(),_(U,{class:"data-block user-image bg-grey-lighten-3",rounded:"0"},{default:a(()=>[l(w,null,{default:a(()=>[l(g,{class:"mb-4 mt-4"},{default:a(()=>[l(i,{cols:"12",md:"3",class:"pl-md-16"},{default:a(()=>[p("div",Ce,[$(e.$slots,"itemset-header",{},()=>[h(n(e.$t("Picture")),1)])]),p("div",null,[$(e.$slots,"itemset-description",{},()=>[h(n(e.$t("Add the person image")),1)])])]),_:3}),l(i,{cols:"12",md:"9",class:"pr-md-16 pt-4"},{default:a(()=>[l(g,{class:"pt-0 pb-0"},{default:a(()=>[l(i,{class:"pb-4",cols:"12"},{default:a(()=>[p("div",null,n(e.$t("Please upload the JPG or PNG files if possible")),1)]),_:1}),l(i,{class:"pb-0",cols:"12"},{default:a(()=>[l(u,{modelValue:o.model.image,"onUpdate:modelValue":t[0]||(t[0]=r=>o.model.image=r),onCropped:o.saveImage},null,8,["modelValue","onCropped"])]),_:1})]),_:1})]),_:1})]),_:3})]),_:3})]),_:3})}const Oe=V(Se,[["render",ze]]),Te={name:"UserBasic",props:{modelValue:{type:Object,default:()=>({})}},$_localize:["model"],computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},statuses(){return statuses}},methods:{updateName(e,t){typeof t=="string"&&(this.model[e]=this.$_translit(t))}}},Ae={class:"text-h5 mb-2 offset-md1 black--text"};function Pe(e,t,s,d,c,o){const u=L,r=K,v=Q;return f(),_(U,{class:"data-block user-basic pt-sm-4 pb-sm-4 pt-md-16",rounded:"0"},{default:a(()=>[l(w,null,{default:a(()=>[l(g,{class:"mb-4 mt-4"},{default:a(()=>[l(i,{cols:"12",md:"3",class:"pl-md-16"},{default:a(()=>[p("div",Ae,[$(e.$slots,"personal-header",{},()=>[h(n(e.$t("Personal data")),1)])]),p("div",null,[$(e.$slots,"personal-description",{},()=>[h(n(e.$t("Fill your personal data")),1)])])]),_:3}),l(i,{cols:"12",md:"9",class:"pr-md-16 pt-0"},{default:a(()=>[O(l(g,null,{default:a(()=>[l(i,{cols:"12",class:"mt-1 mb-2"},{default:a(()=>[p("div",null,n(e.$t("Please input your name in Ukrainian and check the proper transliteration below")),1)]),_:1}),l(i,{cols:"12",lg:"4"},{default:a(()=>[l(N,{modelValue:e.$l_model.familyName,"onUpdate:modelValue":[t[0]||(t[0]=m=>e.$l_model.familyName=m),t[1]||(t[1]=m=>o.updateName("familyName",m))],label:e.$t("Family name (ua)"),placeholder:e.$i18n.locale==="en"?"":o.model.name,hint:e.$i18n.locale==="en"?e.$t("Translate this field by switching languages"):"",id:"familyNameUk",name:"familyNameUk",variant:"underlined"},null,8,["modelValue","label","placeholder","hint"])]),_:1}),l(i,{cols:"12",lg:"4"},{default:a(()=>[l(N,{modelValue:e.$l_model.givenName,"onUpdate:modelValue":[t[2]||(t[2]=m=>e.$l_model.givenName=m),t[3]||(t[3]=m=>o.updateName("givenName",m))],label:e.$t("Given name (ua)"),id:"givenNameUk",name:"givenNameUk",variant:"underlined"},null,8,["modelValue","label"])]),_:1}),l(i,{cols:"12",lg:"4"},{default:a(()=>[l(N,{modelValue:e.$l_model.additionalName,"onUpdate:modelValue":[t[4]||(t[4]=m=>e.$l_model.additionalName=m),t[5]||(t[5]=m=>o.updateName("additionalName",m))],label:e.$t("Adittional name (ua)"),id:"additionalNameUk",name:"additionalNameUk",variant:"underlined"},null,8,["modelValue","label"])]),_:1})]),_:1},512),[[T,e.$i18n.locale==="uk"]]),l(g,null,{default:a(()=>[l(i,{cols:"12"},{default:a(()=>[p("div",null,n(e.$t("Please change this if the data in the international passport is different from the official transliteration")),1)]),_:1}),l(i,{cols:"12",lg:"4"},{default:a(()=>[l(u,{modelValue:o.model.familyName,"onUpdate:modelValue":t[6]||(t[6]=m=>o.model.familyName=m),label:e.$t("Family name"),variant:"underlined",id:"familyName",name:"familyName"},null,8,["modelValue","label"])]),_:1}),l(i,{cols:"12",lg:"4"},{default:a(()=>[l(u,{modelValue:o.model.givenName,"onUpdate:modelValue":t[7]||(t[7]=m=>o.model.givenName=m),label:e.$t("Given name"),name:"givenName",variant:"underlined",id:"givenName"},null,8,["modelValue","label"])]),_:1}),l(i,{cols:"6"},{default:a(()=>[l(r,{modelValue:o.model.gender,"onUpdate:modelValue":t[8]||(t[8]=m=>o.model.gender=m)},null,8,["modelValue"])]),_:1}),l(i,{cols:"6"},{default:a(()=>[l(v,{modelValue:o.model.birthday,"onUpdate:modelValue":t[9]||(t[9]=m=>o.model.birthday=m),max:new Date,label:e.$t("Birthday")},null,8,["modelValue","max","label"])]),_:1})]),_:1})]),_:1})]),_:3})]),_:3})]),_:3})}const Be=V(Te,[["render",Pe]]);var je={LANGUAGE:"uk"};const C={person:{phone:[],email:[],website:[],translation:{[je.LANGUAGE]:{}}},organization:{},responsibleOrganization:[],image:[],role:[]},B={name:"User",data:()=>({user:JSON.parse(JSON.stringify(C))}),inject:["$error"],created(){this.appStore.breadcrumb=this.title||"New user",this.init()},computed:{title(){var e,t,s,d,c,o,u;if((e=this.$route.params)!=null&&e._id&&this.$route.params._id!=="new")return this.appStore.breadcrumb=((t=this.$_translate(this.user).person)==null?void 0:t.fullName)||((d=(s=this.user)==null?void 0:s.email)==null?void 0:d.replace(/@/,"＠")),((c=this.$_translate(this.user).person)==null?void 0:c.fullName)||((u=(o=this.user)==null?void 0:o.email)==null?void 0:u.replace(/@/,"＠"))},isAdmin(){var e,t,s;return(s=(t=(e=this.appStore)==null?void 0:e.user)==null?void 0:t.role)==null?void 0:s.includes("Admin")}},methods:{async init(){let{_id:e}=this.$route.params;if(e==="me")return this.loadCurrentUser();if(!e||e==="new")return this.appStore.loading=!1,!1;this.loadData(e)},async loadCurrentUser(){var s,d,c,o,u,r,v,m;if((d=(s=this.appStore)==null?void 0:s.user)!=null&&d.id)return this.loadData(this.appStore.user.id);const{users:e}=this.$storage,t=(o=(c=this.appStore)==null?void 0:c.user)==null?void 0:o.email;if(!t)return this.user=C,this.appStore.loading=!1,!0;try{const k=await e.filter({email:t}).find();if(!k)throw"Not found";this.user=Object.assign({},C,k.items[0]),Object.defineProperty(this.user,"save",{value:k.items[0].save,enumerable:!1})}catch{return await this.$error({title:"User is not found"}),this.$router.go(-1)}(v=(r=(u=this.user)==null?void 0:u.person)==null?void 0:r.email)!=null&&v.length||(this.user.person||(this.user.person={}),(m=this.user.person.email)!=null&&m.length||(this.user.person.email=[this.user.email])),this.appStore.loading=!1},async loadData(e){const{users:t}=this.$storage;try{const s=await t[e];if(s.person||(s.person=JSON.parse(JSON.stringify(C.person)),s.person.email.push(s.email)),!s)throw"Not found";this.user=s}catch{return await this.$error({title:"User is not found"}),this.$router.go(-1)}this.appStore.loading=!1}}},De={class:"report pa-2"},Ie={class:"text-h4 font-weight-bold"};function Ee(e,t,s,d,c,o){const u=Be,r=Oe,v=W,m=$e,k=he,j=re,D=te;return f(),S("div",De,[l(g,{class:"mb-0 mt-0"},{default:a(()=>[l(i,{cols:"12",md:"12",class:"mb-0 mt-0 pb-4 pt-0 pl-md-8 pr-md-8"},{default:a(()=>[p("div",Ie,n(o.title||e.$t("New user")),1)]),_:1})]),_:1}),l(g,{class:"mb-0 mt-0"},{default:a(()=>[l(i,{cols:"12",md:"12",class:"mb-0 mt-0 pb-0 pt-0 pl-md-8 pr-md-8"},{default:a(()=>[l(u,{modelValue:e.user.person,"onUpdate:modelValue":t[0]||(t[0]=b=>e.user.person=b)},null,8,["modelValue"]),l(r,{modelValue:e.user,"onUpdate:modelValue":t[1]||(t[1]=b=>e.user=b)},null,8,["modelValue"]),l(v,{modelValue:e.user.person,"onUpdate:modelValue":t[2]||(t[2]=b=>e.user.person=b),tagEntity:"users"},null,8,["modelValue"]),l(m,{modelValue:e.user,"onUpdate:modelValue":t[3]||(t[3]=b=>e.user=b)},null,8,["modelValue"]),o.isAdmin?(f(),_(k,{key:0,modelValue:e.user,"onUpdate:modelValue":t[4]||(t[4]=b=>e.user=b)},null,8,["modelValue"])):y("",!0),o.isAdmin?(f(),_(j,{key:1,modelValue:e.user,"onUpdate:modelValue":t[5]||(t[5]=b=>e.user=b)},null,8,["modelValue"])):y("",!0),l(D,{modelValue:e.user,"onUpdate:modelValue":t[6]||(t[6]=b=>e.user=b),"back-button":"/users",table:"users"},null,8,["modelValue"])]),_:1})]),_:1})])}typeof A=="function"&&A(B);const At=V(B,[["render",Ee]]);export{At as default};
