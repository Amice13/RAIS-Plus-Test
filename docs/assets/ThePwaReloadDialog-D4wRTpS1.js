import{r as S,N as H,h as K,p as O,u as Q,O as X,s as x,P as $,i as z,Q as J,j as Z,e as E,f as ee,R as te,b as ae,m as ne,a as v,q as U,S as se,T as oe,U as re,W as ie,X as le,_ as ce,c as R,o as k,w as _,F as D,A as w,y as g,C as b}from"./index-BtIo2-Z_.js";import{V as T}from"./VBtn--bGuKZaN.js";import{u as ue,V as N,m as de}from"./VOverlay-BnbjS8dz.js";import{f as fe}from"./forwardRefs--KQCZfKO.js";import{h as me,i as ve,d as ke,j as he,e as ye,k as pe,l as _e,n as we,o as ge,g as Se}from"./index-SDX8Otz2.js";function Pe(e={}){const{immediate:c=!1,onNeedRefresh:a,onOfflineReady:t,onRegistered:o,onRegisteredSW:i,onRegisterError:l}=e;let n,d,f;const h=async(s=!0)=>{await d,f==null||f()};async function m(){if("serviceWorker"in navigator){if(n=await H(async()=>{const{Workbox:s}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:s}},[]).then(({Workbox:s})=>new s("/sw.js",{scope:"/",type:"classic"})).catch(s=>{l==null||l(s)}),!n)return;f=()=>{n==null||n.messageSkipWaiting()};{let s=!1;const y=()=>{s=!0,n==null||n.addEventListener("controlling",u=>{u.isUpdate&&window.location.reload()}),a==null||a()};n.addEventListener("installed",u=>{typeof u.isUpdate>"u"?typeof u.isExternal<"u"&&u.isExternal?y():!s&&(t==null||t()):u.isUpdate||t==null||t()}),n.addEventListener("waiting",y)}n.register({immediate:c}).then(s=>{i?i("/sw.js",s):o==null||o(s)}).catch(s=>{l==null||l(s)})}}return d=m(),h}function Ce(e={}){const{immediate:c=!0,onNeedRefresh:a,onOfflineReady:t,onRegistered:o,onRegisteredSW:i,onRegisterError:l}=e,n=S(!1),d=S(!1);return{updateServiceWorker:Pe({immediate:c,onNeedRefresh(){n.value=!0,a==null||a()},onOfflineReady(){d.value=!0,t==null||t()},onRegistered:o,onRegisteredSW:i,onRegisterError:l}),offlineReady:d,needRefresh:n}}function Re(e){const c=x(e());let a=-1;function t(){clearInterval(a)}function o(){t(),ie(()=>c.value=e())}function i(l){const n=l?getComputedStyle(l):{transitionDuration:.2},d=parseFloat(n.transitionDuration)*1e3||200;if(t(),c.value<=0)return;const f=performance.now();a=window.setInterval(()=>{const h=performance.now()-f+d;c.value=Math.max(e()-h,0),c.value<=0&&t()},d)}return re(t),{clear:t,time:c,start:i,reset:o}}const Ve=O({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,..._e({location:"bottom"}),...pe(),...ye(),...he(),...oe(),...se(de({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),be=K()({name:"VSnackbar",props:Ve(),emits:{"update:modelValue":e=>!0},setup(e,c){let{slots:a}=c;const t=Q(e,"modelValue"),{positionClasses:o}=me(e),{scopeId:i}=ue(),{themeClasses:l}=X(e),{colorClasses:n,colorStyles:d,variantClasses:f}=ve(e),{roundedClasses:h}=ke(e),m=Re(()=>Number(e.timeout)),s=S(),y=S(),u=x(!1),L=x(0),W=S(),j=$(le,void 0);z(()=>!!j,()=>{const r=J();Z(()=>{W.value=r.mainStyles.value})}),E(t,P),E(()=>e.timeout,P),ee(()=>{t.value&&P()});let V=-1;function P(){m.reset(),window.clearTimeout(V);const r=Number(e.timeout);if(!t.value||r===-1)return;const p=te(y.value);m.start(p),V=window.setTimeout(()=>{t.value=!1},r)}function I(){m.reset(),window.clearTimeout(V)}function F(){u.value=!0,I()}function A(){u.value=!1,P()}function M(r){L.value=r.touches[0].clientY}function Y(r){Math.abs(L.value-r.changedTouches[0].clientY)>50&&(t.value=!1)}function q(){u.value&&A()}const G=ae(()=>e.location.split(" ").reduce((r,p)=>(r[`v-snackbar--${p}`]=!0,r),{}));return ne(()=>{const r=N.filterProps(e),p=!!(a.default||a.text||e.text);return v(N,U({ref:s,class:["v-snackbar",{"v-snackbar--active":t.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--timer":!!e.timer,"v-snackbar--vertical":e.vertical},G.value,o.value,e.class],style:[W.value,e.style]},r,{modelValue:t.value,"onUpdate:modelValue":C=>t.value=C,contentProps:U({class:["v-snackbar__wrapper",l.value,n.value,h.value,f.value],style:[d.value],onPointerenter:F,onPointerleave:A},r.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:M,onTouchend:Y,onAfterLeave:q},i),{default:()=>{var C,B;return[we(!1,"v-snackbar"),e.timer&&!u.value&&v("div",{key:"timer",class:"v-snackbar__timer"},[v(ge,{ref:y,color:typeof e.timer=="string"?e.timer:"info",max:e.timeout,"model-value":m.time.value},null)]),p&&v("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[((C=a.text)==null?void 0:C.call(a))??e.text,(B=a.default)==null?void 0:B.call(a)]),a.actions&&v(Se,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[v("div",{class:"v-snackbar__actions"},[a.actions({isActive:t})])]})]},activator:a.activator})}),fe({},s)}}),{offlineReady:Te,needRefresh:xe,updateServiceWorker:Le}=Ce(),We={name:"ThePwaReloadDialog",computed:{model(){return this.offlineReady||this.needRefresh}},mounted(){this.offlineReady=Te,this.needRefresh=xe},data(){return{text:"Update the app",offlineReady:!1,needRefresh:!1}},methods:{close(){this.offlineReady=!1,this.needRefresh=!1},async update(){await Le(),this.needRefresh=!1}}},Ae={key:0},Be={key:1};function Ee(e,c,a,t,o,i){return k(),R(be,{"model-value":i.model,timeout:-1,color:"primary",class:"pwa-reload"},{actions:_(()=>[o.needRefresh?(k(),R(T,{key:0,onClick:i.close,variant:"text"},{default:_(()=>[b(g(e.$t("Cancel")),1)]),_:1},8,["onClick"])):w("",!0),o.needRefresh?(k(),R(T,{key:1,onClick:i.update,variant:"tonal"},{default:_(()=>[b(g(e.$t("Update")),1)]),_:1},8,["onClick"])):w("",!0),o.offlineReady?(k(),R(T,{key:2,onClick:i.close,variant:"text"},{default:_(()=>[b(g(e.$t("Ok")),1)]),_:1},8,["onClick"])):w("",!0)]),default:_(()=>[o.needRefresh?(k(),D("span",Ae,g(e.$t("Update the app")),1)):w("",!0),o.offlineReady?(k(),D("span",Be,g(e.$t("App is ready to work offline")),1)):w("",!0)]),_:1},8,["model-value"])}const Fe=ce(We,[["render",Ee]]);export{Fe as _};
