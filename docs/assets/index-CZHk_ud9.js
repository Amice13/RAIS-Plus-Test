import{_ as L}from"./CustomTable-Bsru2z3s.js";import{d as O}from"./index-D0pvfY44.js";import{_ as V,am as M,a6 as B,v as D,F as d,a as l,w as a,x as H,y as R,o,z as m,C as p,A as r,B as i,G as F,H as U,c as A}from"./index-BYWsBYtF.js";import{b as $}from"./route-block-B_A1xBdJ.js";import{a as N,V as z}from"./VRow-D5QUgmxK.js";import{V as f}from"./VBtn-DEU8AXzn.js";import{V as E}from"./VChip-BnTEbD1P.js";import{V as C}from"./index-CqdMy8lr.js";import"./CustomDate-BvE_k-Ie.js";import"./VMenu-BAWQ3Wct.js";import"./VOverlay-uyg0Ioz0.js";import"./forwardRefs-D3j0TLhE.js";import"./dialog-transition-CdzLxCw9.js";import"./VSpacer-D4hnwTqC.js";/* empty css              */import"./VAvatar-Bm8XvpvO.js";import"./VImg-wiXIkP7s.js";import"./index-bmXFo_Al.js";import"./VTextField-CLSPMm7c.js";import"./VInput-CwTs2RKk.js";import"./debouncer-Whu4ZLob.js";import"./VCard-C8It3tDs.js";import"./VContainer-rOsYQHyZ.js";import"./VList-wnBQ6eUC.js";import"./searchProcessor-BfIe0Ps2.js";import"./VDataTable-DS7yi-Dm.js";import"./VPagination-BBLVO-bG.js";import"./filter-5KaMYqe0.js";import"./VCheckboxBtn-B1hdxoeT.js";import"./VToolbar-Jw3O4Zrq.js";import"./group-BcbT0sDe.js";var I={IS_TEST:!0,FRONT_HOST:"https://raisplus-test.unhcr.in.ua",STATIC_ASSETS_PATH:"http://localhost:3000/static/",MS_APP_CLIENT_ID:"4f92930c-13d8-4c36-95d6-2f2d31727e6e",MS_APP_AUTHORITY:"https://login.microsoftonline.com/e5c37981-6664-4134-8a0c-6543d2af80be",BYPASS_MSAL:!0,LOCALE:"uk-ua",LANGUAGE:"uk",BACKEND_HOST:"http://localhost:3000/api/v1",APP_NAME:"rais-plus",APP_SHORTNAME:"RAIS+",APP_FULLNAME:"RAIS+ Ukraine Assistance Monitoring System",APP_DEFAULT_THEME:"gsc",APP_KEY:"UicablEChAKeyNOmerYONYmIkIMELACIstioNIUMItIcARterm"};const P={name:"manage-organizations",mounted(){this.appStore.loading=!1},computed:{filters(){return{}},isAdmin(){var e,s,u;return(u=(s=(e=this.appStore)==null?void 0:e.user)==null?void 0:s.role)==null?void 0:u.includes("Admin")},staticPath(){return I.STATIC_ASSETS_PATH},headers(){var s,u,c;const e=[{title:"Orangization code",align:"start",sortable:!0,value:"code"},{title:"Orangization name",align:"start",sortable:!0,value:"name"},{title:"Functional type",align:"start",value:"functionalType",filterable:!0,type:"term"},{title:"Type",align:"start",value:"type",filterable:!0,type:"term"},{title:"Status",align:"start",value:"status",filterable:!0,type:"term"},{title:"Address",align:"start",value:"address"},{title:"Contacts",align:"center",value:"contacts"}];return(c=(u=(s=this.appStore)==null?void 0:s.user)==null?void 0:u.role)!=null&&c.includes("Admin")&&e.push({title:"Edit",align:"center",value:"_id"}),e}},data(){return{showAcrhive:!1,exportLoading:!1}},methods:{pCode4ToAdmins:M,async exportData(){this.exportLoading=!0;const e=`${I.FRONT_HOST}/export/export.xlsx`,s=`${new Date().toISOString().substring(0,10)} - RAIS+ Organizations.xlsx`,{organizations:u}=this.$storage,c=["id","code","name","legalName","translation.uk.name","translation.uk.legalName","status","type","functionalType","address.pCode1","address.pCode2","address.pCode3","address.pCode4","address.admin1","address.admin2","address.admin3","address.admin4","email","phone","website","tags"],k=["ID","Legal Code","Name","Legal Name","Translated name","Translated Legal Name","Status","Type","Functional type","p-code 1","p-code 2","p-code 3","p-code 4","Admin 1","Admin 2","Admin 3","Admin 4","email","phone","website","tags"];let _=(await u.include(c).slice(0,1e4).find()).items;_=_.map(t=>{var n;return(n=t.address)!=null&&n.pCode4&&(t.address=this.pCode4ToAdmins(t.address.pCode4)),t.email&&(t.email=t.email.join(", ")),t.phone&&(t.phone=t.phone.join(", ")),t.website&&(t.website=t.website.join(", ")),t.tags&&(t.tags=t.tags.join(", ")),t});const b=c.map(t=>_.map(n=>B(t,n)));await O(e,{headers:k,columns:b},s),this.exportLoading=!1}}},Y={class:"distribution-points pa-2"},j={class:"text-h4 font-weight-bold"},G={key:0},K={class:"mt-4 mb-4"},X={class:"text-h6 title-link"},q={key:0,class:"text-caption"},J={key:1},Q={class:"text-no-wrap"},W={class:"text-no-wrap"},Z={class:"text-no-wrap"},tt={key:0,class:"text-caption text-no-wrap"},et={key:0,class:"text-caption text-no-wrap"},st={key:1,class:"text-caption text-no-wrap"},at={key:2,class:"text-caption text-no-wrap"},ot={key:0},rt={key:1},nt={key:2},it={key:3},dt={class:"text-no-wrap"};function lt(e,s,u,c,k,g){const _=D("router-link"),b=L;return o(),d("div",Y,[l(N,{class:"mb-0 mt-0"},{default:a(()=>[l(z,{cols:"12",md:"12",class:"mb-0 mt-0 pb-4 pt-0 pl-md-8 pr-md-8"},{default:a(()=>[m("div",j,[p(r(e.$t("Manage organizations"))+" ",1),g.isAdmin?(o(),d("span",G,[l(f,{onClick:g.exportData,loading:k.exportLoading,size:"small",color:"grey-dakren-4",variant:"tonal"},{default:a(()=>[p(r(e.$t("Export")),1)]),_:1},8,["onClick","loading"])])):i("",!0)])]),_:1})]),_:1}),l(N,{class:"mb-0 mt-0"},{default:a(()=>[l(z,{cols:"12",md:"12",class:"mb-0 mt-0 pb-0 pt-0 pl-md-8 pr-md-8"},{default:a(()=>[l(b,{class:"pa-6",onBtnClick:s[0]||(s[0]=t=>e.$router.push("/organizations/new")),button:e.$t("Add"),"sort-by":{key:"name",order:"desc"},filters:g.filters,headers:g.headers,"search-keys":["name","legalName","code","translation.uk.name","translation.uk.legalName"],title:e.$t("Organizations"),table:"organizations"},{"item.code":a(({item:t})=>[l(E,{label:"",size:"small"},{default:a(()=>[p(r(t.code),1)]),_:2},1024)]),"item.name":a(({item:t})=>[m("div",K,[m("div",X,[l(_,{to:`/organizations/${t.id}`,tag:"a"},{default:a(()=>[p(r(t.name),1)]),_:2},1032,["to"])]),t.legalName?(o(),d("div",q,r(t.legalName),1)):i("",!0),t.tags?(o(),d("div",J,[(o(!0),d(F,null,U(t.tags,n=>(o(),A(E,{key:n,size:"x-small",color:"primary",label:"",class:"mr-2"},{default:a(()=>[p(r(n),1)]),_:2},1024))),128))])):i("",!0)])]),"item.status":a(({item:t})=>[m("span",Q,r(e.$t(t.status)),1)]),"item.functionalType":a(({item:t})=>[m("span",W,r(e.$t(t.functionalType)),1)]),"item.type":a(({item:t})=>[m("span",Z,r(e.$t(t.type)),1)]),"item.address":a(({item:t})=>{var n,h,y,v,T,S,w,x;return[(n=t.address)!=null&&n.pCode1?(o(),d("div",tt,r(e.$t(t.address.pCode1)),1)):i("",!0),m("div",null,[(h=t.address)!=null&&h.pCode2?(o(),d("span",et,r(e.$t(t.address.pCode2))+", ",1)):i("",!0),s[2]||(s[2]=p()),(y=t.address)!=null&&y.pCode3?(o(),d("span",st,r(e.$t(t.address.pCode3))+", ",1)):i("",!0),s[3]||(s[3]=p()),(v=t.address)!=null&&v.pCode4?(o(),d("span",at,r(e.$t(t.address.pCode4))+", ",1)):i("",!0)]),m("div",null,[(T=t.address)!=null&&T.streetType?(o(),d("span",ot,r(e.$t(t.address.streetType)),1)):i("",!0),s[4]||(s[4]=p()),(S=t.address)!=null&&S.street?(o(),d("span",rt,r(t.address.street),1)):i("",!0),s[5]||(s[5]=p()),(w=t.address)!=null&&w.building?(o(),d("span",nt,r(t.address.building),1)):i("",!0),s[6]||(s[6]=p()),(x=t.address)!=null&&x.apartment?(o(),d("span",it,","+r(t.address.apartment),1)):i("",!0)])]}),"item.contacts":a(({item:t})=>{var n,h,y;return[m("div",dt,[(n=t.phone)!=null&&n.length&&t.phone[0]?(o(),A(f,{key:0,href:`tel:${t.phone[0]}`,size:"small",variant:"text",color:"primary"},{default:a(()=>[l(C,{icon:"mdi-phone"})]),_:2},1032,["href"])):i("",!0),(h=t.email)!=null&&h.length&&t.email[0]?(o(),A(f,{key:1,href:`mailto:${t.email[0]}`,size:"small",variant:"text",color:"primary"},{default:a(()=>[l(C,{icon:"mdi-email"})]),_:2},1032,["href"])):i("",!0),(y=t.website)!=null&&y.length&&t.website[0]?(o(),A(f,{key:2,href:`${t.website[0]}`,size:"small",variant:"text",color:"primary"},{default:a(()=>[l(C,{icon:"mdi-web"})]),_:2},1032,["href"])):i("",!0)])]}),"item._id":a(({item:t})=>[l(f,{color:"grey-dakren-2",onClick:n=>e.$router.push(`/organizations/${t.id}`),variant:"tonal",rounded:"1",icon:"mdi-pencil",size:"x-small"},null,8,["onClick"])]),_:2},1032,["button","filters","headers","title"])]),_:1})]),_:1}),H(l(f,{onClick:s[1]||(s[1]=t=>e.$router.push("/organizations/new")),style:{position:"fixed",bottom:"15px",right:"15px"},color:"primary",rounded:"1",icon:"mdi-plus",size:"large"},null,512),[[R,e.$vuetify.display.xs]])])}typeof $=="function"&&$(P);const Rt=V(P,[["render",lt]]);export{Rt as default};
