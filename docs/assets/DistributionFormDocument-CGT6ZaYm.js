import{_ as I,F as V,o as g,z as b,A as M,B as y,x as r,$ as q,a as o,w as u,C as x,at as Se,c as P,y as h,G as R,H as Y,ak as de,af as X,h as Ce,p as Me,u as Z,r as Pe,au as Ie,t as ee,av as $e,m as Fe,aw as Ae,q as te,a7 as De,ax as Ue,ay as L,az as le,a5 as se}from"./index-BtIo2-Z_.js";import{V as U,r as Te,g as Ee,L as Ne}from"./index-SDX8Otz2.js";import{V as D}from"./VBtn--bGuKZaN.js";import{_ as ue}from"./CustomDate-CLArRqjL.js";import{_ as me}from"./CustomGender-C5TgvEjC.js";import{p as ce}from"./index-CebfcyPH.js";import{V as f,a as w}from"./VRow-9vAZildp.js";import{b as Oe}from"./index-C5-hvfiu.js";import{u as Le,V as ae,m as Re}from"./VInput-CRZE-Mt3.js";import{V as ie,m as We}from"./VCheckboxBtn-DQUGWCnj.js";import{V as Be}from"./VProgressCircular-DNPB7izS.js";import{a as ze}from"./VDataTable-BrBBORsC.js";import{V as S}from"./VTextField-Bn35T3UG.js";import{V as Ge}from"./VChip-CKNl8kC9.js";import{_ as je,a as He}from"./CustomTextFieldTranslit-gE4NQy6n.js";import{_ as qe}from"./CustomPhone-Cd36n-GU.js";import{V as ne}from"./filter-ahsWVyiP.js";import{V as he}from"./VAutocomplete-BVJCf0KD.js";import{a as Ye}from"./data-BbwszT0d.js";import{_ as Je}from"./CustomTag-5aeppRFS.js";import{_ as Xe}from"./CustomPopulationType-DQPosMme.js";import{V as pe}from"./VAlert-Or5Mzxjd.js";import{V as Ke,a as Qe}from"./VCard-DNHZbZ5d.js";import{V as Ze}from"./VAvatar-l5UJO0sV.js";import{V as et}from"./VSkeletonLoader-BkKepelc.js";import{V as oe}from"./VCheckbox-Berrf7y1.js";/*!
 * Signature Pad v5.0.7 | https://github.com/szimek/signature_pad
 * (c) 2025 Szymon Nowak | Released under the MIT license
 */class W{constructor(e,s,n,a){if(isNaN(e)||isNaN(s))throw new Error(`Point is invalid: (${e}, ${s})`);this.x=+e,this.y=+s,this.pressure=n||0,this.time=a||Date.now()}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}equals(e){return this.x===e.x&&this.y===e.y&&this.pressure===e.pressure&&this.time===e.time}velocityFrom(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):0}}class K{static fromPoints(e,s){const n=this.calculateControlPoints(e[0],e[1],e[2]).c2,a=this.calculateControlPoints(e[1],e[2],e[3]).c1;return new K(e[1],n,a,e[2],s.start,s.end)}static calculateControlPoints(e,s,n){const a=e.x-s.x,l=e.y-s.y,i=s.x-n.x,m=s.y-n.y,p={x:(e.x+s.x)/2,y:(e.y+s.y)/2},d={x:(s.x+n.x)/2,y:(s.y+n.y)/2},_=Math.sqrt(a*a+l*l),c=Math.sqrt(i*i+m*m),v=p.x-d.x,k=p.y-d.y,C=_+c==0?0:c/(_+c),$={x:d.x+v*C,y:d.y+k*C},E=s.x-$.x,A=s.y-$.y;return{c1:new W(p.x+E,p.y+A),c2:new W(d.x+E,d.y+A)}}constructor(e,s,n,a,l,i){this.startPoint=e,this.control2=s,this.control1=n,this.endPoint=a,this.startWidth=l,this.endWidth=i}length(){let s=0,n,a;for(let l=0;l<=10;l+=1){const i=l/10,m=this.point(i,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),p=this.point(i,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(l>0){const d=m-n,_=p-a;s+=Math.sqrt(d*d+_*_)}n=m,a=p}return s}point(e,s,n,a,l){return s*(1-e)*(1-e)*(1-e)+3*n*(1-e)*(1-e)*e+3*a*(1-e)*e*e+l*e*e*e}}class tt{constructor(){try{this._et=new EventTarget}catch{this._et=document}}addEventListener(e,s,n){this._et.addEventListener(e,s,n)}dispatchEvent(e){return this._et.dispatchEvent(e)}removeEventListener(e,s,n){this._et.removeEventListener(e,s,n)}}function lt(t,e=250){let s=0,n=null,a,l,i;const m=()=>{s=Date.now(),n=null,a=t.apply(l,i),n||(l=null,i=[])};return function(...d){const _=Date.now(),c=e-(_-s);return l=this,i=d,c<=0||c>e?(n&&(clearTimeout(n),n=null),s=_,a=t.apply(l,i),n||(l=null,i=[])):n||(n=window.setTimeout(m,c)),a}}class B extends tt{constructor(e,s={}){var n,a,l;super(),this.canvas=e,this._drawingStroke=!1,this._isEmpty=!0,this._lastPoints=[],this._data=[],this._lastVelocity=0,this._lastWidth=0,this._handleMouseDown=i=>{!this._isLeftButtonPressed(i,!0)||this._drawingStroke||this._strokeBegin(this._pointerEventToSignatureEvent(i))},this._handleMouseMove=i=>{if(!this._isLeftButtonPressed(i,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(i),!1);return}this._strokeMoveUpdate(this._pointerEventToSignatureEvent(i))},this._handleMouseUp=i=>{this._isLeftButtonPressed(i)||this._strokeEnd(this._pointerEventToSignatureEvent(i))},this._handleTouchStart=i=>{i.targetTouches.length!==1||this._drawingStroke||(i.cancelable&&i.preventDefault(),this._strokeBegin(this._touchEventToSignatureEvent(i)))},this._handleTouchMove=i=>{if(i.targetTouches.length===1){if(i.cancelable&&i.preventDefault(),!this._drawingStroke){this._strokeEnd(this._touchEventToSignatureEvent(i),!1);return}this._strokeMoveUpdate(this._touchEventToSignatureEvent(i))}},this._handleTouchEnd=i=>{i.targetTouches.length===0&&(i.cancelable&&i.preventDefault(),this.canvas.removeEventListener("touchmove",this._handleTouchMove),this._strokeEnd(this._touchEventToSignatureEvent(i)))},this._handlePointerDown=i=>{!i.isPrimary||!this._isLeftButtonPressed(i)||this._drawingStroke||(i.preventDefault(),this._strokeBegin(this._pointerEventToSignatureEvent(i)))},this._handlePointerMove=i=>{if(i.isPrimary){if(!this._isLeftButtonPressed(i,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(i),!1);return}i.preventDefault(),this._strokeMoveUpdate(this._pointerEventToSignatureEvent(i))}},this._handlePointerUp=i=>{!i.isPrimary||this._isLeftButtonPressed(i)||(i.preventDefault(),this._strokeEnd(this._pointerEventToSignatureEvent(i)))},this.velocityFilterWeight=s.velocityFilterWeight||.7,this.minWidth=s.minWidth||.5,this.maxWidth=s.maxWidth||2.5,this.throttle=(n=s.throttle)!==null&&n!==void 0?n:16,this.minDistance=(a=s.minDistance)!==null&&a!==void 0?a:5,this.dotSize=s.dotSize||0,this.penColor=s.penColor||"black",this.backgroundColor=s.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=s.compositeOperation||"source-over",this.canvasContextOptions=(l=s.canvasContextOptions)!==null&&l!==void 0?l:{},this._strokeMoveUpdate=this.throttle?lt(B.prototype._strokeUpdate,this.throttle):B.prototype._strokeUpdate,this._ctx=e.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){const{_ctx:e,canvas:s}=this;e.fillStyle=this.backgroundColor,e.clearRect(0,0,s.width,s.height),e.fillRect(0,0,s.width,s.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0}fromDataURL(e,s={}){return new Promise((n,a)=>{const l=new Image,i=s.ratio||window.devicePixelRatio||1,m=s.width||this.canvas.width/i,p=s.height||this.canvas.height/i,d=s.xOffset||0,_=s.yOffset||0;this._reset(this._getPointGroupOptions()),l.onload=()=>{this._ctx.drawImage(l,d,_,m,p),n()},l.onerror=c=>{a(c)},l.crossOrigin="anonymous",l.src=e,this._isEmpty=!1})}toDataURL(e="image/png",s){switch(e){case"image/svg+xml":return typeof s!="object"&&(s=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(s))}`;default:return typeof s!="number"&&(s=void 0),this.canvas.toDataURL(e,s)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";const e=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!e?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerDown),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this._removeMoveUpEventListeners()}_getListenerFunctions(){var e;const s=window.document===this.canvas.ownerDocument?window:(e=this.canvas.ownerDocument.defaultView)!==null&&e!==void 0?e:this.canvas.ownerDocument;return{addEventListener:s.addEventListener.bind(s),removeEventListener:s.removeEventListener.bind(s)}}_removeMoveUpEventListeners(){const{removeEventListener:e}=this._getListenerFunctions();e("pointermove",this._handlePointerMove),e("pointerup",this._handlePointerUp),e("mousemove",this._handleMouseMove),e("mouseup",this._handleMouseUp),e("touchmove",this._handleTouchMove),e("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(e,{clear:s=!0}={}){s&&this.clear(),this._fromData(e,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(e)}toData(){return this._data}_isLeftButtonPressed(e,s){return s?e.buttons===1:(e.buttons&1)===1}_pointerEventToSignatureEvent(e){return{event:e,type:e.type,x:e.clientX,y:e.clientY,pressure:"pressure"in e?e.pressure:0}}_touchEventToSignatureEvent(e){const s=e.changedTouches[0];return{event:e,type:e.type,x:s.clientX,y:s.clientY,pressure:s.force}}_getPointGroupOptions(e){return{penColor:e&&"penColor"in e?e.penColor:this.penColor,dotSize:e&&"dotSize"in e?e.dotSize:this.dotSize,minWidth:e&&"minWidth"in e?e.minWidth:this.minWidth,maxWidth:e&&"maxWidth"in e?e.maxWidth:this.maxWidth,velocityFilterWeight:e&&"velocityFilterWeight"in e?e.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:e&&"compositeOperation"in e?e.compositeOperation:this.compositeOperation}}_strokeBegin(e){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:e,cancelable:!0})))return;const{addEventListener:n}=this._getListenerFunctions();switch(e.event.type){case"mousedown":n("mousemove",this._handleMouseMove),n("mouseup",this._handleMouseUp);break;case"touchstart":n("touchmove",this._handleTouchMove),n("touchend",this._handleTouchEnd);break;case"pointerdown":n("pointermove",this._handlePointerMove),n("pointerup",this._handlePointerUp);break}this._drawingStroke=!0;const a=this._getPointGroupOptions(),l=Object.assign(Object.assign({},a),{points:[]});this._data.push(l),this._reset(a),this._strokeUpdate(e)}_strokeUpdate(e){if(!this._drawingStroke)return;if(this._data.length===0){this._strokeBegin(e);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:e}));const s=this._createPoint(e.x,e.y,e.pressure),n=this._data[this._data.length-1],a=n.points,l=a.length>0&&a[a.length-1],i=l?s.distanceTo(l)<=this.minDistance:!1,m=this._getPointGroupOptions(n);if(!l||!(l&&i)){const p=this._addPoint(s,m);l?p&&this._drawCurve(p,m):this._drawDot(s,m),a.push({time:s.time,x:s.x,y:s.y,pressure:s.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:e}))}_strokeEnd(e,s=!0){this._removeMoveUpEventListeners(),this._drawingStroke&&(s&&this._strokeUpdate(e),this._drawingStroke=!1,this.dispatchEvent(new CustomEvent("endStroke",{detail:e})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerDown)}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown)}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart)}_reset(e){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(e.minWidth+e.maxWidth)/2,this._ctx.fillStyle=e.penColor,this._ctx.globalCompositeOperation=e.compositeOperation}_createPoint(e,s,n){const a=this.canvas.getBoundingClientRect();return new W(e-a.left,s-a.top,n,new Date().getTime())}_addPoint(e,s){const{_lastPoints:n}=this;if(n.push(e),n.length>2){n.length===3&&n.unshift(n[0]);const a=this._calculateCurveWidths(n[1],n[2],s),l=K.fromPoints(n,a);return n.shift(),l}return null}_calculateCurveWidths(e,s,n){const a=n.velocityFilterWeight*s.velocityFrom(e)+(1-n.velocityFilterWeight)*this._lastVelocity,l=this._strokeWidth(a,n),i={end:l,start:this._lastWidth};return this._lastVelocity=a,this._lastWidth=l,i}_strokeWidth(e,s){return Math.max(s.maxWidth/(e+1),s.minWidth)}_drawCurveSegment(e,s,n){const a=this._ctx;a.moveTo(e,s),a.arc(e,s,n,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(e,s){const n=this._ctx,a=e.endWidth-e.startWidth,l=Math.ceil(e.length())*2;n.beginPath(),n.fillStyle=s.penColor;for(let i=0;i<l;i+=1){const m=i/l,p=m*m,d=p*m,_=1-m,c=_*_,v=c*_;let k=v*e.startPoint.x;k+=3*c*m*e.control1.x,k+=3*_*p*e.control2.x,k+=d*e.endPoint.x;let C=v*e.startPoint.y;C+=3*c*m*e.control1.y,C+=3*_*p*e.control2.y,C+=d*e.endPoint.y;const $=Math.min(e.startWidth+d*a,s.maxWidth);this._drawCurveSegment(k,C,$)}n.closePath(),n.fill()}_drawDot(e,s){const n=this._ctx,a=s.dotSize>0?s.dotSize:(s.minWidth+s.maxWidth)/2;n.beginPath(),this._drawCurveSegment(e.x,e.y,a),n.closePath(),n.fillStyle=s.penColor,n.fill()}_fromData(e,s,n){for(const a of e){const{points:l}=a,i=this._getPointGroupOptions(a);if(l.length>1)for(let m=0;m<l.length;m+=1){const p=l[m],d=new W(p.x,p.y,p.pressure,p.time);m===0&&this._reset(i);const _=this._addPoint(d,i);_&&s(_,i)}else this._reset(i),n(l[0],i)}}toSVG({includeBackgroundColor:e=!1}={}){const s=this._data,n=Math.max(window.devicePixelRatio||1,1),a=0,l=0,i=this.canvas.width/n,m=this.canvas.height/n,p=document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.setAttribute("xmlns","http://www.w3.org/2000/svg"),p.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),p.setAttribute("viewBox",`${a} ${l} ${i} ${m}`),p.setAttribute("width",i.toString()),p.setAttribute("height",m.toString()),e&&this.backgroundColor){const d=document.createElement("rect");d.setAttribute("width","100%"),d.setAttribute("height","100%"),d.setAttribute("fill",this.backgroundColor),p.appendChild(d)}return this._fromData(s,(d,{penColor:_})=>{const c=document.createElement("path");if(!isNaN(d.control1.x)&&!isNaN(d.control1.y)&&!isNaN(d.control2.x)&&!isNaN(d.control2.y)){const v=`M ${d.startPoint.x.toFixed(3)},${d.startPoint.y.toFixed(3)} C ${d.control1.x.toFixed(3)},${d.control1.y.toFixed(3)} ${d.control2.x.toFixed(3)},${d.control2.y.toFixed(3)} ${d.endPoint.x.toFixed(3)},${d.endPoint.y.toFixed(3)}`;c.setAttribute("d",v),c.setAttribute("stroke-width",(d.endWidth*2.25).toFixed(3)),c.setAttribute("stroke",_),c.setAttribute("fill","none"),c.setAttribute("stroke-linecap","round"),p.appendChild(c)}},(d,{penColor:_,dotSize:c,minWidth:v,maxWidth:k})=>{const C=document.createElement("circle"),$=c>0?c:(v+k)/2;C.setAttribute("r",$.toString()),C.setAttribute("cx",d.x.toString()),C.setAttribute("cy",d.y.toString()),C.setAttribute("fill",_),p.appendChild(C)}),p.outerHTML}}const st={name:"Signature",props:{modelValue:{type:Array,default:()=>[]},mode:{type:String,default:"view"},width:{type:Number,default:400}},computed:{model:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},mounted(){const t=this.$refs.pad;let e=new B(t,{});if(this.signaturePad=Se(e),this.mode==="edit"&&window.addEventListener("resize",this.resizeCanvas),this.mode==="view")return setTimeout(()=>(this.signaturePad.fromData(this.model),this.render()),0),!1;if(this.resizeCanvas(),this.model&&this.model.length)return this.signaturePad.fromData(this.model),this.render()},data(){return{signaturePad:null,svg:"",fullscreen:!1,currentMode:"edit"}},methods:{resizeCanvas(){const t=this.$refs.pad,e=Math.max(window.devicePixelRatio||1,1);if(!t)return!1;t.width=t.offsetWidth*e,t.height=t.offsetHeight*e,t.getContext("2d").scale(e,e),this.signaturePad.fromData(this.signaturePad.toData())},clear(){this.model=[],this.svg="",this.signaturePad.clear(),this.currentMode="edit"},render(){setTimeout(()=>{this.svg=this.signaturePad.toDataURL()},100)},save(){this.svg=this.signaturePad.toDataURL("image/svg+xml"),this.model=this.signaturePad.toData(),this.fullscreen&&document.exitFullscreen(),this.fullscreen=!1,this.currentMode="view"},setFullscreen(){try{if(this.fullscreen)return this.fullscreen=!1,document.exitFullscreen();this.$refs.mainSignature.requestFullscreen(),this.fullscreen=!0,this.resizeCanvas()}catch(t){alert(t,"Fullscreen API is disabled")}}},beforeDestroy(){this.mode==="edit"&&window.removeEventListener("resize",this.handleResize),this.signaturePad.off()}},at={ref:"mainSignature"},it=["src"],nt={class:"signature-pad--body"},ot={ref:"pad"};function rt(t,e,s,n,a,l){return g(),V("div",at,[b(r("div",null,[r("img",{src:this.svg,style:q([{width:s.width+"px"},{"max-width":"100%","aspect-ratio":"1.6"}])},null,12,it)],512),[[y,s.mode==="view"||a.currentMode==="view"]]),b(r("div",{class:"signature-pad",style:q([{"aspect-ratio":"1.6"},{maxWidth:s.width+"px"}])},[r("div",nt,[r("canvas",ot,null,512)])],4),[[y,s.mode==="edit"&&a.currentMode==="edit"]]),s.mode==="edit"?(g(),V("div",{key:0,class:"d-flex signature-buttons flex-grow-1",style:q({maxWidth:s.width+"px"})},[o(D,{onClick:l.clear,class:"flex-grow-1",variant:"tonal",density:"comfortable",rounded:"0",color:"grey-darken-4"},{default:u(()=>[o(U,null,{default:u(()=>e[0]||(e[0]=[x("mdi-delete")])),_:1})]),_:1},8,["onClick"]),b(o(D,{onClick:l.setFullscreen,class:"flex-grow-1",variant:"tonal",density:"comfortable",rounded:"0",color:"grey-darken-4"},{default:u(()=>[o(U,null,{default:u(()=>e[1]||(e[1]=[x("mdi-fullscreen")])),_:1})]),_:1},8,["onClick"]),[[y,a.currentMode==="edit"]]),b(o(D,{onClick:l.save,class:"flex-grow-1",variant:"tonal",density:"comfortable",rounded:"0",color:"grey-darken-4"},{default:u(()=>[o(U,null,{default:u(()=>e[2]||(e[2]=[x("mdi-check")])),_:1})]),_:1},8,["onClick"]),[[y,a.currentMode==="edit"]])],4)):M("",!0)],512)}const ys=I(st,[["render",rt]]),dt=[{name:"Child or Adolescent at Risk",code:"CR",gender:["Male","Female"],age:["children"]},{name:"Unaccompanied or Separated Child",code:"SC",gender:["Male","Female"],age:["children"]},{name:"Woman at Risk",code:"WR",gender:["Female"],age:["adult","senior"]},{name:"Older Person at Risk",code:"ER",gender:["Male","Female"],age:["senior"]},{name:"Single Parent or care giver",code:"SP",gender:["Male","Female"],age:["adult","senior"]},{name:"Disability",code:"DS",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Serious medical condition",code:"SM",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Family unity",code:"FU",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Specific legal and physical protection needs",code:"LP",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Torture",code:"TR",gender:["Male","Female"],age:["children","adult","senior"]},{name:"GBV",code:"SV",gender:["Male","Female"],age:["children","adult","senior"]},{name:"N/A",code:"NA",gender:["Male","Female"],age:["children","adult","senior"]}],re={CR:[{name:"Child associated with armed forces or groups",gender:["Male","Female"],age:["children"]},{name:"Child career",gender:["Male","Female"],age:["children"]},{name:"Child engaged in child labor",gender:["Male","Female"],age:["children"]},{name:"Child parent or child spouse",gender:["Male","Female"],age:["children"]},{name:"Child with special education needs",gender:["Male","Female"],age:["children"]},{name:"Teenage pregnancy",gender:["Female"],age:["children"]}],SC:[{name:"Unaccompanied children",gender:["Male","Female"],age:["children"]},{name:"Separated children",gender:["Male","Female"],age:["children"]}],WR:[{name:"Single mothers or caregivers",gender:["Female"],age:["adult","senior"]},{name:"Single women",gender:["Female"],age:["adult","senior"]},{name:"Widows",gender:["Female"],age:["adult","senior"]},{name:"Older women",gender:["Female"],age:["senior"]},{name:"Women with disabilities",gender:["Female"],age:["children","adult","senior"]},{name:"Survivors of violence",gender:["Female"],age:["children","adult","senior"]}],ER:[{name:"Older person unable to care for self",gender:["Male","Female"],age:["senior"]},{name:"Older person with children",gender:["Male","Female"],age:["senior"]},{name:"Single older person",gender:["Male","Female"],age:["senior"]}],SP:[{name:"Caregiver",gender:["Male","Female"],age:["adult","senior"]},{name:"Grandparent",gender:["Male","Female"],age:["senior"]},{name:"Parent",gender:["Male","Female"],age:["children","adult"]}],DS:[{name:"Physical impairments",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Mental impairments",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Intellectual impairments",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Sensory impairments",gender:["Male","Female"],age:["children","adult","senior"]}],SM:[{name:"Chronic illness",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Critical medical condition",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Difficult pregnancy",gender:["Female"],age:["children","adult","senior"]},{name:"Malnutrition",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Other serious medical condition",gender:["Male","Female"],age:["children","adult","senior"]}],FU:[{name:"Family reunification is required",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Support with tracing family members is required",gender:["Male","Female"],age:["children","adult","senior"]}],LP:[{name:"No legal documentation",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Marginalized from society",gender:["Male","Female"],age:["children","adult","senior"]},{name:"At risk due to profile",gender:["Male","Female"],age:["children","adult","senior"]},{name:"At risk of removal",gender:["Male","Female"],age:["children","adult","senior"]},{name:"No access to services",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Violence, abuse or neglect",gender:["Male","Female"],age:["children","adult","senior"]}],TR:[{name:"Severe physical pain",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Severe mental pain",gender:["Male","Female"],age:["children","adult","senior"]}],SV:[{name:"Physical harm",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Sexual harm",gender:["Male","Female"],age:["children","adult","senior"]},{name:"Psychological harm",gender:["Male","Female"],age:["children","adult","senior"]}]},ut=t=>{if(!(typeof t>"u"))return t<18?"children":t<60?"adult":"senior"},mt={name:"CustomVulnerability",props:{modelValue:{type:Object},mode:{type:String,default:"view"},gender:{type:String},age:{type:Number}},computed:{ageGroup(){if(!(!this.age||typeof this.age!="number"))return ut(this.age)},model:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}},vulnerabilities(){let t=dt;return this.ageGroup&&(t=t.filter(e=>e.age.includes(this.ageGroup))),this.gender&&(t=t.filter(e=>e.gender.includes(this.gender))),t.map(({name:e,code:s})=>({name:e,code:s}))},criterias(){if(!re[this.model.code])return[];let t=re[this.model.code];return this.ageGroup&&(t=t.filter(e=>e.age.includes(this.ageGroup))),this.gender&&(t=t.filter(e=>e.gender.includes(this.gender))),t.map(e=>e.name)}}},ct={class:"custom-vulnerability mt-2"};function ht(t,e,s,n,a,l){return g(),V("div",ct,[b(r("div",null,null,512),[[y,s.mode==="view"]]),b(r("div",null,[o(w,{class:"vulnerability"},{default:u(()=>{var i;return[o(f,{cols:"12"},{default:u(()=>[o(ne,{modelValue:l.model,"onUpdate:modelValue":e[0]||(e[0]=m=>l.model=m),label:t.$t("Vulnerability"),items:l.vulnerabilities,"item-title":m=>m.name?t.$t(m.name):"","item-value":m=>m,variant:"underlined","return-object":"","hide-details":"",clearable:""},null,8,["modelValue","label","items","item-title","item-value"])]),_:1}),(i=l.model)!=null&&i.name?(g(),P(f,{key:0,cols:"12"},{default:u(()=>[o(ne,{modelValue:l.model.vulnerabilitySpecified,"onUpdate:modelValue":e[1]||(e[1]=m=>l.model.vulnerabilitySpecified=m),label:t.$t("Vulnerability Specification"),items:l.criterias,"item-title":m=>m?t.$t(m):"","item-value":m=>m,"hide-details":"",variant:"underlined",clearable:""},null,8,["modelValue","label","items","item-title","item-value"])]),_:1})):M("",!0)]}),_:1})],512),[[y,s.mode==="edit"]])])}const fe=I(mt,[["render",ht]]),pt={props:{modelValue:{type:Object,default:()=>({})}},mounted(){this.onLine=window.navigator.onLine},computed:{model:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},data(){return{onLine:!0}}},ft={class:"d-flex"},gt={class:"bg-blue-grey-lighten-1 pa-2"},_t={class:"bg-blue-grey-lighten-5 pa-4 flex-grow-1"},vt={class:"text-h6 mt-4"},bt={class:"mt-2"},yt={class:"text-red-darken-1"},kt={class:"mb-6 mt-2"},wt={class:"mt-2"},Vt={class:"text-red-darken-1"},xt={class:"mt-2 mb-2"},St={key:0,class:"mt-2 mb-2"},Ct={key:1,class:"mt-2 mb-2"},Mt={key:2,class:"mt-2 mb-2"},Pt={key:3,class:"mt-2 mb-2"},It={class:"mt-2 mb-2"},$t={key:4,class:"mt-2 mb-2"},Ft={class:"ml-6"},At={key:5,class:"mt-2 mb-2"};function Dt(t,e,s,n,a,l){return g(),P(f,{cols:"12",class:"mt-0 pt-0"},{default:u(()=>[l.model.result!=="success"?(g(),P(pe,{key:0,text:t.$t(l.model.message),type:l.model.result,closable:""},null,8,["text","type"])):M("",!0),l.model.result==="success"?(g(),P(Ke,{key:1},{default:u(()=>[o(Qe,{class:"pa-0"},{default:u(()=>[r("div",ft,[r("div",gt,[o(Ze,{size:"56",color:"blue-grey-lighten-3"},{default:u(()=>[o(U,{size:"x-large",icon:l.model.gender==="Male"?"mdi-human-male":"mdi-human-female"},null,8,["icon"])]),_:1})]),r("div",_t,[r("div",null,[r("strong",null,h(t.$t("Gender"))+":",1),x(" "+h(t.$t(l.model.gender)),1)]),r("div",null,[r("strong",null,h(t.$t("Birthday"))+":",1),x(" "+h(l.model.birthday),1)]),r("div",null,[r("strong",null,h(t.$t("Current age"))+":",1),x(" "+h(l.model.age),1)]),r("div",vt,h(t.$t("Deduplication results")),1),b(o(et,{class:"bg-blue-grey-lighten-5",type:"article"},null,512),[[y,!l.model.duplicates]]),b(r("div",null,[r("div",null,h(t.$t("This person hasn't received any humanitarian support")),1),b(r("div",bt,[r("strong",yt,h(t.$t("Result can be incomplete, because you're offline!")),1)],512),[[y,!a.onLine]])],512),[[y,l.model.duplicates&&l.model.duplicates.length===0]]),b(r("div",null,[r("div",kt,[r("div",null,[r("strong",null,h(t.$t("This person has already received the support from humanitarian organizations")),1)]),b(r("div",wt,[r("strong",Vt,h(t.$t("Result can be incomplete, because you're offline!")),1)],512),[[y,!a.onLine]])]),(g(!0),V(R,null,Y(l.model.duplicates,i=>{var m,p,d,_,c;return g(),V("div",{key:i._id,class:"mb-7 pl-2",style:{"border-left":"2px solid #039BE5"}},[r("div",xt,[r("strong",null,h(t.$t("Date"))+":",1),x(" "+h(new Date(i.date).toLocaleDateString("uk")),1)]),i.bundleName?(g(),V("div",St,[r("strong",null,h(t.$t("Assistance type"))+":",1),x(" "+h(t.$t(i.bundleName)),1)])):M("",!0),(m=i.address)!=null&&m.pCode1?(g(),V("div",Ct,[r("strong",null,h(t.$t("Oblast"))+":",1),x(" "+h(t.$t(i.address.pCode1)),1)])):M("",!0),(p=i.address)!=null&&p.pCode2?(g(),V("div",Mt,[r("strong",null,h(t.$t("Raion"))+":",1),x(" "+h(t.$t(i.address.pCode2)),1)])):M("",!0),(d=i.address)!=null&&d.pCode4?(g(),V("div",Pt,[r("strong",null,h(t.$t("Locality"))+":",1),x(" "+h(t.$t(i.address.pCode4)),1)])):M("",!0),r("div",It,[r("strong",null,h(t.$t("Organization"))+":",1),x(" "+h((_=i.organization)==null?void 0:_.name),1)]),(c=i.items)!=null&&c.length?(g(),V("div",$t,[r("div",null,[r("strong",null,h(t.$t("Items"))+":",1)]),r("ul",Ft,[(g(!0),V(R,null,Y(i.items,v=>b((g(),V("li",null,h(t.$t(v.key))+": "+h(v.value),513)),[[y,v.value]])),256))])])):M("",!0),i.value?(g(),V("div",At,[r("strong",null,h(t.$t("Value"))+":",1),x(" "+h(i.value?i.value.toLocaleString("uk-UA",{style:"currency",currency:i.currency||"USD"}):""),1)])):M("",!0)])}),128))],512),[[y,l.model.duplicates&&l.model.duplicates.length]])])])]),_:1})]),_:1})):M("",!0)]),_:1})}const ge=I(pt,[["render",Dt]]),Ut=()=>({mask:"AAAAAAAAAA",tokens:{A:{pattern:/\d/}}}),Tt=function(){return[t=>!t||t.length===10||this.$t("Tax ID must contain 10 characters"),t=>!t||/^\d+$/.test(t)||this.$t("Tax ID must contain only the numbers"),t=>{if(!t||t==="0000000000")return!0;let{result:e}=X(t);return e==="success"||this.$t("This tax ID is invalid")}]},Et={name:"CustomTaxId",props:{modelValue:{type:String}},computed:{model:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}},validationRules:Tt,options:Ut}};function Nt(t,e,s,n,a,l){const i=de("maska");return b((g(),P(S,{modelValue:l.model,"onUpdate:modelValue":e[0]||(e[0]=m=>l.model=m),label:t.$t("Tax ID"),rules:l.validationRules,hint:l.model==="0000000000"?t.$t("This person has no documents"):"",placeholder:"1234567890",class:"tax-id","validate-on":"blur",clearable:"",name:"taxId",variant:"underlined"},null,8,["modelValue","label","rules","hint"])),[[i,void 0,l.options]])}const _e=I(Et,[["render",Nt]]),Ot=Me({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Re(),...We()},"VSwitch"),Lt=Ce()({name:"VSwitch",inheritAttrs:!1,props:Ot(),emits:{"update:focused":t=>!0,"update:modelValue":t=>!0,"update:indeterminate":t=>!0},setup(t,e){let{attrs:s,slots:n}=e;const a=Z(t,"indeterminate"),l=Z(t,"modelValue"),{loaderClasses:i}=Te(t),{isFocused:m,focus:p,blur:d}=Le(t),_=Pe(),c=Ie&&window.matchMedia("(forced-colors: active)").matches,v=ee(()=>typeof t.loading=="string"&&t.loading!==""?t.loading:t.color),k=$e(),C=ee(()=>t.id||`switch-${k}`);function $(){a.value&&(a.value=!1)}function E(A){var N,O;A.stopPropagation(),A.preventDefault(),(O=(N=_.value)==null?void 0:N.input)==null||O.click()}return Fe(()=>{const[A,N]=Ae(s),O=ae.filterProps(t),ve=ie.filterProps(t);return o(ae,te({class:["v-switch",{"v-switch--flat":t.flat},{"v-switch--inset":t.inset},{"v-switch--indeterminate":a.value},i.value,t.class]},A,O,{modelValue:l.value,"onUpdate:modelValue":z=>l.value=z,id:C.value,focused:m.value,style:t.style}),{...n,default:z=>{let{id:be,messagesId:ye,isDisabled:ke,isReadonly:we,isValid:Q}=z;const G={model:l,isValid:Q};return o(ie,te({ref:_},ve,{modelValue:l.value,"onUpdate:modelValue":[T=>l.value=T,$],id:be.value,"aria-describedby":ye.value,type:"checkbox","aria-checked":a.value?"mixed":void 0,disabled:ke.value,readonly:we.value,onFocus:p,onBlur:d},N),{...n,default:T=>{let{backgroundColorClasses:j,backgroundColorStyles:F}=T;return o("div",{class:["v-switch__track",c?void 0:j.value],style:F.value,onClick:E},[n["track-true"]&&o("div",{key:"prepend",class:"v-switch__track-true"},[n["track-true"](G)]),n["track-false"]&&o("div",{key:"append",class:"v-switch__track-false"},[n["track-false"](G)])])},input:T=>{let{inputNode:j,icon:F,backgroundColorClasses:Ve,backgroundColorStyles:xe}=T;return o(R,null,[j,o("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":F||t.loading},t.inset||c?void 0:Ve.value],style:t.inset?void 0:xe.value},[n.thumb?o(Ee,{defaults:{VIcon:{icon:F,size:"x-small"}}},{default:()=>[n.thumb({...G,icon:F})]}):o(Oe,null,{default:()=>[t.loading?o(Ne,{name:"v-switch",active:!0,color:Q.value===!1?void 0:v.value},{default:H=>n.loader?n.loader(H):o(Be,{active:H.isActive,color:H.color,indeterminate:!0,size:"16",width:"2"},null)}):F&&o(U,{key:String(F),icon:F,size:"x-small"},null)]})])])}})}})}),{}}}),{people:J}=ce,Rt=(t,e)=>{const s=["boys","men","seniorMen"].includes(t)?"Male":"Female";let n;["boys","girls"].includes(t)&&(n=new Date(new Date().getFullYear(),0,1)),["men","women"].includes(t)&&(n=new Date(new Date().getFullYear()-18,0,1)),n||(n=new Date(new Date().getFullYear()-61,0,1));const a=new Date().getTimezoneOffset()*6e4;n=new Date(new Date(n).getTime()-a).toISOString().substring(0,10);const l=J.calculateAge({birthday:n,date:e});return{gender:s,birthday:n,age:l}},Wt={name:"FamilyMember",props:{modelValue:{type:Object},date:{type:[Date,String],default:new Date},hh:{type:Object},allowSimplified:{type:Boolean}},computed:{model:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},data(){return{simplified:!1,results:[],groups:{boys:0,girls:0,men:0,women:0,seniorMen:0,seniorWomen:0,disabled:0}}},methods:{async checkIPN(t){if(!t)return{result:"error",message:"Tax ID must contain 10 numbers"};if(!t.match(/^\d{10}$/))return{result:"error",message:"Tax ID must contain 10 numbers"};let e=X(t);return e.result==="warning"?{result:"warning",message:"This tax ID is invalid"}:e},async checkTaxId(t,e){if(!e)return!1;const s=await this.checkIPN(e);if(!s.result==="success")return this.results[t]=s,!1;s.age=J.calculateAge({birthday:s.birthday,date:this.date}),Object.assign(this.model[t],L(s));const{assistances:n}=this.$storage;let a=n.useIndex("peopleIds").include(["bundleName","organization","items","strings","address","date","familyMembers"]).filter({peopleIds:e}).sort("date");return a=await a.find(),a=a.count?a.items:[],s.duplicates=a,this.results[t]=s},addFamilyMember(){if(!this.model)return this.model=[{}];this.model.push({})},addSimple(t){const e=(parseInt(this.groups[t])||0)+1;this.recalculateSimple(t,e)},recalculateSimple(t,e){var m,p;this.groups[t]=parseInt(e);const s=JSON.parse(JSON.stringify(this.groups)),n=Ue(this.hh),a=((p=(m=this.hh)==null?void 0:m.vulnerability)==null?void 0:p.code)==="DS"?1:0;parseInt(s[n])>0&&(s[n]=s[n]-1),a&&parseInt(s.disabled)>0&&(s.disabled=parseInt(s.disabled)-1);const l=["seniorMen","seniorWomen","men","women","boys","girls"],i=[];for(const d of l){if(parseInt(s[d])<1){s[d]=0;continue}i.push(...Array(parseInt(s[d])||0).fill(Rt(d,this.date)))}for(let d=0;d<parseInt(s.disabled||0);d++)i[d]&&(i[d].vulnerability={name:"Disability",code:"DS"});this.model=i},calculateAge(t,e){this.model[t].age=J.calculateAge({birthday:e,date:this.date})}},watch:{simplified(){this.groups=De([this.hh,...this.model])}}},Bt={class:"text-h5 mb-2 offset-md1 black--text"},zt={class:"mb-0"},Gt={class:"pl-2 text-left"},jt={class:"text-left"},Ht={class:"non-selectable"},qt={style:{width:"30%",cursor:"pointer"},class:"pt-2 pb-2"},Yt={class:"non-selectable"},Jt={style:{width:"30%",cursor:"pointer"},class:"pt-2 pb-2"},Xt={class:"non-selectable"},Kt={style:{width:"30%",cursor:"pointer"},class:"pt-2 pb-2"},Qt={class:"non-selectable"},Zt={style:{width:"30%",cursor:"pointer"},class:"pt-2 pb-2"},el={class:"non-selectable"},tl={style:{width:"30%",cursor:"pointer"},class:"pt-2 pb-2"},ll={class:"non-selectable"},sl={style:{width:"30%",cursor:"pointer"},class:"pt-2 pb-2"},al={class:"non-selectable"},il={style:{width:"30%",cursor:"pointer"},class:"pt-2 pb-2"},nl={class:"text-h6 mt-4 mb-2"};function ol(t,e,s,n,a,l){const i=_e,m=ge,p=me,d=ue,_=fe;return g(),V("div",null,[o(w,{class:"mb-0 mt-2 pb-0"},{default:u(()=>[o(f,{cols:"12",class:"mb-0 pb-0"},{default:u(()=>[r("div",Bt,h(t.$t("Family members")),1),r("div",zt,h(t.$t("Indicate basic information about the family members")),1)]),_:1})]),_:1}),o(w,{class:"mb-0 mt-0"},{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[b(o(Lt,{modelValue:a.simplified,"onUpdate:modelValue":e[0]||(e[0]=c=>a.simplified=c),color:"primary",density:"compact",label:t.$t("Simplified data collection"),"hide-details":""},null,8,["modelValue","label"]),[[y,s.allowSimplified]])]),_:1})]),_:1}),a.simplified&&s.hh?(g(),P(w,{key:0,class:"mb-2 mt-2"},{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[o(ze,{density:"compact"},{default:u(()=>[r("thead",null,[r("tr",null,[r("th",Gt,h(t.$t("Group")),1),r("th",jt,h(t.$t("Number")),1)])]),r("tbody",null,[r("tr",null,[r("td",{class:"pl-2 text-left",onClick:e[1]||(e[1]=c=>l.addSimple("boys")),style:{width:"70%",cursor:"pointer"}},[r("div",Ht,h(t.$t("Male, <18")),1)]),r("td",qt,[o(S,{"model-value":a.groups.boys,onBlur:e[2]||(e[2]=c=>l.recalculateSimple("boys",c.target.value)),type:"number",inputmode:"numeric",density:"compact",variant:"outlined","hide-details":""},null,8,["model-value"])])]),r("tr",null,[r("td",{class:"pl-2 text-left",onClick:e[3]||(e[3]=c=>l.addSimple("girls")),style:{width:"70%",cursor:"pointer"}},[r("div",Yt,h(t.$t("Female, <18")),1)]),r("td",Jt,[o(S,{"model-value":a.groups.girls,onBlur:e[4]||(e[4]=c=>l.recalculateSimple("girls",c.target.value)),type:"number",inputmode:"numeric",density:"compact",variant:"outlined","hide-details":""},null,8,["model-value"])])]),r("tr",null,[r("td",{class:"pl-2 text-left",onClick:e[5]||(e[5]=c=>l.addSimple("men")),style:{width:"70%",cursor:"pointer"}},[r("div",Xt,h(t.$t("Male, 18-60")),1)]),r("td",Kt,[o(S,{"model-value":a.groups.men,onBlur:e[6]||(e[6]=c=>l.recalculateSimple("men",c.target.value)),type:"number",inputmode:"numeric",density:"compact",variant:"outlined","hide-details":""},null,8,["model-value"])])]),r("tr",null,[r("td",{class:"pl-2 text-left",onClick:e[7]||(e[7]=c=>l.addSimple("women")),style:{width:"70%",cursor:"pointer"}},[r("div",Qt,h(t.$t("Female, 18-60")),1)]),r("td",Zt,[o(S,{"model-value":a.groups.women,onBlur:e[8]||(e[8]=c=>l.recalculateSimple("women",c.target.value)),type:"number",inputmode:"numeric",density:"compact",variant:"outlined","hide-details":""},null,8,["model-value"])])]),r("tr",null,[r("td",{class:"pl-2 text-left",onClick:e[9]||(e[9]=c=>l.addSimple("seniorMen")),style:{width:"70%",cursor:"pointer"}},[r("div",el,h(t.$t("Male, 60+")),1)]),r("td",tl,[o(S,{"model-value":a.groups.seniorMen,onBlur:e[10]||(e[10]=c=>l.recalculateSimple("seniorMen",c.target.value)),type:"number",inputmode:"numeric",density:"compact",variant:"outlined","hide-details":""},null,8,["model-value"])])]),r("tr",null,[r("td",{class:"pl-2 text-left",onClick:e[11]||(e[11]=c=>l.addSimple("seniorWomen")),style:{width:"70%",cursor:"pointer"}},[r("div",ll,h(t.$t("Female, 60+")),1)]),r("td",sl,[o(S,{"model-value":a.groups.seniorWomen,onBlur:e[12]||(e[12]=c=>l.recalculateSimple("seniorWomen",c.target.value)),type:"number",inputmode:"numeric",density:"compact",variant:"outlined","hide-details":""},null,8,["model-value"])])]),r("tr",null,[r("td",{class:"pl-2 text-left",onClick:e[13]||(e[13]=c=>l.addSimple("disabled")),style:{width:"70%",cursor:"pointer"}},[r("div",al,h(t.$t("People with disabilities")),1)]),r("td",il,[o(S,{"model-value":a.groups.disabled,onBlur:e[14]||(e[14]=c=>l.recalculateSimple("disabled",c.target.value)),type:"number",inputmode:"numeric",density:"compact",variant:"outlined","hide-details":""},null,8,["model-value"])])])])]),_:1})]),_:1})]),_:1})):M("",!0),a.simplified?M("",!0):(g(),P(w,{key:1,class:"mb-2 mt-2"},{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[b(r("div",null,h(t.$t("You haven't added any family members yet!")),513),[[y,!l.model||l.model.length===0]]),(g(!0),V(R,null,Y(l.model,(c,v)=>(g(),V("div",{key:"familyMember-"+v,class:"mb-8"},[r("div",nl,[x(h(t.$t("Family member"))+" "+h(v+1)+" ",1),o(Ge,{dense:"",size:"small",onClick:k=>l.model.splice(v,1)},{default:u(()=>[x(h(t.$t("Remove")),1)]),_:2},1032,["onClick"])]),o(w,null,{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[o(i,{modelValue:l.model[v].taxId,"onUpdate:modelValue":k=>l.model[v].taxId=k,onBlur:k=>l.checkTaxId(v,l.model[v].taxId),hint:t.$t("This field can be ommited if the person has no tax ID")},null,8,["modelValue","onUpdate:modelValue","onBlur","hint"])]),_:2},1024),a.results[v]?(g(),P(m,{key:0,"model-value":a.results[v]},null,8,["model-value"])):M("",!0),o(f,{cols:"12",lg:"6"},{default:u(()=>[o(p,{modelValue:l.model[v].gender,"onUpdate:modelValue":k=>l.model[v].gender=k},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(f,{cols:"12",lg:"6"},{default:u(()=>[o(d,{modelValue:l.model[v].birthday,"onUpdate:modelValue":[k=>l.model[v].birthday=k,k=>l.calculateAge(v,k)],max:new Date,label:t.$t("Birthday")},null,8,["modelValue","onUpdate:modelValue","max","label"])]),_:2},1024)]),_:2},1024),o(_,{modelValue:l.model[v].vulnerability,"onUpdate:modelValue":k=>l.model[v].vulnerability=k,age:parseInt(l.model[v].age),gender:l.model[v].gender,mode:"edit"},null,8,["modelValue","onUpdate:modelValue","age","gender"])]))),128)),o(D,{onClick:l.addFamilyMember,class:"mt-4",small:""},{default:u(()=>[o(U,null,{default:u(()=>e[15]||(e[15]=[x("mdi-plus")])),_:1}),x(" "+h(t.$t("Add family member")),1)]),_:1},8,["onClick"])]),_:1})]),_:1}))])}const ks=I(Wt,[["render",ol]]),rl=["alley","avenue","borough","boulevard","bout","breakthrough","bypass","descent","entrance","farmstead","garage cooperative","gardening","harbor","highway","impasse","lane","maidan","microdistrict","other","passage","path","quarter","residential area","road","square","station","street","tract"],dl={name:"CustomStreet",props:{modelValue:{type:Object,default:()=>({})}},computed:{model:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}},streetTypes(){const t=JSON.parse(JSON.stringify(rl));return t.sort((e,s)=>this.$t(e).localeCompare(this.$t(s))),t}},methods:{updateStreet(t){this.model.translation||(this.model.translation={}),this.model.translation.uk||(this.model.translation.uk={}),this.model.translation.uk.street=t}},watch:{"model.translation.uk.street"(t){this.model.street=this.$_translit(t)}}},ul={class:"address"};function ml(t,e,s,n,a,l){const i=je;return g(),V("div",ul,[o(w,null,{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[o(w,null,{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[o(i,{modelValue:l.model.streetType,"onUpdate:modelValue":e[0]||(e[0]=m=>l.model.streetType=m),label:t.$t("Type"),items:l.streetTypes},null,8,["modelValue","label","items"])]),_:1}),o(f,{cols:"12"},{default:u(()=>{var m,p;return[o(S,{modelValue:(p=(m=l.model.translation)==null?void 0:m.uk)==null?void 0:p.street,"onUpdate:modelValue":l.updateStreet,rules:[d=>!d||d&&d.match(/^[^a-z]*$/i)!==null||t.$t("This field must not be provided in English")],label:t.$t("Street (ukr)"),hint:t.$t("This field will be transliterated automatically"),variant:"underlined","hide-details":"auto"},null,8,["modelValue","onUpdate:modelValue","rules","label","hint"])]}),_:1}),o(f,{md:"6",cols:"12"},{default:u(()=>[o(S,{modelValue:l.model.building,"onUpdate:modelValue":e[1]||(e[1]=m=>l.model.building=m),label:t.$t("Building"),variant:"underlined","hide-details":""},null,8,["modelValue","label"])]),_:1}),o(f,{md:"6",cols:"12"},{default:u(()=>[o(S,{modelValue:l.model.apartment,"onUpdate:modelValue":e[2]||(e[2]=m=>l.model.apartment=m),label:t.$t("# Apt"),variant:"underlined","hide-details":""},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1})])}const cl=I(dl,[["render",ml]]),hl={name:"Household",props:{modelValue:{type:Object,default:()=>({})},householdId:{type:String}},computed:{model:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},watch:{householdId(t){this.model.householdId=this.householdId}}},pl={class:"text-h5 mb-2 offset-md1 black--text"};function fl(t,e,s,n,a,l){const i=cl;return g(),P(w,{class:"mb-2 mt-2"},{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[r("div",pl,h(t.$t("Household address")),1),r("div",null,h(t.$t("Indicate the address where the assistance is provided")),1)]),_:1}),o(f,{cols:"12"},{default:u(()=>[o(i,{modelValue:l.model,"onUpdate:modelValue":e[0]||(e[0]=m=>l.model=m)},null,8,["modelValue"])]),_:1})]),_:1})}const ws=I(hl,[["render",fl]]),gl=["UA01","UA71","UA74","UA73","UA12","UA14","UA26","UA63","UA65","UA68","UA35","UA80","UA32","UA44","UA46","UA48","UA51","UA53","UA56","UA85","UA59","UA61","UA05","UA07","UA21","UA23","UA18"],_l={name:"CustomOblast",props:{modelValue:{type:String}},computed:{items(){return gl}},methods:{update(t){this.$emit("update:modelValue",t)},localizedFilter(t,e,s){return t.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1}}},vl={class:"oblast"};function bl(t,e,s,n,a,l){return g(),V("div",vl,[o(he,{"model-value":s.modelValue,variant:"underlined","onUpdate:modelValue":l.update,clearable:"","no-data-text":t.$t("No data available"),items:l.items,"item-title":i=>i?t.$t(i):"","item-value":i=>i,label:t.$t("Oblast"),"custom-filter":l.localizedFilter},null,8,["model-value","onUpdate:modelValue","no-data-text","items","item-title","item-value","label","custom-filter"])])}const yl=I(_l,[["render",bl]]),kl={name:"PersonInfo",props:{modelValue:{type:Object,default:()=>({})},itemsList:{type:Array}},computed:{model:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}},age(){return le(this.model.birthday)}},watch:{"model.birthday"(t){t&&(this.model.age=le(t))},"model.translation.uk.familyName"(t){this.model.familyName=this.$_translit(t)},"model.translation.uk.givenName"(t){this.model.givenName=this.$_translit(t)},"model.translation.uk.additionalName"(t){this.model.additionalName=this.$_translit(t)}}},wl={class:"text-h5 mb-2 offset-md1 black--text"},Vl={class:"text-h5 mb-2 offset-md1 black--text"},xl={class:"mb-2"},Sl={class:"mb-2"},Cl={class:"text-h5 mb-2 offset-md1 black--text"},Ml={class:"mb-2"};function Pl(t,e,s,n,a,l){const i=yl,m=me,p=ue,d=fe,_=qe;return g(),V("div",null,[o(w,{class:"mb-2 mt-2"},{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[r("div",wl,h(t.$t("Oblast of origin")),1),r("div",null,h(t.$t("Address of the receiver")),1)]),_:1}),o(f,{cols:"12"},{default:u(()=>[o(i,{modelValue:l.model.origin,"onUpdate:modelValue":e[0]||(e[0]=c=>l.model.origin=c)},null,8,["modelValue"])]),_:1})]),_:1}),o(w,{class:"mb-2 mt-2"},{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[r("div",Vl,h(t.$t("Personal data")),1),r("div",xl,h(t.$t("Provide information about the receiver")),1),r("div",null,h(t.$t("Please input person's name in Ukrainian and check the proper transliteration below")),1)]),_:1}),o(f,{cols:"12"},{default:u(()=>[o(S,{modelValue:l.model.translation.uk.familyName,"onUpdate:modelValue":e[1]||(e[1]=c=>l.model.translation.uk.familyName=c),label:t.$t("Family name (ua)"),name:"familyNameUk",variant:"underlined",id:"familyNameUk"},null,8,["modelValue","label"]),o(S,{modelValue:l.model.translation.uk.givenName,"onUpdate:modelValue":e[2]||(e[2]=c=>l.model.translation.uk.givenName=c),label:t.$t("Given name (ua)"),name:"givenNameNameUk",variant:"underlined",id:"givenNameNameUk"},null,8,["modelValue","label"]),o(S,{modelValue:l.model.translation.uk.additionalName,"onUpdate:modelValue":e[3]||(e[3]=c=>l.model.translation.uk.additionalName=c),label:t.$t("Adittional name (ua)"),name:"additionalNameUk",variant:"underlined",id:"additionalNameUk"},null,8,["modelValue","label"])]),_:1})]),_:1}),o(w,{class:"mb-2 mt-2"},{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[r("div",Sl,h(t.$t("Please change this if the data in the international passport is different from the official transliteration")),1)]),_:1}),o(f,{cols:"12"},{default:u(()=>[o(S,{modelValue:l.model.familyName,"onUpdate:modelValue":e[4]||(e[4]=c=>l.model.familyName=c),label:t.$t("Family name"),name:"familyName",variant:"underlined",id:"familyName"},null,8,["modelValue","label"]),o(S,{modelValue:l.model.givenName,"onUpdate:modelValue":e[5]||(e[5]=c=>l.model.givenName=c),label:t.$t("Given name"),name:"givenNameName",variant:"underlined",id:"givenNameName"},null,8,["modelValue","label"]),o(S,{modelValue:l.model.additionalName,"onUpdate:modelValue":e[6]||(e[6]=c=>l.model.additionalName=c),label:t.$t("Adittional name"),name:"additionalName",variant:"underlined",id:"additionalName"},null,8,["modelValue","label"]),o(m,{modelValue:l.model.gender,"onUpdate:modelValue":e[7]||(e[7]=c=>l.model.gender=c)},null,8,["modelValue"])]),_:1})]),_:1}),o(w,null,{default:u(()=>[o(f,{cols:"12",md:"12"},{default:u(()=>[o(p,{modelValue:l.model.birthday,"onUpdate:modelValue":e[8]||(e[8]=c=>l.model.birthday=c),max:new Date,label:t.$t("Birthday")},null,8,["modelValue","max","label"])]),_:1})]),_:1}),o(w,null,{default:u(()=>[o(f,null,{default:u(()=>[o(d,{modelValue:l.model.vulnerability,"onUpdate:modelValue":e[9]||(e[9]=c=>l.model.vulnerability=c),gender:l.model.gender,age:parseInt(l.age),mode:"edit"},null,8,["modelValue","gender","age"])]),_:1})]),_:1}),o(w,{class:"mb-2 mt-2"},{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[r("div",Cl,h(t.$t("Contacts")),1),r("div",Ml,h(t.$t("Add the personal contacts")),1)]),_:1})]),_:1}),o(w,{class:"mb-2 mt-2"},{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[o(_,{modelValue:l.model.phone,"onUpdate:modelValue":e[10]||(e[10]=c=>l.model.phone=c),mode:"edit",multiple:""},null,8,["modelValue"])]),_:1})]),_:1})])}const Vs=I(kl,[["render",Pl]]),Il={name:"CustomAdmin4",props:{modelValue:{type:Object,default:()=>({})}},computed:{model:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}},admin4Codes(){return Ye.filter(e=>e.indexOf(this.model.pCode3)!==-1).sort((e,s)=>this.$t(e).localeCompare(this.$t(s)))}}},$l={class:"text-h5 mb-2 offset-md1 black--text"},Fl={class:"address-admin4"};function Al(t,e,s,n,a,l){const i=He;return g(),P(w,{class:"mb-2 mt-2"},{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[r("div",$l,h(t.$t("Person's location")),1),r("div",null,h(t.$t("Specify the location of the person you are helping if it is different from the distribution location")),1)]),_:1}),o(f,{cols:"12"},{default:u(()=>[r("div",Fl,[o(w,null,{default:u(()=>[o(f,{cols:"12"},{default:u(()=>{var m,p;return[b(o(he,{modelValue:l.model.pCode4,"onUpdate:modelValue":e[0]||(e[0]=d=>l.model.pCode4=d),items:l.admin4Codes,"item-title":d=>d?t.$t(d):"","item-value":d=>d,variant:"underlined",label:t.$t("Locality"),hint:t.$t("Enter admin4 level title"),"no-data-text":t.$t("No data available"),class:"mb-4",clearable:"","hide-details":""},null,8,["modelValue","items","item-title","item-value","label","hint","no-data-text"]),[[y,l.model.pCode3&&((m=l.model.country)==null?void 0:m.name)==="Ukraine"]]),b(o(i,{modelValue:l.model.admin4,"onUpdate:modelValue":e[1]||(e[1]=d=>l.model.admin4=d),label:t.$t("Admin 4 level"),variant:"underlined",class:"mb-4","hide-details":""},null,8,["modelValue","label"]),[[y,l.model.country&&((p=l.model.country)==null?void 0:p.name)!=="Ukraine"]])]}),_:1})]),_:1})])]),_:1})]),_:1})}const xs=I(Il,[["render",Al]]),Dl={name:"DistributionFormMeta",props:{modelValue:{type:Object,default:()=>({})}},computed:{model:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}}},Ul={class:"text-h5 mb-2 offset-md1 black--text"},Tl={class:"mb-2"};function El(t,e,s,n,a,l){const i=Xe,m=Je;return g(),V("div",null,[o(w,{class:"mb-0 mt-2 pb-0"},{default:u(()=>[o(f,{cols:"12",class:"mb-0 pb-0"},{default:u(()=>[r("div",Ul,h(t.$t("Metadata")),1),r("div",Tl,h(t.$t("Indicate basic information about the assistance")),1)]),_:1})]),_:1}),o(i,{modelValue:l.model.populationType,"onUpdate:modelValue":e[0]||(e[0]=p=>l.model.populationType=p),label:t.$t("Category"),class:"mb-4"},null,8,["modelValue","label"]),o(w,null,{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[o(m,{modelValue:l.model.tags,"onUpdate:modelValue":e[1]||(e[1]=p=>l.model.tags=p),entity:"assistances"},null,8,["modelValue"])]),_:1})]),_:1})])}const Ss=I(Dl,[["render",El]]),Nl=()=>({mask:["AAAAAAAAA","BB AAAAAA"],tokens:{A:{pattern:/\d/},B:{pattern:/[А-Я]/i,transform:t=>t.toUpperCase()}}}),Ol=function(){return[t=>!t||t.length===9||this.$t("This is not a full passport number"),t=>!t||/^\d{9}$/.test(t)||/^[а-я]{2} \d{6}$/i.test(t)||this.$t("This number is invalid")]},Ll={name:"CustomPassport",props:{modelValue:{type:String}},computed:{model:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}},validationRules:Ol,options:Nl}};function Rl(t,e,s,n,a,l){const i=de("maska");return b((g(),P(S,{modelValue:l.model,"onUpdate:modelValue":e[0]||(e[0]=m=>l.model=m),label:t.$t("Passport Number"),rules:l.validationRules,hint:t.$t("Enter the passport or ID card number"),class:"passport",placeholder:"АН 000000","validate-on":"blur",clearable:"",name:"passport",variant:"underlined"},null,8,["modelValue","label","rules","hint"])),[[i,void 0,l.options]])}const Wl=I(Ll,[["render",Rl]]),{people:Bl}=ce,zl={name:"DistributionFormDocument",props:{modelValue:{type:Object,default:()=>({})},id:{type:String},date:{type:[Date,String],default:new Date},householdId:{type:String},distributionId:{type:String}},computed:{model:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}},noData(){return this.taxId&&this.taxId.match(/^\d{10}$/)?!1:this.passport?!(this.passport.match(/^[а-я]{2} *\d{6}$/i)||this.passport.match(/^\d{9}/)):!0}},mounted(){this.model.taxId&&(this.taxId=this.model.taxId),this.model.noTaxId&&(this.noTaxId=this.model.noTaxId),this.model.passport&&(this.passport=this.model.passport),this.id&&(this.currentId=this.id)},data(){return{currentId:void 0,existingDistribution:!1,taxId:void 0,birthday:void 0,age:void 0,gender:void 0,passport:void 0,noTaxId:!1,checkResult:{},loading:!1}},methods:{async checkIPN(t){if(!t)return{result:"error",message:"Tax ID must contain 10 numbers"};if(!t.match(/^\d{10}$/))return{result:"error",message:"Tax ID must contain 10 numbers"};let e=X(t);return e.result==="success"&&(e.age=Bl.calculateAge({birthday:e.birthday,date:this.date}),Object.assign(this.model,L(e)),this.age=e.age,this.birthday=e.birthday,this.gender=e.gender),e.result==="warning"?{result:"warning",message:"This tax ID is invalid"}:e},async checkPOC(){var e,s,n,a;this.loading=!0,this.checkResult={},this.taxId&&(this.checkResult=await this.checkIPN(this.taxId)),this.passport&&(this.checkResult={result:"success"});const t=[this.taxId,this.passport].filter(Boolean);if(this.checkResult.duplicates=await this.checkDuplicates(t),(s=(e=this.checkResult)==null?void 0:e.duplicates)!=null&&s.length){const l=L(this.checkResult.duplicates[0].headOfHousehold);Object.assign(this.checkResult,l)}this.existingDistribution=(a=(n=this.checkResult)==null?void 0:n.duplicates)==null?void 0:a.find(l=>l.distributionId===this.distributionId),this.loading=!1},async checkDuplicates(t){const{assistances:e}=this.$storage;let s=e.useIndex("peopleIds").include(["publicId","bundleName","organization","items","strings","address","date","headOfHousehold","household","familyMembers","headOfHouseholdId"]).filter({peopleIds:t}).sort("date");return s=await s.find(),s.items},checkAnother(){this.taxId=void 0,this.checkDatamartResult={},this.checkResult={}},proceedFurther(){if(this.existingDistribution)return this.setDistribution();let t=this.checkResult.duplicates.find(a=>{var l;return((l=a.headOfHousehold)==null?void 0:l.taxId)===this.taxId&&a.familyMembers});const e=this.checkResult.duplicates.find(a=>a.familyMembers?a.familyMembers.map(l=>l.taxId).includes(this.taxId):!1);let s=this.checkResult.duplicates.find(a=>{var l;return((l=a.headOfHousehold)==null?void 0:l.taxId)===this.taxId});if(t)Object.assign(this.model,t.headOfHousehold),this.$emit("setFamilyMembers",t.familyMembers),t.household&&this.$emit("setHousehold",t.household);else if(typeof e=="object"){let a=e.familyMembers;a=a.filter(l=>l.taxId!==this.taxId),a.push(L(e.headOfHousehold)),this.$emit("setFamilyMembers",a),e.household&&this.$emit("setHousehold",e.household),this.taxId&&(this.model.taxId=this.taxId),this.noTaxId&&(this.model.noTaxId=this.noTaxId),this.passport&&(this.model.passport=this.passport),this.model.age=this.age,this.model.birthday=this.birthday,this.model.gender=this.gender}else typeof s=="object"?(Object.assign(this.model,s.headOfHousehold),s.household&&this.$emit("setHousehold",s.household)):(this.taxId&&(this.model.taxId=this.taxId),this.noTaxId&&(this.model.noTaxId=this.noTaxId),this.passport&&(this.model.passport=this.passport),this.model.age=this.age,this.model.birthday=this.birthday,this.model.gender=this.gender);let n=this.model.passport||this.model.taxId;n=n==="0000000000"?se():n,this.$emit("setId",n)},async setDistribution(){const{assistances:t}=this.$storage,e=await t[this.existingDistribution.id];this.$emit("set-distribution",e),this.$emit("set-id",e.headOfHouseholdId)}},watch:{"model.noTaxId"(t){t&&(this.taxId=void 0,this.checkResult={})},"model.noDocuments"(t){t&&(this.$emit("setId",se()),this.model.taxId="0000000000"),t||(this.model.passport=void 0,this.$emit("setId",void 0))}}},Gl={class:"text-h5 mb-2 offset-md1 black--text"},jl={class:"mb-2"},Hl={class:"mb-2"};function ql(t,e,s,n,a,l){const i=_e,m=Wl,p=ge;return g(),V("div",null,[o(w,{class:"mb-2 mt-2"},{default:u(()=>[o(f,{cols:"12"},{default:u(()=>[r("div",Gl,h(t.$t("Documents")),1),r("div",jl,h(t.$t("Please indicate the person's tax ID or passport number")),1)]),_:1})]),_:1}),o(w,{class:"mb-2 mt-2"},{default:u(()=>[o(f,{cols:"12",md:"6"},{default:u(()=>[o(i,{modelValue:a.taxId,"onUpdate:modelValue":[e[0]||(e[0]=d=>a.taxId=d),e[1]||(e[1]=d=>a.currentId=void 0)],disabled:a.noTaxId||a.checkResult.result==="success",id:"taxId"},null,8,["modelValue","disabled"])]),_:1}),o(f,{cols:"12",md:"6"},{default:u(()=>[b(o(oe,{modelValue:a.noTaxId,"onUpdate:modelValue":e[2]||(e[2]=d=>a.noTaxId=d),label:t.$t("Person has no tax ID"),disabled:typeof a.checkResult.result=="success",name:"noTaxId",id:"noTaxId"},null,8,["modelValue","label","disabled"]),[[y,!l.model.noDocuments]])]),_:1}),b(o(f,{cols:"12"},{default:u(()=>[r("div",Hl,h(t.$t("Please note that the passport number must be provided only if the person refused to receive the tax ID due to the religious beliefs")),1),o(m,{modelValue:a.passport,"onUpdate:modelValue":e[3]||(e[3]=d=>a.passport=d)},null,8,["modelValue"])]),_:1},512),[[y,a.noTaxId]]),Object.keys(a.checkResult).length&&!a.loading&&!a.existingDistribution?(g(),P(p,{key:0,modelValue:a.checkResult,"onUpdate:modelValue":e[4]||(e[4]=d=>a.checkResult=d)},null,8,["modelValue"])):M("",!0),a.existingDistribution?(g(),P(f,{key:1,cols:"12",class:"mt-0 pt-0"},{default:u(()=>[o(pe,{type:"error",closable:""},{default:u(()=>[x(h(t.$t("This person has already received items during the current distribution. Would you like to provide additional items to this person?")),1)]),_:1})]),_:1})):M("",!0),b(o(f,{cols:"12"},{default:u(()=>[r("p",null,h(t.$t("Hereby I confirm that this person has no any identity document")),1),o(oe,{modelValue:l.model.noDocuments,"onUpdate:modelValue":e[5]||(e[5]=d=>l.model.noDocuments=d),label:t.$t("Person has no documents"),name:"noDocuments",id:"noDocuments"},null,8,["modelValue","label"])]),_:1},512),[[y,a.taxId==="0000000000"]]),b(o(f,{cols:"12"},{default:u(()=>[b(o(D,{onClick:l.checkPOC,color:"primary",disabled:a.loading||l.noData},{default:u(()=>[x(h(t.$t("Check")),1)]),_:1},8,["onClick","disabled"]),[[y,a.checkResult.result!=="success"&&a.taxId!=="0000000000"]]),b(o(D,{onClick:l.checkAnother,color:"info",variant:"text",class:"mr-2"},{default:u(()=>[x(h(t.$t("Check another")),1)]),_:1},8,["onClick"]),[[y,a.checkResult.result==="success"&&!a.loading]]),b(o(D,{onClick:l.proceedFurther,color:"primary"},{default:u(()=>[x(h(t.$t("Proceed")),1)]),_:1},8,["onClick"]),[[y,a.checkResult.result==="success"&&!a.loading]])]),_:1},512),[[y,!a.currentId]])]),_:1})])}const Cs=I(zl,[["render",ql]]);export{Cs as _,Ss as a,xs as b,Vs as c,ws as d,ks as e,ys as f};
