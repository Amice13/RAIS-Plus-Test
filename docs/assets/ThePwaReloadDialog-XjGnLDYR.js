import{_ as S}from"./@azure-suSn7m2_.js";import{r as R,a2 as _,a3 as d,a4 as u,a9 as g,a7 as p,W as m,Y as k}from"./@vue-CVhpfiSJ.js";import{_ as C}from"./index-Dr3A69Vy.js";import{f as y,y as x}from"./vuetify-8yKwgmF2.js";function E(s={}){const{immediate:h=!1,onNeedRefresh:n,onOfflineReady:t,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=s;let a,c,f;const w=async(e=!0)=>{await c,f==null||f()};async function W(){if("serviceWorker"in navigator){if(a=await S(async()=>{const{Workbox:e}=await import("./workbox-window-B9K5rw8f.js");return{Workbox:e}},[]).then(({Workbox:e})=>new e("/sw.js",{scope:"/",type:"classic"})).catch(e=>{o==null||o(e)}),!a)return;f=()=>{a==null||a.messageSkipWaiting()};{let e=!1;const v=()=>{e=!0,a==null||a.addEventListener("controlling",l=>{l.isUpdate&&window.location.reload()}),n==null||n()};a.addEventListener("installed",l=>{typeof l.isUpdate>"u"?typeof l.isExternal<"u"&&l.isExternal?v():!e&&(t==null||t()):l.isUpdate||t==null||t()}),a.addEventListener("waiting",v)}a.register({immediate:h}).then(e=>{i?i("/sw.js",e):r==null||r(e)}).catch(e=>{o==null||o(e)})}}return c=W(),w}function P(s={}){const{immediate:h=!0,onNeedRefresh:n,onOfflineReady:t,onRegistered:r,onRegisteredSW:i,onRegisterError:o}=s,a=R(!1),c=R(!1);return{updateServiceWorker:E({immediate:h,onNeedRefresh(){a.value=!0,n==null||n()},onOfflineReady(){c.value=!0,t==null||t()},onRegistered:r,onRegisteredSW:i,onRegisterError:o}),offlineReady:c,needRefresh:a}}const{offlineReady:U,needRefresh:V,updateServiceWorker:B}=P(),L={name:"ThePwaReloadDialog",computed:{model(){return this.offlineReady||this.needRefresh}},mounted(){this.offlineReady=U,this.needRefresh=V},data(){return{text:"Update the app",offlineReady:!1,needRefresh:!1}},methods:{close(){this.offlineReady=!1,this.needRefresh=!1},async update(){await B(),this.needRefresh=!1}}},D={key:0},T={key:1};function j(s,h,n,t,r,i){return d(),_(x,{"model-value":i.model,timeout:-1,color:"primary",class:"pwa-reload"},{actions:u(()=>[r.needRefresh?(d(),_(y,{key:0,onClick:i.close,variant:"text"},{default:u(()=>[k(m(s.$t("Cancel")),1)]),_:1},8,["onClick"])):p("",!0),r.needRefresh?(d(),_(y,{key:1,onClick:i.update,variant:"tonal"},{default:u(()=>[k(m(s.$t("Update")),1)]),_:1},8,["onClick"])):p("",!0),r.offlineReady?(d(),_(y,{key:2,onClick:i.close,variant:"text"},{default:u(()=>[k(m(s.$t("Ok")),1)]),_:1},8,["onClick"])):p("",!0)]),default:u(()=>[r.needRefresh?(d(),g("span",D,m(s.$t("Update the app")),1)):p("",!0),r.offlineReady?(d(),g("span",T,m(s.$t("App is ready to work offline")),1)):p("",!0)]),_:1},8,["model-value"])}const q=C(L,[["render",j]]);export{q as _};
