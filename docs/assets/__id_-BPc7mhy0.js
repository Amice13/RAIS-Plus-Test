import{_ as K,a as J,b as Q}from"./CustomOrganizationType-BQcNGrpL.js";import{_ as X,a as Y,S as Z,b as x,c as ee,d as te,e as le,f as ae,g as ne,h as oe,i as ie,j as de,k as se,l as re}from"./SN209-BxSOHfGE.js";import{_ as ue}from"./ImportDialog-BEI359wz.js";import{_ as U,v as me,c as S,o as v,w as n,a as l,x as m,a8 as O,C as b,y as u,A as N,F as $,G as ce,H as pe,z as y,B as D,ac as fe,E as be,ak as he,ap as P,M as _e}from"./index-BtIo2-Z_.js";import{a as w,V as j}from"./VCard-DNHZbZ5d.js";import{a as p,V as i}from"./VRow-9vAZildp.js";import{V as z}from"./VBtn--bGuKZaN.js";import{_ as ge}from"./index-CobKs7Bm.js";import{_ as ve}from"./CustomEmail-D9y7_eej.js";import{_ as Ve}from"./CustomPhone-Cd36n-GU.js";import{_ as ye}from"./CustomGender-C5TgvEjC.js";import{a as Se,_ as Oe}from"./CustomTextFieldTranslit-gE4NQy6n.js";import{V as g}from"./VTextField-Bn35T3UG.js";import{d as Ne}from"./debouncer-Whu4ZLob.js";import{V as I}from"./index-SDX8Otz2.js";import{a as ke,b as Ue}from"./VList-Cnqqz-5U.js";import{V as $e}from"./VProgressCircular-DNPB7izS.js";import{V as we,_ as je}from"./CustomTag-5aeppRFS.js";import{V as T}from"./VAvatar-l5UJO0sV.js";import{_ as Ce}from"./RequestOrganizations-C8WFb9r7.js";import{_ as ze}from"./CustomDate-CLArRqjL.js";import{_ as De}from"./CustomPopulationType-DQPosMme.js";import{_ as Ie}from"./CustomBundle-HZg5QtVE.js";import{b as A}from"./route-block-B_A1xBdJ.js";import"./index-CebfcyPH.js";import"./filter-ahsWVyiP.js";import"./VInput-CRZE-Mt3.js";import"./index-C5-hvfiu.js";import"./forwardRefs--KQCZfKO.js";import"./VMenu-Cs322VI3.js";import"./VOverlay-BnbjS8dz.js";import"./dialog-transition-Dq7CKyny.js";import"./VCheckboxBtn-DQUGWCnj.js";import"./VChip-CKNl8kC9.js";import"./group-DgRBM2CV.js";import"./VAutocomplete-BVJCf0KD.js";import"./index-mGYzLmSq.js";import"./data-BbwszT0d.js";import"./index-T2HRTWtS.js";import"./importProcessor-Cg8urtX2.js";import"./VAlert-Or5Mzxjd.js";import"./VCheckbox-Berrf7y1.js";import"./VSpacer-bp7-SSB-.js";/* empty css              */import"./VDialog-CNptTdRK.js";import"./VDataTableVirtual-Cqes2yZi.js";import"./VDataTable-BrBBORsC.js";import"./VPagination-zp71F-1D.js";import"./VTooltip-DXl_TsVy.js";import"./VToolbar-o4oksDe3.js";import"./VImg-FY_z5S7Z.js";import"./CustomMultipleBundle-DHoJd0Qs.js";import"./VContainer-BFGIFtcM.js";import"./xlsx-CILBIiVl.js";import"./VSystemBar-Cr7lwDBT.js";import"./CustomEntitySelector-Kl7YJaGR.js";const Ee={name:"DonationSupportingDocuments",inject:["$error","$loading"],props:{modelValue:{type:Object,default:()=>({})}},data(){return{dialog:!1,distributions:[]}},computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},importIsNotAvailable(){var e,t,d,f,o,a,r;if(["Archived"].includes((e=this.model)==null?void 0:e.status))return(!0)[this.model.bundleName,this.model.date,(t=this.model.organization)==null||t.id,(d=this.model.receivingOrganization)==null||d.id,(f=this.model.address)==null?void 0:f.pCode4];if(!this.model.bundleName||!this.model.date||!((o=this.model.organization)!=null&&o.id)||!((a=this.model.receivingOrganization)!=null&&a.id)||!((r=this.model.address)!=null&&r.pCode4))return!0}},methods:{async getDistributions(){if(!this.model.id)return[];const{requests:e}=this.$storage;try{const t=await e.include(["id","publicId"]).filter({donationId:[this.model.id]}).find();t!=null&&t.count&&(this.distributions=t.items)}catch(t){console.log(t)}this.appStore.loading=!1},async finalizeImport(e){this.$goToPreviousPage()}},watch:{"model.publicId"(){this.getDistributions()}}},Pe={class:"text-h5 mb-2 offset-md1 black--text"},Te={class:"text-h5 mt-1"},Ae={class:"mt-4 ml-4"};function Fe(e,t,d,f,o,a){const r=me("router-link"),s=ue;return v(),S(j,{class:"data-block supporting-documents",rounded:"0"},{default:n(()=>[l(w,null,{default:n(()=>[l(p,{class:"mb-4 mt-4"},{default:n(()=>[l(i,{cols:"12",md:"3",class:"pl-md-16"},{default:n(()=>[m("div",Pe,[O(e.$slots,"itemset-header",{},()=>[b(u(e.$t("Convert into distributions")),1)])]),m("div",null,[O(e.$slots,"itemset-description",{},()=>[b(u(e.$t("Import the raw data to convert the donations into distributions")),1)])])]),_:3}),l(i,{cols:"12",md:"9",class:"pr-md-16 pt-2"},{default:n(()=>[l(p,null,{default:n(()=>[o.distributions.length?(v(),S(i,{key:0},{default:n(()=>[m("div",Te,u(e.$t("Related distributions")),1),m("div",null,[m("ul",Ae,[(v(!0),$(ce,null,pe(o.distributions,V=>(v(),$("li",{key:V.id},[l(r,{to:`/distributions/${V.id}`,class:"primary text-decoration-none"},{default:n(()=>[b(u(V.publicId),1)]),_:2},1032,["to"]),t[3]||(t[3]=b(" (")),l(r,{to:`/requests/${V.id}`,class:"primary text-decoration-none"},{default:n(()=>[b(u(e.$t("Request")),1)]),_:2},1032,["to"]),t[4]||(t[4]=b(") "))]))),128))])])]),_:1})):N("",!0)]),_:1}),l(p,null,{default:n(()=>[l(i,{cols:"12",class:"mt-4"},{default:n(()=>[l(z,{onClick:t[0]||(t[0]=V=>o.dialog=!0),disabled:a.importIsNotAvailable,color:"primary"},{default:n(()=>[b(u(e.$t("Import data")),1)]),_:1},8,["disabled"]),l(s,{onImported:t[1]||(t[1]=V=>a.finalizeImport(V)),onClose:t[2]||(t[2]=V=>o.dialog=!1),dialog:o.dialog,"is-donation":!0,initialData:a.model,disabled:!0},null,8,["dialog","initialData"])]),_:1})]),_:1})]),_:1})]),_:3})]),_:3})]),_:3})}const Me=U(Ee,[["render",Fe]]),Be={name:"DonationSupportingDocuments",props:{modelValue:{type:Object,default:()=>({})}},computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}}},Re={class:"text-h5 mb-2 offset-md1 black--text"};function qe(e,t,d,f,o,a){const r=ge;return v(),S(j,{class:"data-block supporting-documents",rounded:"0"},{default:n(()=>[l(w,null,{default:n(()=>[l(p,{class:"mb-4 mt-4"},{default:n(()=>[l(i,{cols:"12",md:"3",class:"pl-md-16"},{default:n(()=>[m("div",Re,[O(e.$slots,"itemset-header",{},()=>[b(u(e.$t("Supporting documents")),1)])]),m("div",null,[O(e.$slots,"itemset-description",{},()=>[b(u(e.$t("Here you can upload all the documents related to the donation")),1)])])]),_:3}),l(i,{cols:"12",md:"9",class:"pr-md-16 pt-0"},{default:n(()=>[l(p,null,{default:n(()=>[l(i,{cols:"12",class:"mt-4"},{default:n(()=>[l(r,{modelValue:a.model,"onUpdate:modelValue":t[0]||(t[0]=s=>a.model=s),multiple:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:3})]),_:3})]),_:3})}const Le=U(Be,[["render",qe]]),He={name:"DonationReceivingFocalPoint",props:{modelValue:{type:Object,default:()=>({})}},computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},watch:{"model.translation.uk.familyName"(e){this.model.familyName=this.$_translit(e)},"model.translation.uk.givenName"(e){this.model.givenName=this.$_translit(e)}}},Ge={class:"text-h5 mb-2 offset-md1 black--text"};function We(e,t,d,f,o,a){const r=Se,s=ye,V=Ve,k=ve;return v(),S(j,{class:"data-block focal-point",rounded:"0"},{default:n(()=>[l(w,null,{default:n(()=>[l(p,{class:"mb-4 mt-4"},{default:n(()=>[l(i,{cols:"12",md:"3",class:"pl-md-16"},{default:n(()=>[m("div",Ge,[O(e.$slots,"itemset-header",{},()=>[b(u(e.$t("Focal point")),1)])]),m("div",null,[O(e.$slots,"itemset-description",{},()=>[b(u(e.$t("Please provide the data about the focal point of receiving organization")),1)])])]),_:3}),l(i,{cols:"12",md:"9",class:"pr-md-16 pt-0"},{default:n(()=>[l(p,null,{default:n(()=>[l(i,{cols:"12",class:"mt-4"},{default:n(()=>[l(p,null,{default:n(()=>[l(i,{cols:"12",class:"mt-1 mb-2"},{default:n(()=>[m("div",null,u(e.$t("Please provide the name of the person in Ukrainian and check the proper transliteration below")),1)]),_:1}),l(i,{cols:"12",lg:"4"},{default:n(()=>[l(g,{modelValue:a.model.translation.uk.familyName,"onUpdate:modelValue":t[0]||(t[0]=_=>a.model.translation.uk.familyName=_),label:e.$t("Family name (ua)"),id:"familyNameUk",name:"familyNameUk",variant:"underlined"},null,8,["modelValue","label"])]),_:1}),l(i,{cols:"12",lg:"4"},{default:n(()=>[l(g,{modelValue:a.model.translation.uk.givenName,"onUpdate:modelValue":t[1]||(t[1]=_=>a.model.translation.uk.givenName=_),label:e.$t("Given name (ua)"),id:"givenNameUk",name:"givenNameUk",variant:"underlined"},null,8,["modelValue","label"])]),_:1}),l(i,{cols:"12",lg:"4"},{default:n(()=>[l(g,{modelValue:a.model.translation.uk.additionalName,"onUpdate:modelValue":t[2]||(t[2]=_=>a.model.translation.uk.additionalName=_),label:e.$t("Adittional name (ua)"),id:"additionalNameUk",name:"additionalNameUk",variant:"underlined"},null,8,["modelValue","label"])]),_:1})]),_:1}),l(p,null,{default:n(()=>[l(i,{cols:"12"},{default:n(()=>[m("div",null,u(e.$t("Please change this if the data in the international passport is different from the official transliteration")),1)]),_:1}),l(i,{cols:"12",lg:"4"},{default:n(()=>[l(r,{modelValue:a.model.familyName,"onUpdate:modelValue":t[3]||(t[3]=_=>a.model.familyName=_),label:e.$t("Family name"),variant:"underlined",id:"familyName",name:"familyName"},null,8,["modelValue","label"])]),_:1}),l(i,{cols:"12",lg:"4"},{default:n(()=>[l(r,{modelValue:a.model.givenName,"onUpdate:modelValue":t[4]||(t[4]=_=>a.model.givenName=_),label:e.$t("Given name"),name:"givenName",variant:"underlined",id:"givenName"},null,8,["modelValue","label"])]),_:1}),l(i,{cols:"6"},{default:n(()=>[l(s,{modelValue:a.model.gender,"onUpdate:modelValue":t[5]||(t[5]=_=>a.model.gender=_)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(i,{cols:"12",class:"mt-8"},{default:n(()=>[b(u(e.$t("Provide emails and contact phone numbers")),1)]),_:1}),l(i,{cols:"12"},{default:n(()=>[l(V,{modelValue:a.model.phone,"onUpdate:modelValue":t[6]||(t[6]=_=>a.model.phone=_),label:e.$t("Phone number"),mode:"edit",multiple:""},null,8,["modelValue","label"])]),_:1}),l(i,{cols:"12"},{default:n(()=>[l(k,{modelValue:a.model.email,"onUpdate:modelValue":t[7]||(t[7]=_=>a.model.email=_),mode:"edit",multiple:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:3})]),_:3})]),_:3})}const Ke=U(He,[["render",We]]),Je=Ne(function(e){this.getEntities()}),Qe=["Active","Suspended","Closed"],Xe={name:"EntitySelector",inject:["$confirm","$error"],props:{modelValue:{type:Object,default:()=>({})},initialData:{type:Object,default:()=>({})},field:{type:String,default:"name"},fields:{type:Array},disabled:{type:Boolean},label:{type:String},hint:{type:String}},data(){return{editMode:!1,search:void 0,currentEntity:void 0,items:[],loading:!1}},methods:{async getEntities(){if(!this.search||this.search.length<3)return[];this.loading=!0;const{organizations:e}=this.$storage;try{const t=await e.filter({[this.field]:{$contains:this.search}}).include(this.fields).find();this.items=t.items}catch{await this.$error({title:"The list of organizations is unavailable"})}this.loading=!1},removeEntity(){this.currentEntity=void 0,this.model=void 0},translateName(e){var t,d;try{return this.field.split(".").reduce((f,o)=>f[o],e)}catch{return this.field.replace(/translation\.uk/,"").split(".").reduce((o,a)=>o[a],e)}return this.$i18n.locale==="en"?e[this.field]:(t=e.translation)!=null&&t[this.$i18n.locale]?(d=e.translation)==null?void 0:d[this.$i18n.locale][this.rawField]:e[this.rawField]},async selectEntity(e){if(this.loading)return!1;const t=e.target.value,d=t.replace(/\./,"\\\\.").replace(/[^a-zа-яєіїґ\d\.\\]/gi,""),f=new RegExp(`^${d}$`,"gi"),o=this.items.find(s=>{var V,k;if(s[this.field].match(f)||(k=(V=s.translation)==null?void 0:V.uk)!=null&&k[this.field]&&s.translation.uk[this.field].match(f))return!0});if(o)return delete o["translation.uk.name"],this.currentEntity=o,this.model=o,!1;if(!await this.$confirm({title:"Create organization",description:"Do you want to create a new organization?"}))return!1;const r={status:"Active",type:"Government",functionalType:"Local authority",translation:{uk:{}}};this.$i18n.locale==="en"&&(r[this.field]=t),this.$i18n.locale==="uk"&&(r.translation.uk[this.rawField]=t),this.currentEntity=r,this.editMode=!0},async saveEntity(){const e=JSON.parse(JSON.stringify(this.currentEntity));Object.assign(e,this.initialData);let t;try{const{organizations:d}=this.$storage;t=await d.push(e),this.model={id:t.id,name:t.name,code:t.code,translation:{uk:{name:t.translation.uk.name}}}}catch(d){await this.$error(d),t=!1}t&&(this.editMode=!1)},resetEntity(){this.search=void 0,this.model=void 0,this.currentEntity=void 0,this.editMode=!1}},computed:{model:{get(){return this.modelValue},set(e){e&&delete e["translation.uk.name"],this.$emit("update:modelValue",e)}},statuses(){return Qe},translatedLabel(){return this.label?this.label:this.$t("Entity")},itemList(){return this.$i18n.locale==="en"?this.items:this.items.map(e=>{var t,d;return this.$i18n.locale!=="en"&&(e[this.field]=((d=(t=e.translation)==null?void 0:t[this.$i18n.locale])==null?void 0:d[this.rawField])||e[this.rawField]),e})},rawField(){return this.field.replace(/^translation\.[^.]*\./g,"")}},watch:{search:Je,currentEntity:{deep:!0,handler(e){typeof e=="object"&&(this.model=e)}}}},Ye={class:"organization-combobox"},Ze={key:0,class:"d-flex align-center"},xe={class:"flex-grow-1 mb-2"},et={class:"text-caption"},tt={class:"text-h6"},lt={key:1},at={key:2};function nt(e,t,d,f,o,a){var k,_;const r=Oe,s=K,V=J;return v(),$("div",Ye,[a.model&&((k=a.model)!=null&&k[a.rawField])&&!o.editMode?(v(),$("div",Ze,[m("div",xe,[m("div",et,u(a.translatedLabel),1),m("div",tt,u(a.translateName(a.model)),1)]),m("div",null,[d.disabled?N("",!0):(v(),S(z,{key:0,variant:"tonal",color:"primary",onClick:a.removeEntity},{default:n(()=>[l(I,null,{default:n(()=>t[10]||(t[10]=[b("mdi-delete")])),_:1})]),_:1},8,["onClick"]))])])):N("",!0),o.editMode?N("",!0):(v(),$("div",lt,[y(l(we,{modelValue:o.currentEntity,"onUpdate:modelValue":t[0]||(t[0]=c=>o.currentEntity=c),search:o.search,"onUpdate:search":t[1]||(t[1]=c=>o.search=c),onKeyup:be(a.selectEntity,["enter"]),items:a.itemList,"hide-no-data":o.search&&o.search.length===0,hint:d.hint?d.hint:"",label:a.translatedLabel,loading:o.loading,"item-title":d.field,disabled:d.disabled,clearable:"",variant:"underlined"},{"no-data":n(()=>[l(ke,{class:fe({"text-center":o.loading})},{default:n(()=>[y(l($e,{class:"margin-auto",indeterminate:"",color:"primary"},null,512),[[D,o.loading]]),y(l(Ue,null,{default:n(()=>[b(u(e.$t("No results matching"))+' "',1),m("strong",null,u(o.search),1),b('". '+u(e.$t("Press"))+" ",1),t[11]||(t[11]=m("kbd",null,"Enter",-1)),b(" "+u(e.$t("to create a new one")),1)]),_:1},512),[[D,!o.loading]])]),_:1},8,["class"])]),_:1},8,["modelValue","search","onKeyup","items","hide-no-data","hint","label","loading","item-title","disabled"]),[[D,!((_=a.model)!=null&&_[a.rawField])]])])),o.editMode&&o.currentEntity?(v(),$("div",at,[l(p,{class:"pt-0 pb-0"},{default:n(()=>[l(i,{class:"pb-0",cols:"12",md:"6",lg:"8"},{default:n(()=>[l(g,{modelValue:o.currentEntity.name,"onUpdate:modelValue":t[2]||(t[2]=c=>o.currentEntity.name=c),label:e.$t("Organization name"),id:"name",name:"name",variant:"underlined"},null,8,["modelValue","label"])]),_:1}),l(i,{class:"pb-0",cols:"12",md:"6",lg:"4"},{default:n(()=>[l(g,{modelValue:o.currentEntity.code,"onUpdate:modelValue":t[3]||(t[3]=c=>o.currentEntity.code=c),label:e.$t("Legal entity code"),id:"code",name:"code",variant:"underlined"},null,8,["modelValue","label"])]),_:1})]),_:1}),l(p,{class:"pt-0 pb-0"},{default:n(()=>[l(i,{class:"pb-0",cols:"12"},{default:n(()=>[l(g,{modelValue:o.currentEntity.legalName,"onUpdate:modelValue":t[4]||(t[4]=c=>o.currentEntity.legalName=c),label:e.$t("Full legal name"),id:"legalName",name:"legalName",variant:"underlined"},null,8,["modelValue","label"])]),_:1})]),_:1}),l(p,{class:"pt-0 pb-0"},{default:n(()=>[l(i,{class:"pb-0",cols:"12"},{default:n(()=>[l(g,{modelValue:o.currentEntity.translation.uk.name,"onUpdate:modelValue":t[5]||(t[5]=c=>o.currentEntity.translation.uk.name=c),label:e.$t("Name in Ukrainian"),id:"nameUkr",name:"nameUkr",variant:"underlined"},null,8,["modelValue","label"])]),_:1})]),_:1}),l(p,{class:"pt-0 pb-0"},{default:n(()=>[l(i,{class:"pb-0",cols:"12"},{default:n(()=>[l(g,{modelValue:o.currentEntity.translation.uk.legalName,"onUpdate:modelValue":t[6]||(t[6]=c=>o.currentEntity.translation.uk.legalName=c),label:e.$t("Full legal name in Ukrainian"),id:"legalNameUkr",name:"legalNameUkr",variant:"underlined"},null,8,["modelValue","label"])]),_:1})]),_:1}),l(p,{class:"pt-0 pb-0"},{default:n(()=>[l(i,{class:"pb-0",cols:"12",md:"6",lg:"4"},{default:n(()=>[l(r,{modelValue:a.model.status,"onUpdate:modelValue":t[7]||(t[7]=c=>a.model.status=c),items:a.statuses,label:e.$t("Organization status")},null,8,["modelValue","items","label"])]),_:1}),l(i,{class:"pb-0",cols:"12",md:"6",lg:"4"},{default:n(()=>[l(s,{modelValue:a.model.type,"onUpdate:modelValue":t[8]||(t[8]=c=>a.model.type=c)},null,8,["modelValue"])]),_:1}),l(i,{class:"pb-0",cols:"12",md:"6",lg:"4"},{default:n(()=>[l(V,{modelValue:a.model.functionalType,"onUpdate:modelValue":t[9]||(t[9]=c=>a.model.functionalType=c)},null,8,["modelValue"])]),_:1})]),_:1}),l(p,{class:"pt-4 pb-0"},{default:n(()=>[l(i,{cols:"12",class:"text-right"},{default:n(()=>[l(z,{onClick:a.resetEntity,class:"mr-2",color:"error",variant:"plain"},{default:n(()=>[b(u(e.$t("Cancel")),1)]),_:1},8,["onClick"]),l(z,{onClick:a.saveEntity,color:"primary"},{default:n(()=>[b(u(e.$t("Save")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})])):N("",!0)])}const ot=U(Xe,[["render",nt]]),it={name:"DonationReceivingOrganization",props:{modelValue:{type:Object,default:()=>({})},initialData:{type:Object,default:()=>({})}},computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},methods:{resetBundle(){this.model.items=[]}}},dt={class:"text-h5 mb-2 offset-md1 black--text"};function st(e,t,d,f,o,a){const r=ot;return v(),S(j,{class:"data-block receiving-organization",rounded:"0"},{default:n(()=>[l(w,null,{default:n(()=>[l(p,{class:"mb-4 mt-4"},{default:n(()=>[l(i,{cols:"12",md:"3",class:"pl-md-16"},{default:n(()=>[m("div",dt,[O(e.$slots,"itemset-header",{},()=>[b(u(e.$t("Donation receiving organization")),1)])]),m("div",null,[O(e.$slots,"itemset-description",{},()=>[b(u(e.$t("Please indicate the information about the donatee")),1)])])]),_:3}),l(i,{cols:"12",md:"9",class:"pr-md-16 pt-0"},{default:n(()=>[l(p,null,{default:n(()=>[l(i,{cols:"12",class:"mt-2"},{default:n(()=>[l(r,{modelValue:a.model.receivingOrganization,"onUpdate:modelValue":t[0]||(t[0]=s=>a.model.receivingOrganization=s),"initial-data":d.initialData,label:e.$t("Receiving organization"),fields:["name","code","translation.uk.name"],field:e.$i18n.locale==="en"?"name":"translation.uk.name",entity:"organizations"},null,8,["modelValue","initial-data","label","field"])]),_:1})]),_:1})]),_:1})]),_:3})]),_:3})]),_:3})}const rt=U(it,[["render",st]]),ut=()=>({mask:"A",tokens:{A:{pattern:/\d/,multiple:!0}}}),C=40997698,mt={boys:3785605/C,girls:3562926/C,men:11551502/C,women:11945282/C,seniorMen:3669872/C,seniorWomen:6482511/C},ct={name:"DonationSummary",props:{modelValue:{type:Object,default:()=>({})}},computed:{options:ut,model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},methods:{calculateTotal(){const t=["boys","girls","men","women","seniorMen","seniorWomen","adultsOther"].reduce((d,f)=>{var o,a;return(a=(o=this.model)==null?void 0:o.familyStats)!=null&&a[f]&&(d=d+parseInt(this.model.familyStats[f])),d},0);this.model.familyStats.all=t},calculateGroups(){var t,d;if(!((d=(t=this.model)==null?void 0:t.familyStats)!=null&&d.all))return!1;let e=0;for(let[f,o]of Object.entries(mt))this.model.familyStats[f]=Math.round(this.model.familyStats.all*o,0),e=e+this.model.familyStats[f];this.model.familyStats.all=e,this.model.households=Math.round(e/3,0),this.model.buildings=Math.round(e/3,0)}}},pt={class:"text-h5 mb-2 offset-md1 black--text"},ft={class:"mb-4 mt-4"},bt={class:"mb-4 mt-4"},ht={class:"mb-4 mt-4"},_t={class:"mb-4"},gt={class:"ml-4 text-h6"},vt={class:"mb-4"},Vt={class:"ml-4 text-h6"},yt={class:"mb-4 mt-4"};function St(e,t,d,f,o,a){const r=he("maska");return v(),S(j,{class:"data-block donation-summary",rounded:"0"},{default:n(()=>[l(w,null,{default:n(()=>[l(p,{class:"mb-4 mt-4"},{default:n(()=>[l(i,{cols:"12",md:"3",class:"pl-md-16"},{default:n(()=>[m("div",pt,[O(e.$slots,"itemset-header",{},()=>[b(u(e.$t("Donation summary")),1)])]),m("div",null,[O(e.$slots,"itemset-description",{},()=>[b(u(e.$t("Please indicate the number of covered beneficiaries")),1)])])]),_:3}),l(i,{cols:"12",md:"9",class:"pr-md-16 pt-0"},{default:n(()=>[l(p,null,{default:n(()=>[l(i,{cols:"12"},{default:n(()=>[m("div",ft,u(e.$t("Indicate the total number of individuals that will receive the items. If you don't have the SADD data, you can try make an estimation with the calculation.")),1),m("div",bt,u(e.$t("The estimation will be made basing on the distribution of the population by age and gender estimated by the State Service of Statistics in 2022.")),1),y(l(g,{modelValue:a.model.familyStats.all,"onUpdate:modelValue":t[0]||(t[0]=s=>a.model.familyStats.all=s),label:e.$t("Number of individuals"),pattern:"[0-9]",inputmode:"numeric",novalidate:"",lang:"en",variant:"underlined","append-icon":a.model.familyStats.all?"mdi-calculator":void 0,"onClick:append":a.calculateGroups,"hide-details":""},null,8,["modelValue","label","append-icon","onClick:append"]),[[r,void 0,a.options]])]),_:1})]),_:1}),l(p,null,{default:n(()=>[l(i,{cols:"12"},{default:n(()=>[y(l(g,{modelValue:a.model.households,"onUpdate:modelValue":t[1]||(t[1]=s=>a.model.households=s),label:e.$t("Number of assisted households"),pattern:"[0-9]",inputmode:"numeric",novalidate:"",lang:"en",variant:"underlined","hide-details":""},null,8,["modelValue","label"]),[[r,void 0,a.options]])]),_:1})]),_:1}),l(p,null,{default:n(()=>[l(i,{cols:"12"},{default:n(()=>[y(l(g,{modelValue:a.model.buildings,"onUpdate:modelValue":t[2]||(t[2]=s=>a.model.buildings=s),label:e.$t("Number of assisted houses"),hint:e.$t("Usually, this field must be equal to the number of households"),pattern:"[0-9]",inputmode:"numeric",novalidate:"",lang:"en",variant:"underlined","hide-details":"auto"},null,8,["modelValue","label","hint"]),[[r,void 0,a.options]])]),_:1})]),_:1}),l(p,null,{default:n(()=>[l(i,{cols:"12"},{default:n(()=>[m("div",ht,u(e.$t("Provide the number of assisted people by groups.")),1)]),_:1}),l(i,{cols:"6"},{default:n(()=>[m("div",_t,[l(T,{color:"grey-darken-1",rounded:"0"},{default:n(()=>[l(I,{icon:"mdi-human-male"})]),_:1}),m("strong",gt,u(e.$t("Males")),1)]),y(l(g,{modelValue:a.model.familyStats.boys,"onUpdate:modelValue":[t[3]||(t[3]=s=>a.model.familyStats.boys=s),a.calculateTotal],label:e.$t("Number of male children"),hint:e.$t("Boys under 18"),class:"mb-1",pattern:"[0-9]",inputmode:"numeric",novalidate:"",lang:"en",variant:"underlined"},null,8,["modelValue","onUpdate:modelValue","label","hint"]),[[r,void 0,a.options]]),y(l(g,{modelValue:a.model.familyStats.men,"onUpdate:modelValue":[t[4]||(t[4]=s=>a.model.familyStats.men=s),a.calculateTotal],label:e.$t("Number of adult males"),hint:e.$t("Men aged 18-60"),class:"mb-1",pattern:"[0-9]",inputmode:"numeric",novalidate:"",lang:"en",variant:"underlined"},null,8,["modelValue","onUpdate:modelValue","label","hint"]),[[r,void 0,a.options]]),y(l(g,{modelValue:a.model.familyStats.seniorMen,"onUpdate:modelValue":[t[5]||(t[5]=s=>a.model.familyStats.seniorMen=s),a.calculateTotal],label:e.$t("Number of aged males"),hint:e.$t("Men over 60"),class:"mb-1",pattern:"[0-9]",inputmode:"numeric",novalidate:"",lang:"en",variant:"underlined"},null,8,["modelValue","onUpdate:modelValue","label","hint"]),[[r,void 0,a.options]])]),_:1}),l(i,{cols:"6"},{default:n(()=>[m("div",vt,[l(T,{color:"grey-darken-1",rounded:"0"},{default:n(()=>[l(I,{icon:"mdi-human-female"})]),_:1}),m("strong",Vt,u(e.$t("Females")),1)]),y(l(g,{modelValue:a.model.familyStats.girls,"onUpdate:modelValue":[t[6]||(t[6]=s=>a.model.familyStats.girls=s),a.calculateTotal],label:e.$t("Number of female children"),hint:e.$t("Girls under 18"),pattern:"[0-9]",class:"mb-1",inputmode:"numeric",novalidate:"",lang:"en",variant:"underlined"},null,8,["modelValue","onUpdate:modelValue","label","hint"]),[[r,void 0,a.options]]),y(l(g,{modelValue:a.model.familyStats.women,"onUpdate:modelValue":[t[7]||(t[7]=s=>a.model.familyStats.women=s),a.calculateTotal],label:e.$t("Number of adult females"),hint:e.$t("Women aged 18-60"),class:"mb-1",pattern:"[0-9]",inputmode:"numeric",novalidate:"",lang:"en",variant:"underlined"},null,8,["modelValue","onUpdate:modelValue","label","hint"]),[[r,void 0,a.options]]),y(l(g,{modelValue:a.model.familyStats.seniorWomen,"onUpdate:modelValue":[t[8]||(t[8]=s=>a.model.familyStats.seniorWomen=s),a.calculateTotal],label:e.$t("Number of aged females"),hint:e.$t("Women over 60"),class:"mb-1",pattern:"[0-9]",inputmode:"numeric",novalidate:"",lang:"en",variant:"underlined"},null,8,["modelValue","onUpdate:modelValue","label","hint"]),[[r,void 0,a.options]])]),_:1})]),_:1}),l(p,null,{default:n(()=>[l(i,{cols:"12"},{default:n(()=>[m("div",yt,u(e.$t("Additional data about assisted people")),1),y(l(g,{modelValue:a.model.familyStats.adultsOther,"onUpdate:modelValue":[t[9]||(t[9]=s=>a.model.familyStats.adultsOther=s),a.calculateTotal],label:e.$t("Number of other people"),hint:e.$t("People who do not want to disclose their age or gender"),pattern:"[0-9]",inputmode:"numeric",novalidate:"",lang:"en",variant:"underlined","hide-details":"auto"},null,8,["modelValue","onUpdate:modelValue","label","hint"]),[[r,void 0,a.options]])]),_:1}),l(i,{cols:"12"},{default:n(()=>[y(l(g,{modelValue:a.model.familyStats.disabled,"onUpdate:modelValue":t[10]||(t[10]=s=>a.model.familyStats.disabled=s),label:e.$t("Number of people with disabilities"),rules:[s=>s<parseInt(a.model.familyStats.all)||"Can't be greater than the total number of people"],pattern:"[0-9]",inputmode:"numeric",novalidate:"",lang:"en",variant:"underlined","hide-details":"auto"},null,8,["modelValue","label","rules"]),[[r,void 0,a.options]])]),_:1}),l(i,{cols:"12"},{default:n(()=>[y(l(g,{modelValue:a.model.familyStats.vulnerable,"onUpdate:modelValue":t[11]||(t[11]=s=>a.model.familyStats.vulnerable=s),label:e.$t("Number of people with vulnerabilities"),rules:[s=>s<parseInt(a.model.familyStats.all)||"Can't be greater than the total number of people"],pattern:"[0-9]",inputmode:"numeric",novalidate:"",lang:"en",variant:"underlined","hide-details":""},null,8,["modelValue","label","rules"]),[[r,void 0,a.options]])]),_:1})]),_:1})]),_:1})]),_:3})]),_:3})]),_:3})}const Ot=U(ct,[["render",St]]),F={"SN101-2024":[{key:"Person needs technical assistance",values:[{value:"Person needs technical assistance"}]},{key:"Assistance status",values:[{value:"Assisted by partner",filter:{"Person needs technical assistance":"Person needs technical assistance"}},{value:"Assisted by authority or other party",filter:{"Person needs technical assistance":"Person needs technical assistance"}}]}],"SN105-2024":[{key:"Selection criteria",values:[{value:"Houses with wooden windows"},{value:"Houses with heating system installed more than 20 years ago"},{value:"Houses without facade insulation"}]},{key:"Installation service is provided",values:[{value:"Installation service is provided"}]}]},Nt={name:"DonationAdditionalData",props:{modelValue:{type:Object,default:()=>({})}},mounted(){var e,t;if(!((t=(e=this.modelValue)==null?void 0:e.strings)!=null&&t.length))return!1;this.itemset=P(this.modelValue.strings)},data(){return{itemset:{}}},computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},questions(){return F[this.model.bundleName]?F[this.model.bundleName]:!1},itemlist(){return this.questions?this.questions.map(({key:e,values:t})=>t.map(({value:d})=>({title:this.$t(d),subtitle:this.$t(e),key:e+"/"+d}))).flat():[]}},methods:{setData(){const e=Object.entries(this.itemset).map(([t,d])=>({key:t,value:parseFloat(d)})).filter(t=>t.value);this.model.strings=e}},watch:{"model.strings":{deep:!0,handler(e){if(!(e!=null&&e.length))return!1;this.itemset=P(e)}}}},kt={class:"text-h5 mb-2 offset-md1 black--text"};function Ut(e,t,d,f,o,a){const r=X;return a.questions?(v(),S(j,{key:0,class:"data-block",rounded:"0"},{default:n(()=>[l(w,null,{default:n(()=>[l(p,{class:"mb-4 mt-4"},{default:n(()=>[l(i,{cols:"12",md:"3",class:"pl-md-16"},{default:n(()=>[m("div",kt,[O(e.$slots,"itemset-header",{},()=>[b(u(e.$t("Additional data")),1)])]),m("div",null,[O(e.$slots,"itemset-description",{},()=>[b(u(e.$t("Please provide the information related to the current distribution")),1)])])]),_:3}),l(i,{cols:"12",md:"9",class:"pr-md-16 pt-0"},{default:n(()=>[l(p,{class:"mt-2"},{default:n(()=>[l(i,{cols:"12"},{default:n(()=>[l(r,{modelValue:o.itemset,"onUpdate:modelValue":t[0]||(t[0]=s=>o.itemset=s),onInput:a.setData,items:a.itemlist},null,8,["modelValue","onInput","items"])]),_:1})]),_:1})]),_:1})]),_:3})]),_:3})]),_:3})):N("",!0)}const $t=U(Nt,[["render",Ut]]),wt={name:"DonationBasic",props:{modelValue:{type:Object,default:()=>({})}},computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},bundles(){return bundles},isUNHCR(){var e,t;return(t=(e=this.appStore.user)==null?void 0:e.organization)!=null&&t.name?/UNHCR/.exec(this.appStore.user.organization.name):!1}},methods:{resetBundle(){this.model.items=[]}}},jt={class:"text-h5 mb-2 offset-md1 black--text"};function Ct(e,t,d,f,o,a){const r=Ie,s=De,V=ze,k=Y,_=je;return v(),S(j,{class:"data-block pt-sm-4 pb-sm-4 pt-md-16",rounded:"0"},{default:n(()=>[l(w,null,{default:n(()=>[l(p,{class:"mb-4 mt-4"},{default:n(()=>[l(i,{cols:"12",md:"3",class:"pl-md-16"},{default:n(()=>[m("div",jt,[O(e.$slots,"itemset-header",{},()=>[b(u(e.$t("Basic information")),1)])]),m("div",null,[O(e.$slots,"itemset-description",{},()=>[b(u(e.$t("Please indicate the basic information about the donation that will be provided")),1)])])]),_:3}),l(i,{cols:"12",md:"9",class:"pr-md-16 pt-0"},{default:n(()=>[l(p,{class:"mt-2"},{default:n(()=>[l(i,{cols:"12"},{default:n(()=>[l(g,{modelValue:a.model.publicId,label:e.$t("Public ID"),id:"public_id",name:"PublicID",variant:"underlined","hide-details":"",readonly:""},null,8,["modelValue","label"])]),_:1}),l(i,{cols:"12"},{default:n(()=>[l(r,{modelValue:a.model.bundleName,"onUpdate:modelValue":[t[0]||(t[0]=c=>a.model.bundleName=c),a.resetBundle],filter:"Distribution"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(i,{cols:"12",lg:"6"},{default:n(()=>[l(s,{modelValue:a.model.populationType,"onUpdate:modelValue":t[1]||(t[1]=c=>a.model.populationType=c),hint:e.$t("Indicate the major group of beneficiaries")},null,8,["modelValue","hint"])]),_:1}),l(i,{cols:"12",lg:"6"},{default:n(()=>[l(V,{modelValue:a.model.date,"onUpdate:modelValue":t[2]||(t[2]=c=>a.model.date=c),label:e.$t("Date of distribution"),hint:e.$t("Indicate the planned date"),"persistent-hint":""},null,8,["modelValue","label","hint"])]),_:1}),l(i,{cols:"12"},{default:n(()=>[a.isUNHCR?N("",!0):(v(),S(g,{key:0,modelValue:a.model.aor,"onUpdate:modelValue":t[3]||(t[3]=c=>a.model.aor=c),label:e.$t("Area of Responsibility"),id:"aor",name:"aor",variant:"underlined","hide-details":""},null,8,["modelValue","label"])),a.isUNHCR?(v(),S(k,{key:1,modelValue:a.model.aor,"onUpdate:modelValue":t[4]||(t[4]=c=>a.model.aor=c),label:e.$t("Area of Responsibility"),id:"aor",name:"aor",variant:"underlined","hide-details":""},null,8,["modelValue","label"])):N("",!0)]),_:1}),l(i,{cols:"12"},{default:n(()=>[l(_,{modelValue:a.model.tags,"onUpdate:modelValue":t[5]||(t[5]=c=>a.model.tags=c),label:e.$t("Tags"),entity:"donations"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:3})]),_:3})]),_:3})}const zt=U(wt,[["render",Ct]]),M={SN101:{clusterObjective:"CO1",sectoralObjective:"SO1"},SN102:{clusterObjective:"CO1",sectoralObjective:"SO1"},SN103:{clusterObjective:"CO1",sectoralObjective:"SO1"},SN104:{clusterObjective:"CO1",sectoralObjective:"SO1"},SN105:{clusterObjective:"CO2",sectoralObjective:"SO1"},SN106:{clusterObjective:"CO2",sectoralObjective:"SO1"},SN107:{clusterObjective:"CO2",sectoralObjective:"SO1"},SN108:{clusterObjective:"CO2",sectoralObjective:"SO1"},SN109:{clusterObjective:"CO2",sectoralObjective:"SO1"},SN110:{clusterObjective:"CO2",sectoralObjective:"SO1"},SN111:{clusterObjective:"CO2",sectoralObjective:"SO1"},SN201:{clusterObjective:"CO3",sectoralObjective:"SO2"},SN202:{clusterObjective:"CO3",sectoralObjective:"SO2"},SN203:{clusterObjective:"CO3",sectoralObjective:"SO2"},SN204:{clusterObjective:"CO3",sectoralObjective:"SO2"},SN205:{clusterObjective:"CO3",sectoralObjective:"SO2"},SN206:{clusterObjective:"CO3",sectoralObjective:"SO2"},SN207:{clusterObjective:"CO3",sectoralObjective:"SO2"},SN208:{clusterObjective:"CO3",sectoralObjective:"SO2"},SN209:{clusterObjective:"CO3",sectoralObjective:"SO2"}},B={name:"donation",inject:["$confirm","$error","$loading","$showResult"],components:{SN101:ie,SN102:oe,SN104:ne,SN105:ae,SN107:le,SN108:te,SN109:ee,SN110:x,SN209:Z},data:()=>({donation:{distributionModality:"In-kind",populationType:"IDPs",organization:void 0,responsibleOrganization:void 0,fundedBy:void 0,date:void 0,items:[],receivingOrganization:void 0,focalPoint:{phone:[],email:[],translation:{uk:{}}},familyStats:{},files:[],address:{country:{name:"Ukraine",code2:"UA",code3:"UKR",code:"804"}}}}),created(){this.init()},computed:{title(){var e;return(e=this.$route.params)!=null&&e._id&&this.$route.params._id!=="new"?(this.appStore.breadcrumb=this.donation.publicId,this.donation.publicId):(this.appStore.breadcrumb=this.$t("New donation"),this.$t("New donation"))},publicId(){var t,d;let e=this.donation.date?this.donation.date:new Date;return e=new Date(new Date(e).getTime()-new Date().getTimezoneOffset()*6e4).toISOString().substring(0,10),[this.donation.bundleName,(t=this.donation.organization)==null?void 0:t.name,(d=this.donation.address)==null?void 0:d.pCode4,this.donation.populationType,e].filter(Boolean).join("-")}},methods:{async init(){var t,d,f,o;let{_id:e}=this.$route.params;if(e&&e!=="new")return this.loadData(e);this.donation.organization=(t=this.appStore.user)==null?void 0:t.organization,this.donation.createdBy=(d=this.appStore.user)==null?void 0:d.id,this.donation.createdByEmail=(f=this.appStore.user)==null?void 0:f.email,this.donation.status||(this.donation.status="In distribution"),(o=this.appStore.user)!=null&&o.defaults&&Object.assign(this.donation,this.appStore.user.defaults),this.appStore.loading=!1},async loadData(e){const{donations:t}=this.$storage;try{const d=await t[e];if(!d)throw"Not found";this.donation=d}catch{return await this.$error({title:"Donation is not found"}),this.$router.push("/donations")}this.appStore.loading=!1},getTemplate(e){return templates[e]}},watch:{publicId(e){var t;this.donation.publicId=this.publicId,(t=this.donation)!=null&&t.bundleName&&M[this.donation.bundleName.replace(/-2024/,"")]&&(this.donation.objectives=M[this.donation.bundleName.replace(/-2024/,"")])},"request.address.pCode4"(){this.collectiveCenter={}}}},Dt={class:"report pa-2"},It={class:"text-h4 font-weight-bold"};function Et(e,t,d,f,o,a){const r=zt,s=Ce,V=de,k=se,_=$t,c=Ot,R=rt,q=Ke,L=Le,H=Me,G=re,W=Q;return v(),$("div",Dt,[l(p,{class:"mb-0 mt-0"},{default:n(()=>[l(i,{cols:"12",md:"12",class:"mb-0 mt-0 pb-4 pt-0 pl-md-8 pr-md-8"},{default:n(()=>[m("div",It,u(a.title||e.$t("New donation")),1)]),_:1})]),_:1}),l(p,{class:"mb-0 mt-0"},{default:n(()=>[l(i,{cols:"12",md:"12",class:"mb-0 mt-0 pb-0 pt-0 pl-md-8 pr-md-8"},{default:n(()=>{var E;return[l(r,{modelValue:e.donation,"onUpdate:modelValue":t[0]||(t[0]=h=>e.donation=h)},null,8,["modelValue"]),l(s,{modelValue:e.donation,"onUpdate:modelValue":t[1]||(t[1]=h=>e.donation=h)},null,8,["modelValue"]),l(V,{modelValue:e.donation,"onUpdate:modelValue":t[2]||(t[2]=h=>e.donation=h)},null,8,["modelValue"]),l(k,{modelValue:e.donation,"onUpdate:modelValue":t[3]||(t[3]=h=>e.donation=h)},null,8,["modelValue"]),e.donation.bundleName?(v(),S(_e(e.donation.bundleName.replace("-2024","")),{key:0,modelValue:e.donation,"onUpdate:modelValue":t[4]||(t[4]=h=>e.donation=h)},null,8,["modelValue"])):N("",!0),l(_,{modelValue:e.donation,"onUpdate:modelValue":t[5]||(t[5]=h=>e.donation=h)},null,8,["modelValue"]),l(c,{modelValue:e.donation,"onUpdate:modelValue":t[6]||(t[6]=h=>e.donation=h)},null,8,["modelValue"]),e.donation.address.pCode4?(v(),S(R,{key:1,modelValue:e.donation,"onUpdate:modelValue":t[7]||(t[7]=h=>e.donation=h),"initial-data":{address:e.donation.address}},null,8,["modelValue","initial-data"])):N("",!0),(E=e.donation.receivingOrganization)!=null&&E.name?(v(),S(q,{key:2,modelValue:e.donation.focalPoint,"onUpdate:modelValue":t[8]||(t[8]=h=>e.donation.focalPoint=h)},null,8,["modelValue"])):N("",!0),l(L,{modelValue:e.donation.files,"onUpdate:modelValue":t[9]||(t[9]=h=>e.donation.files=h)},null,8,["modelValue"]),l(H,{modelValue:e.donation,"onUpdate:modelValue":t[10]||(t[10]=h=>e.donation=h)},null,8,["modelValue"]),e.$route.params._id!=="new"?(v(),S(G,{key:3,modelValue:e.donation,"onUpdate:modelValue":t[11]||(t[11]=h=>e.donation=h)},null,8,["modelValue"])):N("",!0),l(W,{modelValue:e.donation,"onUpdate:modelValue":t[12]||(t[12]=h=>e.donation=h),table:"donations"},null,8,["modelValue"])]}),_:1})]),_:1})])}typeof A=="function"&&A(B);const Al=U(B,[["render",Et]]);export{Al as default};
