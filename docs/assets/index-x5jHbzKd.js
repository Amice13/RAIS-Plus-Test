import{_ as B}from"./CustomTable-B09n9Rt0.js";import{d as D}from"./xlsx-template-browser-scOJpVFS.js";import{_ as F,i as I,d as E}from"./index-Dr3A69Vy.js";import{a1 as j,a9 as d,a3 as o,u as l,Q as H,a4 as s,a6 as m,Y as p,a7 as n,W as r,a2 as b,F as R,aa as P,S as M}from"./@vue-CVhpfiSJ.js";import{b as A}from"./route-block-B_A1xBdJ.js";import{z as S,f as g,A as N,n as C,C as O}from"./vuetify-8yKwgmF2.js";import"./CustomDate-CfhxorUI.js";import"./debouncer-Whu4ZLob.js";import"./searchProcessor-BfIe0Ps2.js";import"./jszip-B9I6jZYU.js";import"./@turf-BykKS3Vs.js";/* empty css             */import"./pinia-DJQ_g8GY.js";import"./pinia-plugin-persistedstate-Bx52SgID.js";import"./destr-BPvN1X9m.js";import"./deep-pick-omit-CegYQlcN.js";import"./pinia-shared-state-C4xqZbDc.js";import"./broadcast-channel-TeH36tNo.js";import"./oblivious-set-DL5W-sud.js";import"./dexie-DU0pVwlp.js";import"./@azure-suSn7m2_.js";import"./bson-objectid-DhxNlv_d.js";import"./joi-BOBjTjze.js";import"./comlink-B8fJUUNV.js";import"./vue-i18n-rpOKKwMw.js";import"./@intlify-DAAxr81y.js";import"./axios-xsH4HHeE.js";import"./md5-Ct8Y5Pza.js";import"./crypt-VTvMai_Y.js";import"./charenc-DuOFFKym.js";import"./is-buffer-DMJNLjvk.js";import"./uuid-C6aID195.js";import"./dot-object-sCKibp8s.js";import"./echarts-B3RPNoSA.js";import"./zrender-BxIUiisS.js";import"./@faker-js-9AjqWMS-.js";import"./jwt-decode-VWaDGczM.js";import"./vue-router-V8rnRB0-.js";import"./maska-DMix1GTA.js";var V={FRONT_HOST:"https://raisplus-test.unhcr.in.ua",STATIC_ASSETS_PATH:"http://localhost:3000/static/"};const L={name:"manage-organizations",mounted(){this.appStore.loading=!1},computed:{filters(){return{}},isAdmin(){var e,a,u;return(u=(a=(e=this.appStore)==null?void 0:e.user)==null?void 0:a.role)==null?void 0:u.includes("Admin")},staticPath(){return V.STATIC_ASSETS_PATH},headers(){var a,u,c;const e=[{title:"Orangization code",align:"start",sortable:!0,value:"code"},{title:"Orangization name",align:"start",sortable:!0,value:"name"},{title:"Functional type",align:"start",value:"functionalType",filterable:!0,type:"term"},{title:"Type",align:"start",value:"type",filterable:!0,type:"term"},{title:"Status",align:"start",value:"status",filterable:!0,type:"term"},{title:"Address",align:"start",value:"address"},{title:"Contacts",align:"center",value:"contacts"}];return(c=(u=(a=this.appStore)==null?void 0:a.user)==null?void 0:u.role)!=null&&c.includes("Admin")&&e.push({title:"Edit",align:"center",value:"_id"}),e}},data(){return{showAcrhive:!1,exportLoading:!1}},methods:{pCode4ToAdmins:I,async exportData(){this.exportLoading=!0;const e=`${V.FRONT_HOST}/export/export.xlsx`,a=`${new Date().toISOString().substring(0,10)} - RAIS+ Organizations.xlsx`,{organizations:u}=this.$storage,c=["id","code","name","legalName","translation.uk.name","translation.uk.legalName","status","type","functionalType","address.pCode1","address.pCode2","address.pCode3","address.pCode4","address.admin1","address.admin2","address.admin3","address.admin4","email","phone","website","tags"],k=["ID","Legal Code","Name","Legal Name","Translated name","Translated Legal Name","Status","Type","Functional type","p-code 1","p-code 2","p-code 3","p-code 4","Admin 1","Admin 2","Admin 3","Admin 4","email","phone","website","tags"];let h=(await u.include(c).slice(0,1e4).find()).items;h=h.map(t=>{var i;return(i=t.address)!=null&&i.pCode4&&(t.address=this.pCode4ToAdmins(t.address.pCode4)),t.email&&(t.email=t.email.join(", ")),t.phone&&(t.phone=t.phone.join(", ")),t.website&&(t.website=t.website.join(", ")),t.tags&&(t.tags=t.tags.join(", ")),t});const v=c.map(t=>h.map(i=>E(t,i)));await D(e,{headers:k,columns:v},a),this.exportLoading=!1}}},Q={class:"distribution-points pa-2"},W={class:"text-h4 font-weight-bold"},X={key:0},Y={class:"mt-4 mb-4"},q={class:"text-h6 title-link"},G={key:0,class:"text-caption"},J={key:1},K={class:"text-no-wrap"},U={class:"text-no-wrap"},Z={class:"text-no-wrap"},tt={key:0,class:"text-caption text-no-wrap"},et={key:0,class:"text-caption text-no-wrap"},at={key:1,class:"text-caption text-no-wrap"},st={key:2,class:"text-caption text-no-wrap"},ot={key:0},rt={key:1},it={key:2},nt={key:3},dt={class:"text-no-wrap"};function lt(e,a,u,c,k,f){const h=j("router-link"),v=B;return o(),d("div",Q,[l(N,{class:"mb-0 mt-0"},{default:s(()=>[l(S,{cols:"12",md:"12",class:"mb-0 mt-0 pb-4 pt-0 pl-md-8 pr-md-8"},{default:s(()=>[m("div",W,[p(r(e.$t("Manage organizations"))+" ",1),f.isAdmin?(o(),d("span",X,[l(g,{onClick:f.exportData,loading:k.exportLoading,size:"small",color:"grey-dakren-4",variant:"tonal"},{default:s(()=>[p(r(e.$t("Export")),1)]),_:1},8,["onClick","loading"])])):n("",!0)])]),_:1})]),_:1}),l(N,{class:"mb-0 mt-0"},{default:s(()=>[l(S,{cols:"12",md:"12",class:"mb-0 mt-0 pb-0 pt-0 pl-md-8 pr-md-8"},{default:s(()=>[l(v,{class:"pa-6",onBtnClick:a[0]||(a[0]=t=>e.$router.push("/organizations/new")),button:e.$t("Add"),"sort-by":{key:"name",order:"desc"},filters:f.filters,headers:f.headers,"search-keys":["name","legalName","code","translation.uk.name","translation.uk.legalName"],title:e.$t("Organizations"),table:"organizations"},{"item.code":s(({item:t})=>[l(O,{label:"",size:"small"},{default:s(()=>[p(r(t.code),1)]),_:2},1024)]),"item.name":s(({item:t})=>[m("div",Y,[m("div",q,[l(h,{to:`/organizations/${t.id}`,tag:"a"},{default:s(()=>[p(r(t.name),1)]),_:2},1032,["to"])]),t.legalName?(o(),d("div",G,r(t.legalName),1)):n("",!0),t.tags?(o(),d("div",J,[(o(!0),d(R,null,P(t.tags,i=>(o(),b(O,{key:i,size:"x-small",color:"primary",label:"",class:"mr-2"},{default:s(()=>[p(r(i),1)]),_:2},1024))),128))])):n("",!0)])]),"item.status":s(({item:t})=>[m("span",K,r(e.$t(t.status)),1)]),"item.functionalType":s(({item:t})=>[m("span",U,r(e.$t(t.functionalType)),1)]),"item.type":s(({item:t})=>[m("span",Z,r(e.$t(t.type)),1)]),"item.address":s(({item:t})=>{var i,_,y,w,x,$,T,z;return[(i=t.address)!=null&&i.pCode1?(o(),d("div",tt,r(e.$t(t.address.pCode1)),1)):n("",!0),m("div",null,[(_=t.address)!=null&&_.pCode2?(o(),d("span",et,r(e.$t(t.address.pCode2))+", ",1)):n("",!0),a[2]||(a[2]=p()),(y=t.address)!=null&&y.pCode3?(o(),d("span",at,r(e.$t(t.address.pCode3))+", ",1)):n("",!0),a[3]||(a[3]=p()),(w=t.address)!=null&&w.pCode4?(o(),d("span",st,r(e.$t(t.address.pCode4))+", ",1)):n("",!0)]),m("div",null,[(x=t.address)!=null&&x.streetType?(o(),d("span",ot,r(e.$t(t.address.streetType)),1)):n("",!0),a[4]||(a[4]=p()),($=t.address)!=null&&$.street?(o(),d("span",rt,r(t.address.street),1)):n("",!0),a[5]||(a[5]=p()),(T=t.address)!=null&&T.building?(o(),d("span",it,r(t.address.building),1)):n("",!0),a[6]||(a[6]=p()),(z=t.address)!=null&&z.apartment?(o(),d("span",nt,","+r(t.address.apartment),1)):n("",!0)])]}),"item.contacts":s(({item:t})=>{var i,_,y;return[m("div",dt,[(i=t.phone)!=null&&i.length&&t.phone[0]?(o(),b(g,{key:0,href:`tel:${t.phone[0]}`,size:"small",variant:"text",color:"primary"},{default:s(()=>[l(C,{icon:"mdi-phone"})]),_:2},1032,["href"])):n("",!0),(_=t.email)!=null&&_.length&&t.email[0]?(o(),b(g,{key:1,href:`mailto:${t.email[0]}`,size:"small",variant:"text",color:"primary"},{default:s(()=>[l(C,{icon:"mdi-email"})]),_:2},1032,["href"])):n("",!0),(y=t.website)!=null&&y.length&&t.website[0]?(o(),b(g,{key:2,href:`${t.website[0]}`,size:"small",variant:"text",color:"primary"},{default:s(()=>[l(C,{icon:"mdi-web"})]),_:2},1032,["href"])):n("",!0)])]}),"item._id":s(({item:t})=>[l(g,{color:"grey-dakren-2",onClick:i=>e.$router.push(`/organizations/${t.id}`),variant:"tonal",rounded:"1",icon:"mdi-pencil",size:"x-small"},null,8,["onClick"])]),_:2},1032,["button","filters","headers","title"])]),_:1})]),_:1}),H(l(g,{onClick:a[1]||(a[1]=t=>e.$router.push("/organizations/new")),style:{position:"fixed",bottom:"15px",right:"15px"},color:"primary",rounded:"1",icon:"mdi-plus",size:"large"},null,512),[[M,e.$vuetify.display.xs]])])}typeof A=="function"&&A(L);const Gt=F(L,[["render",lt]]);export{Gt as default};
