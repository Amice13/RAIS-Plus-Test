import{_ as W,a as G,b as Q,c as X,d as ee,e as te,f as ae,V as le}from"./DistributionFormDocument-hthCb9m0.js";import{_ as se}from"./DistributionFormCash-Cfj8YSJm.js";import{_ as M,Z as oe,$ as ie,a0 as re,a1 as H,a2 as ne,a3 as T,o as f,c as g,w as a,a as s,F as w,B as b,z as u,A as r,C as c,x as D,y as k,G as z,H as F,n as de,a4 as me,a5 as R,a6 as ue,a7 as he}from"./index-BYWsBYtF.js";import{a as O,b as j,V as L}from"./VCard-C8It3tDs.js";import{a as C,V as _}from"./VRow-D5QUgmxK.js";import{V as ce}from"./VTextarea-CGO06-dG.js";import{V as y,a as fe}from"./VBtn-DEU8AXzn.js";import{V as A}from"./VSpacer-D4hnwTqC.js";import{d as B}from"./debouncer-Whu4ZLob.js";import{V as pe,a as ge,b as ye}from"./CustomDate-BvE_k-Ie.js";import{V as be}from"./VSystemBar-D2w16SNc.js";import{V as U}from"./index-CqdMy8lr.js";import{V as E}from"./VContainer-rOsYQHyZ.js";import{V as N}from"./VTextField-CLSPMm7c.js";import{V as Y,a as J,b as K,c as _e,d as Ve}from"./VList-wnBQ6eUC.js";import{V as ve}from"./VDialog-DkfmLzLV.js";import{_ as we}from"./CustomTableHeaderStatic--V9Vxjnk.js";import{V as q}from"./VMenu-BAWQ3Wct.js";import{V as Se}from"./VChip-BnTEbD1P.js";import{b as P}from"./route-block-B_A1xBdJ.js";import{V as De}from"./VDataTableVirtual-BO58bCzO.js";import{V as ke,a as Ce}from"./VToolbar-Jw3O4Zrq.js";import"./CustomGender-2pTOXWap.js";import"./filter-5KaMYqe0.js";import"./VInput-CwTs2RKk.js";import"./index-bmXFo_Al.js";import"./forwardRefs-D3j0TLhE.js";import"./dialog-transition-CdzLxCw9.js";import"./VOverlay-uyg0Ioz0.js";import"./VCheckboxBtn-B1hdxoeT.js";import"./VAvatar-Bm8XvpvO.js";import"./VImg-wiXIkP7s.js";import"./index-D0cxP7tL.js";import"./VDataTable-DS7yi-Dm.js";import"./VPagination-BBLVO-bG.js";import"./CustomTextFieldTranslit-DAGdx7D0.js";import"./CustomPhone-JFRV9tiP.js";import"./CustomTag-DNZukCra.js";import"./data-BLrW_n9l.js";import"./CustomPopulationType-qKzO5os5.js";import"./VAlert-BA1FNbYI.js";import"./VCheckbox-CLjkCuK4.js";/* empty css              */import"./group-BcbT0sDe.js";const xe={name:"DistributionPocDialow",inject:["$confirm","$error","$loading","$showResult"],props:{modelValue:{type:Object,default:()=>({})},items:{type:Array,default:()=>[]}},computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},canEdit(){var e,t,n;if((n=(t=(e=this.appStore)==null?void 0:e.user)==null?void 0:t.role)!=null&&n.includes("Admin")||!this.model.id||new Date-new Date(this.model.date)<30*1e3*60*60*24||new Date-new Date(this.model.createdAt)<7*1e3*60*60*24)return!0},dialog(){const e=document.querySelector("html"),t=Object.keys(this.model).length>0;return e.classList[t?"add":"remove"]("overflow-hidden"),t}},methods:{countFamilyStats(){this.model.familyStats=oe([...this.model.familyMembers,this.model.headOfHousehold])},formatAddress:ie,createFamilyMembersIds(){var m;const e=this.model.taxId||this.model.passport||re(),t=H(this.model,e);let n=[];return(m=this.model)!=null&&m.familyMembers&&(n=this.model.familyMembers.map(o=>H(o,e))),[t,...n]},async removeData(){if(!await this.$confirm({title:"Delete assistance",description:"Would you like to delete data about the assistance?"}))return!1;this.$loading(!0);const{assistances:t}=this.$storage;let n;try{n=await delete t[this.model.id]}catch(m){await this.$error(m)}if(this.$loading(!1),!n)return!1;await this.$showResult(),this.model=void 0,this.$emit("loadItems")},async saveData(){var n,m,o,l,d;if(!await this.$confirm({title:"Save assistance",description:"Would you like to save data about the assistance?"}))return!1;(n=this.model)!=null&&n.headOfHousehold&&(this.model.headOfHousehold=ne(this.model.headOfHousehold)),(m=this.model)!=null&&m.headOfHousehold&&this.model.household&&((l=(o=this.model)==null?void 0:o.address)!=null&&l.pCode4&&(this.model.household.pCode4=this.model.address.pCode4,this.model.household.admin4=this.model.address.admin4),this.model.household.fullAddress=this.formatAddress(this.model.household,"en"),this.model.household.translation.uk.fullAddress=this.formatAddress(this.model.household,"uk")),this.countFamilyStats(),this.model.familyMembersIds=this.createFamilyMembersIds(),this.model.taxIds=[T((d=this.model)==null?void 0:d.headOfHousehold),...(this.model.familyMembers||[]).map(T)].filter(Boolean);let t;try{const{assistances:p}=this.$storage;this.model.id||(t=await p.push(this.model)),this.model.id&&(t=await p.update(this.model.id,this.model))}catch(p){return this.$loading(!1),await this.$error(p)}this.$loading(!1),await this.$showResult(),this.model=void 0,this.$emit("loadItems")}}},Ie={key:0,class:"main-part"},Me={class:"text-h5 mb-2 offset-md1 black--text"},$e={class:"text-h5 mb-2 offset-md1 black--text"};function Ue(e,t,n,m,o,l){const d=W,p=G,V=Q,S=X,i=ee,v=te,x=se,I=ae;return f(),g(L,{tile:"",class:"fill-height scroll custom-thumb pb-4"},{default:a(()=>[l.model.headOfHousehold?(f(),g(O,{key:0,style:{"font-size":"0.875rem"}},{default:a(()=>[s(d,{modelValue:l.model.headOfHousehold,"onUpdate:modelValue":t[0]||(t[0]=h=>l.model.headOfHousehold=h),onSetId:t[1]||(t[1]=h=>l.model.householdId=h),onSetFamilyMembers:t[2]||(t[2]=h=>l.model.familyMembers=h),onSetHousehold:t[3]||(t[3]=h=>l.model.household=h),id:l.model.id,householdId:l.model.id},null,8,["modelValue","id","householdId"]),l.model.id?(f(),w("div",Ie,[s(p,{modelValue:l.model,"onUpdate:modelValue":t[4]||(t[4]=h=>l.model=h)},null,8,["modelValue"]),s(V,{modelValue:l.model.address,"onUpdate:modelValue":t[5]||(t[5]=h=>l.model.address=h)},null,8,["modelValue"]),l.model.headOfHousehold?(f(),g(S,{key:0,modelValue:l.model.headOfHousehold,"onUpdate:modelValue":t[6]||(t[6]=h=>l.model.headOfHousehold=h)},null,8,["modelValue"])):b("",!0),l.model.household?(f(),g(i,{key:1,modelValue:l.model.household,"onUpdate:modelValue":t[7]||(t[7]=h=>l.model.household=h),householdId:l.model.householdId},null,8,["modelValue","householdId"])):b("",!0),s(v,{modelValue:l.model.familyMembers,"onUpdate:modelValue":t[8]||(t[8]=h=>l.model.familyMembers=h)},null,8,["modelValue"]),s(x,{modelValue:l.model,"onUpdate:modelValue":t[9]||(t[9]=h=>l.model=h)},null,8,["modelValue"]),s(C,{class:"mb-4 mt-4"},{default:a(()=>[s(_,{cols:"12"},{default:a(()=>[u("div",Me,r(e.$t("Signature")),1),u("div",null,r(e.$t("Please sign the completed form")),1)]),_:1}),s(_,{cols:"12"},{default:a(()=>[s(I,{modelValue:l.model.signature,"onUpdate:modelValue":t[10]||(t[10]=h=>l.model.signature=h),mode:"edit"},null,8,["modelValue"])]),_:1})]),_:1}),s(C,{class:"mb-4 mt-4"},{default:a(()=>[s(_,{cols:"12"},{default:a(()=>[u("div",$e,r(e.$t("Comment")),1),u("div",null,r(e.$t("You can add any additional comment")),1)]),_:1}),s(_,{cols:"12"},{default:a(()=>[s(ce,{modelValue:l.model.comment,"onUpdate:modelValue":t[11]||(t[11]=h=>l.model.comment=h),variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1})])):b("",!0)]),_:1})):b("",!0),s(j,null,{default:a(()=>[l.canEdit&&l.model.id?(f(),g(y,{key:0,onClick:l.removeData,color:"error",variant:"tonal",class:"ml-4"},{default:a(()=>[c(r(e.$t("Delete")),1)]),_:1},8,["onClick"])):b("",!0),s(A),l.canEdit?(f(),g(y,{key:1,onClick:t[12]||(t[12]=h=>this.model=void 0),color:"orange darken-2",variant:"text"},{default:a(()=>[c(r(e.$t("Cancel")),1)]),_:1})):b("",!0),l.canEdit?(f(),g(y,{key:2,onClick:l.saveData,color:"primary",variant:"tonal",class:"mr-4"},{default:a(()=>[c(r(e.$t("Save")),1)]),_:1},8,["onClick"])):b("",!0)]),_:1})]),_:1})}const ze=M(xe,[["render",Ue]]),Fe={props:{dialog:{type:Boolean}},data(){return{loading:!1,search:void 0,items:[],selected:void 0}},methods:{setSearch(){if(this.search.length<3)return!1;this.loading=!0,this.debouncedSearch()},debouncedSearch:B(function(){this.getData()}),async getData(){if(!this.search||this.search.length<3)return!1;this.loading=!0;const{assistances:e}=this.$storage,t=await e.useIndex("taxIds").filter({taxIds:{$contains:this.search},distributionModality:["Cash","Voucher"]}).sort("date").reverse().slice(0,20).find();this.items=t.items,this.loading=!1},getTaxId(e){const t=this.search.replace(/[^А-ЯA-Z\d ]/g,""),n=e.filter(m=>m.match(t))[0];return n?n.replace(t,`<span class="highlight">${t}</span>`):""}}},Oe={class:"ms-2"},Le={class:"pa-3"},Be={key:0,class:"pa-3 h-100 d-flex flex-column align-center justify-center"},Ne={key:1,class:"pa-3 h-100 d-flex flex-column align-center justify-center text-center"},He=["innerHTML"],Te={class:"small mt-1 mb-1 text-primary"};function Pe(e,t,n,m,o,l){const d=ze;return f(),g(ve,{modelValue:n.dialog,"onUpdate:modelValue":t[3]||(t[3]=p=>e.$emit("close",p)),class:"import-dialog",fullscreen:"",overlay:""},{default:a(()=>[s(pe,{style:{position:"relative"},ref:"dialogHeight"},{default:a(()=>[s(be,{window:"",color:"primary",style:{top:"0px"},class:"d-flex justify-space-between"},{default:a(()=>[u("span",Oe,r(e.$t("Search cash assistance")),1),s(U,{onClick:t[0]||(t[0]=p=>this.$emit("close")),color:"white",icon:"mdi-close",class:"ms-2 text-white cursor-pointer"})]),_:1}),s(E,{class:"h-100 d-flex flex-column pa-lg-4",fluid:""},{default:a(()=>[s(C,{class:"h-100 mt-4"},{default:a(()=>[s(_,{md:"3",cols:"12",class:"h-100-overflow d-flex flex-column pa-0"},{default:a(()=>{var p,V,S;return[u("div",Le,[s(N,{modelValue:o.search,"onUpdate:modelValue":[t[1]||(t[1]=i=>o.search=i),l.setSearch],label:e.$t("Search by tax ID"),"prepend-inner-icon":"mdi-magnify",variant:"underlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","label"])]),D(u("div",null,[s(le,{class:"mx-auto","max-width":"400",type:"list-item-three-line"})],512),[[k,o.loading]]),!o.loading&&((p=o.search)==null?void 0:p.length)>2&&!o.items.length?(f(),w("div",Be,r(e.$t("Nothing found for your query")),1)):b("",!0),!o.loading&&!o.search||((V=o.search)==null?void 0:V.length)<3?(f(),w("div",Ne,r(e.$t("To search for beneficiaries, enter at least 3 characters from the RNOKPP or passport number")),1)):b("",!0),D(s(Y,{class:"custom-thumb",lines:"three","item-props":""},{default:a(()=>[(f(!0),w(z,null,F(o.items,i=>{var v;return f(),g(J,{onClick:x=>o.selected=i,active:((v=o.selected)==null?void 0:v.id)===i.id,class:"pt-2 pb-2 underlined"},{default:a(()=>[s(K,null,{default:a(()=>[u("strong",{class:"small",innerHTML:l.getTaxId(i.taxIds)},null,8,He)]),_:2},1024),s(_e,null,{default:a(()=>[u("div",Te,r(new Date(i.date).toLocaleString("uk",{day:"numeric",month:"numeric",year:"numeric"}))+" · "+r(i.value)+" "+r(i.currency),1),u("div",null,r(e.$t(i.bundleName)),1)]),_:2},1024)]),_:2},1032,["onClick","active"])}),256))]),_:1},512),[[k,!o.loading&&((S=o.search)==null?void 0:S.length)>2]])]}),_:1}),s(_,{md:"9",cols:"12",class:"bg-grey-lighten-3 h-100 ma-0 pa-2"},{default:a(()=>{var p;return[o.selected?(f(),g(d,{modelValue:o.selected,"onUpdate:modelValue":t[2]||(t[2]=V=>o.selected=V),key:(p=o.selected)==null?void 0:p.id,onLoadItems:l.getData},null,8,["modelValue","onLoadItems"])):b("",!0)]}),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1},8,["modelValue"])}const Re=M(Fe,[["render",Pe]]),je={name:"Date",props:{modelValue:{type:[String,Date]},max:{type:Date},min:{type:Date},label:{type:String,default:"Date"},hint:{type:String},persistentHint:{type:Boolean},clearable:{type:Boolean}},mounted(){this.model&&(this.date=new Date(this.model).toLocaleDateString("sv-SE"))},data(){return{year:void 0,currentMode:"year",showCalendar:!1}},computed:{model:{get(){if(this.modelValue)return new Date(this.modelValue)},set(e){return!1}},date:{get(){if(this.model)return new Date(this.model).toLocaleString("sv").substring(0,10)},set(e){if(!e)return this.model=e;e.match(/^\d{4}-\d{2}-\d{2}$/)&&(this.model=e)}},maxDate(){if(this.max)return new Date(this.max).toLocaleDateString("sv")},minDate(){if(this.min)return this.min.toLocaleDateString("sv")}},methods:{setMonth(e){const t=new Date(this.year,e,1);this.$emit("update:modelValue",t),this.currentMode="year",this.showCalendar=!1},setYear(e){this.year=e,this.currentMode="months"}}};function Ae(e,t,n,m,o,l){return f(),g(q,{modelValue:o.showCalendar,"onUpdate:modelValue":t[1]||(t[1]=d=>o.showCalendar=d),"close-on-content-click":!1,"min-width":400,"min-height":600},{activator:a(({props:d})=>[s(y,de(d,{width:"170",color:"primary",variant:"text"}),{default:a(()=>[me(e.$slots,"default")]),_:2},1040)]),default:a(()=>[s(ge,{locale:e.$i18n.locale},{default:a(()=>[s(ye,{modelValue:l.model,"onUpdate:modelValue":t[0]||(t[0]=d=>l.model=d),"view-mode":o.currentMode,"onUpdate:month":l.setMonth,"onUpdate:year":l.setYear,title:e.$t("Select date"),max:l.maxDate,min:l.minDate,header:e.$t("Select date"),locale:e.$i18n.locale,color:"primary",format:"yyyy-mm-dd","input-text":"yyyy-mm-dd"},null,8,["modelValue","view-mode","onUpdate:month","onUpdate:year","title","max","min","header","locale"])]),_:1},8,["locale"])]),_:3},8,["modelValue"])}const Ee=M(je,[["render",Ae]]),$=e=>{const[t,n]=e.split(/\./g);return n==="0"||t.length===3?t:e},Ye=e=>e/10**9>1?$((e/10**9).toFixed(1))+"B":e/10**6>1?$((e/10**6).toFixed(1))+"M":e/10**3>1?$((e/10**3).toFixed(1))+"K":e,Je={name:"CustomCashFilterButton",props:{organization:{type:Object,default(){return{}}},date:{type:Date,default:new Date}},data(){return{loading:!1,search:void 0,items:[],menu:!1}},computed:{title(){if(this.$i18n.locale==="en")return"organization.name";if(this.$i18n.locale!=="en")return["organization.translation",this.$i18n.locale,"name"].join(".")},key(){return"organization.id"},showItems(){if(!this.search)return this.items;const e=new RegExp(this.search.replace(/[|\\{}()[\]^$+*?.]/g,".").replace(/-/g,"\\-"),"gi");return this.items.filter(t=>value.match(e))}},methods:{setSearch:B(function(){if(!this.menu)return!1;this.loadItems()}),async loadItems(){this.loading=!0;let{assistances:e}=this.$storage;e=e.useIndex("date");const t=new Date(this.date.getFullYear(),this.date.getMonth(),1,1),n=new Date(this.date.getFullYear(),this.date.getMonth()+1,1),m={date:{$gte:t,$lte:n},distributionModality:["Cash","Voucher"]};e=e.filter(m),this.search&&(e=e.should({[this.title]:{$regex:this.search}})),e=e.sort([{value:"desc"},{[this.key]:"asc"}]);const o={groupBy:[this.key,"organization.name",["organization.translation",this.$i18n.locale,"name"].join(".")],aggs:{value:{variable:"id",operation:"count"}}};let l=await e.aggregate(o);l=l.map(d=>(d.key||(d.key=d[this.key],d.title=d[this.title]),d)),l.map(d=>d.key),this.items=l,this.loading=!1},switchFilter(e){const{organization:t}=R.object(e);t.id=e.key,this.$emit("setFilter",t)},simplifyCount:Ye},watch:{menu(e){e&&this.loadItems()}}},Ke={class:"mb-2"},qe={class:"text-center"};function Ze(e,t,n,m,o,l){return f(),g(y,{color:"primary",variant:"text"},{default:a(()=>[c(r(n.organization.name)+" ",1),s(q,{activator:"parent",transition:"slide-y-transition","close-on-content-click":!1,modelValue:o.menu,"onUpdate:modelValue":t[2]||(t[2]=d=>o.menu=d)},{default:a(()=>[s(L,{"max-width":"350",width:"350"},{default:a(()=>[s(O,{class:"pa-0"},{default:a(()=>[s(E,null,{default:a(()=>[s(C,null,{default:a(()=>[s(_,{cols:"12"},{default:a(()=>[u("div",Ke,[u("strong",null,r(e.$t("Filter").toUpperCase()),1)]),s(N,{modelValue:o.search,"onUpdate:modelValue":t[0]||(t[0]=d=>o.search=d),label:e.$t("Search"),variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue","label"])]),_:1}),s(_,{cols:"12",class:"pa-0"},{default:a(()=>[D(u("div",qe,[s(fe,{indeterminate:"",color:"primary"})],512),[[k,o.loading]]),D(s(Y,{class:"custom-thumb",nav:"",density:"compact",lines:!1,"max-height":"200"},{default:a(()=>[(f(!0),w(z,null,F(l.showItems,d=>(f(),g(J,{onClick:p=>l.switchFilter(d),key:d.key,density:"compact"},{append:a(()=>[s(Se,{size:"x-small"},{default:a(()=>[c(r(l.simplifyCount(d.value)),1)]),_:2},1024)]),default:a(()=>[s(K,{class:"pr-2"},{default:a(()=>[c(r(d==null?void 0:d.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1},512),[[k,!o.loading]])]),_:1})]),_:1})]),_:1})]),_:1}),s(j,null,{default:a(()=>[s(A),s(y,{onClick:t[1]||(t[1]=d=>o.menu=!1),size:"x-small"},{default:a(()=>[c(r(e.$t("Close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const We=M(Je,[["render",Ze]]),Z={name:"manage-cash",computed:{filters(){var n;const e=new Date(this.date.getFullYear(),this.date.getMonth(),1,1),t=new Date(this.date.getFullYear(),this.date.getMonth()+1,1);return{...this.currentFilters,"organization.id":(n=this.organization)==null?void 0:n.id,date:{$gte:e,$lte:t}}},filteredData(){let e=JSON.parse(JSON.stringify(this.items));if(e=e.map(n=>{var o;const m=JSON.parse(JSON.stringify(n));return(o=m==null?void 0:m.address)!=null&&o.pCode4&&(m.address.admin1=this.$t(m.address.pCode4.substring(0,4),this.$i18n.locale),m.address.admin2=this.$t(m.address.pCode4.substring(0,6),this.$i18n.locale),m.address.admin3=this.$t(m.address.pCode4.substring(0,9),this.$i18n.locale),m.address.admin4=this.$t(m.address.pCode4,this.$i18n.locale)),m}),this.datatable.search){const n=new RegExp(this.datatable.search.replace(/[.?*{}\[\]()<>]/g,""),"gi");e=e.filter(m=>JSON.stringify(m).match(n))}const t=Object.entries(this.datatable.filters);return t.length&&(e=e.filter(n=>{for(const[m,o]of t)if(!o.includes(ue(m,n)))return!1;return!0})),e}},data(){return{search:void 0,index:"publicId",datatable:{search:"",searchKeys:[],start:void 0,end:void 0,filters:{},sortBy:[{date:"asc"}]},loading:!1,searchDialog:!1,organization:void 0,date:new Date,month:void 0,items:[],groupBy:["date","organization.name","distributionModality","address.pCode4","bundleName","populationType"],aggs:{"familyStats.households":{variable:"id",operation:"count"},"familyStats.all":{variable:"familyStats.all",operation:"sum"},value:{variable:"value",operation:"sum"}},currentFilters:{distributionModality:["Cash","Voucher"]},headers:[{title:"View",align:"center",value:"id"},{title:"Date",align:"start",value:"date",sortable:!0},{title:"Bundle name",align:"start",value:"bundleName",sortable:!0,filterable:!0,type:"term"},{title:"Modality",align:"start",value:"distributionModality",sortable:!0,filterable:!0,type:"term"},{title:"Oblast",align:"start",value:"address.admin1",sortable:!0,filterable:!0,type:"term"},{title:"Raion",align:"start",value:"address.admin2",sortable:!0,filterable:!0,type:"term"},{title:"Hromada",align:"start",value:"address.admin3",sortable:!0,filterable:!0,type:"term"},{title:"Locality",align:"start",value:"address.admin4",sortable:!0,filterable:!0,type:"term"},{title:"Population type",align:"start",value:"populationType",filterable:!0,type:"term"},{title:"Households",align:"start",value:"familyStats.households",sortable:!0,align:"end"},{title:"Individuals",align:"start",value:"familyStats.all",sortable:!0,align:"end"},{title:"Value",align:"start",value:"value",sortable:!0,sortable:!0,align:"end"},{title:"Organization",align:"start",value:"organization",sortable:!0}]}},created(){this.organization=this.appStore.user.organization,this.appStore.loading=!1,this.loadItems()},methods:{setSearch:B(function(e){this.datatable.search=e}),async loadItems(){this.loading=!0;let{assistances:e}=this.$storage;e=e.useIndex("date"),e.filter(this.filters);let t=await e.aggregate({groupBy:this.groupBy,aggs:this.aggs});t=t.map(n=>R.object(n)),this.items=t,this.loading=!1},setFilter(e){this.datatable.filters=e},nextMonth(){this.date=new Date(new Date(this.date).setMonth(this.date.getMonth()+1)),this.loadItems()},prevMonth(){this.date=new Date(new Date(this.date).setMonth(this.date.getMonth()-1)),this.loadItems()},formatNumber(e){return new Intl.NumberFormat("fr-FR").format(e)},createURL(e){const t=he(e,["date","bundleName","distributionModality","populationType"]);return t.pCode4=e.address.pCode4,typeof t.date=="number"&&(t.date=new Date(t.date).toLocaleDateString("sv-SE")),`/cash/view?${new URLSearchParams(t).toString()}`}},watch:{"$i18n.locale"(){this.datatable.filters={}}}},Ge={class:"distribution-points pa-2"},Qe={class:"text-h4 font-weight-bold"},Xe={class:"w-100"},et={class:"bg-grey-lighten-4 d-inline-block mr-4"},tt={class:"bg-grey-lighten-4 d-inline-block"},at={class:"flex-shrink-0"},lt={class:"text-no-wrap"},st={class:"text-no-wrap"},ot={class:"text-no-wrap"},it={class:"text-no-wrap"},rt={class:"text-no-wrap"};function nt(e,t,n,m,o,l){const d=We,p=Ee,V=we,S=Re;return f(),w("div",Ge,[s(C,{class:"mb-0 mt-0"},{default:a(()=>[s(_,{cols:"12",md:"12",class:"mb-0 mt-0 pb-4 pt-0 pl-md-8 pr-md-8"},{default:a(()=>[u("div",Qe,r(e.$t("Cash interventions")),1)]),_:1})]),_:1}),s(C,{class:"mb-0 mt-0"},{default:a(()=>[s(_,{cols:"12",md:"12",class:"mb-0 mt-0 pb-0 pt-0 pl-md-8 pr-md-8"},{default:a(()=>[s(L,null,{default:a(()=>[s(O,{class:"mb-0 pb-0 ml-2 pr-8 d-flex w-100"},{default:a(()=>[u("div",Xe,[u("div",et,[s(d,{onSetFilter:t[0]||(t[0]=i=>o.organization=i),date:o.date,organization:o.organization},null,8,["date","organization"])]),u("div",tt,[s(y,{onClick:l.prevMonth,color:"primary",variant:"text"},{default:a(()=>[s(U,null,{default:a(()=>t[12]||(t[12]=[c("mdi-chevron-left")])),_:1})]),_:1},8,["onClick"]),s(p,{modelValue:o.date,"onUpdate:modelValue":[t[1]||(t[1]=i=>o.date=i),l.loadItems],color:"primary",variant:"text"},{default:a(()=>[c(r(o.date.toLocaleDateString(this.$i18n.locale,{timeZone:"Europe/Kyiv",month:"long",year:"numeric"})),1)]),_:1},8,["modelValue","onUpdate:modelValue"]),s(y,{onClick:l.nextMonth,color:"primary",variant:"text"},{default:a(()=>[s(U,null,{default:a(()=>t[13]||(t[13]=[c("mdi-chevron-right")])),_:1})]),_:1},8,["onClick"])]),s(y,{onClick:t[2]||(t[2]=i=>o.searchDialog=!0),color:"primary",variant:"tonal","prepend-icon":"mdi-magnify",class:"ml-4"},{default:a(()=>[c(r(e.$t("Search")),1)]),_:1})]),u("div",at,[s(y,{onClick:t[3]||(t[3]=i=>e.$router.push("/cash/delete")),color:"error",variant:"flat","prepend-icon":"mdi-delete",class:"mr-4"},{default:a(()=>[c(r(e.$t("Delete")),1)]),_:1}),s(y,{onClick:t[4]||(t[4]=i=>e.$router.push("/cash/new")),color:"primary",variant:"flat","prepend-icon":"mdi-plus"},{default:a(()=>[c(r(e.$t("Add")),1)]),_:1})])]),_:1})]),_:1}),s(De,{"sort-by":o.datatable.sortBy,"onUpdate:sortBy":t[8]||(t[8]=i=>o.datatable.sortBy=i),"items-per-page":0,height:e.$vuetify.display.height-390<320?320:e.$vuetify.display.height-390,headers:o.headers,items:l.filteredData,loading:o.loading,"loading-text":e.$t("Loading... Please wait"),"items-per-page-text":e.$t("Records per page"),"item-value":"_id","hide-default-footer":""},{top:a(()=>[D(s(ke,{flat:"",color:"white"},{default:a(()=>[s(Ce,{style:{"min-width":"150px"}},{default:a(()=>[c(r(e.$t("Summary")),1)]),_:1}),s(Ve,{class:"mx-4",inset:"",vertical:""}),s(N,{modelValue:o.search,"onUpdate:modelValue":[t[5]||(t[5]=i=>o.search=i),l.setSearch],label:e.$t("Search"),variant:"outlined",density:"compact","prepend-icon":"mdi-magnify","hide-details":"",class:"mr-4 w-100",clearable:""},null,8,["modelValue","onUpdate:modelValue","label"])]),_:1},512),[[k,!e.$vuetify.display.xs]])]),headers:a(({columns:i,toggleSort:v})=>[u("tr",null,[(f(!0),w(z,null,F(i,x=>(f(),g(V,{key:x.key,onSetSort:t[6]||(t[6]=I=>o.datatable.sortBy=[I]),onSetFilter:t[7]||(t[7]=I=>l.setFilter(I)),column:x,"parent-items":l.filteredData,datatable:o.datatable},null,8,["column","parent-items","datatable"]))),128))])]),"item.date":a(({item:i})=>[u("span",lt,r(new Date(i.date).toLocaleDateString("uk")),1)]),"item.bundleName":a(({item:i})=>[u("span",st,r(e.$t(i.bundleName)),1)]),"item.distributionModality":a(({item:i})=>[u("span",ot,r(e.$t(i.distributionModality)),1)]),"item.populationType":a(({item:i})=>[u("span",it,r(e.$t(i.populationType)),1)]),"item.organization":a(({item:i})=>{var v;return[u("span",rt,r((v=i.organization)==null?void 0:v.name),1)]}),"item.address.admin1":a(({item:i})=>[c(r(i.address.admin1),1)]),"item.address.admin2":a(({item:i})=>[c(r(i.address.admin2),1)]),"item.address.admin3":a(({item:i})=>[c(r(i.address.admin3),1)]),"item.address.admin4":a(({item:i})=>[c(r(i.address.admin4),1)]),"item.familyStats.all":a(({item:i})=>[c(r(l.formatNumber(i.familyStats.all)),1)]),"item.familyStats.households":a(({item:i})=>[c(r(l.formatNumber(i.familyStats.households)),1)]),"item.value":a(({item:i})=>[c(r(l.formatNumber(i.value)),1)]),"item.id":a(({item:i})=>[s(y,{to:l.createURL(i),color:"grey-dakren-2",variant:"tonal",rounded:"1",icon:"mdi-magnify",size:"x-small"},null,8,["to"])]),"no-data":a(()=>[u("div",null,r(e.$t("No data found")),1)]),_:2},1032,["sort-by","height","headers","items","loading","loading-text","items-per-page-text"])]),_:1})]),_:1}),D(s(y,{onClick:t[9]||(t[9]=i=>e.$router.push("/cash/new")),style:{position:"fixed",bottom:"15px",right:"15px"},color:"primary",rounded:"1",icon:"mdi-plus",size:"large"},null,512),[[k,e.$vuetify.display.xs]]),s(S,{modelValue:o.searchDialog,"onUpdate:modelValue":t[10]||(t[10]=i=>o.searchDialog=i),onClose:t[11]||(t[11]=i=>o.searchDialog=!1)},null,8,["modelValue"])])}typeof P=="function"&&P(Z);const Xt=M(Z,[["render",nt]]);export{Xt as default};
