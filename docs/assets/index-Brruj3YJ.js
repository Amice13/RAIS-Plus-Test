import{_ as G,a as Q,b as X,c as ee,d as te,e as ae,f as le}from"./DistributionFormDocument-CGT6ZaYm.js";import{_ as se}from"./DistributionFormCash-CywLY2PN.js";import{c as T}from"./config-CpTMMwfY.js";import{_ as M,a2 as oe,c as g,o as f,w as a,A as b,a as s,F as w,x as u,y as r,C as c,a3 as ie,a4 as H,a5 as re,a6 as P,a7 as ne,z as D,B as k,G as z,H as F,q as de,a8 as me,a9 as E,aa as ue,ab as he}from"./index-BtIo2-Z_.js";import{a as O,b as R,V as L}from"./VCard-DNHZbZ5d.js";import{a as C,V as _}from"./VRow-9vAZildp.js";import{V as ce}from"./VTextarea-32VTKSi3.js";import{V as y}from"./VBtn--bGuKZaN.js";import{V as j}from"./VSpacer-bp7-SSB-.js";import{d as B}from"./debouncer-Whu4ZLob.js";import{V as fe,a as pe,b as ge}from"./CustomDate-CLArRqjL.js";import{V as ye}from"./VSystemBar-Cr7lwDBT.js";import{V as U}from"./index-SDX8Otz2.js";import{V as Y}from"./VContainer-BFGIFtcM.js";import{V as N}from"./VTextField-Bn35T3UG.js";import{V as be}from"./VSkeletonLoader-BkKepelc.js";import{V as J,a as K,b as q,c as _e,d as Ve}from"./VList-Cnqqz-5U.js";import{V as ve}from"./VDialog-CNptTdRK.js";import{_ as we}from"./CustomTableHeaderStatic-d1pKQ-ga.js";import{V as W}from"./VMenu-Cs322VI3.js";import{V as Se}from"./VProgressCircular-DNPB7izS.js";import{V as De}from"./VChip-CKNl8kC9.js";import{b as A}from"./route-block-B_A1xBdJ.js";import{V as ke}from"./VDataTableVirtual-Cqes2yZi.js";import{V as Ce,a as xe}from"./VToolbar-o4oksDe3.js";import"./CustomGender-C5TgvEjC.js";import"./filter-ahsWVyiP.js";import"./VInput-CRZE-Mt3.js";import"./index-C5-hvfiu.js";import"./forwardRefs--KQCZfKO.js";import"./VOverlay-BnbjS8dz.js";import"./VCheckboxBtn-DQUGWCnj.js";import"./VAvatar-l5UJO0sV.js";import"./VImg-FY_z5S7Z.js";import"./dialog-transition-Dq7CKyny.js";import"./index-CebfcyPH.js";import"./VDataTable-BrBBORsC.js";import"./VPagination-zp71F-1D.js";import"./CustomTextFieldTranslit-gE4NQy6n.js";import"./CustomPhone-Cd36n-GU.js";import"./VAutocomplete-BVJCf0KD.js";import"./data-BbwszT0d.js";import"./CustomTag-5aeppRFS.js";import"./CustomPopulationType-DQPosMme.js";import"./VAlert-Or5Mzxjd.js";import"./VCheckbox-Berrf7y1.js";/* empty css              */import"./group-DgRBM2CV.js";const Ie={name:"DistributionPocDialow",inject:["$confirm","$error","$loading","$showResult"],props:{modelValue:{type:Object,default:()=>({})},items:{type:Array,default:()=>[]}},computed:{model:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},canEdit(){var e,t,n,d,o,l;if((n=(t=(e=this.appStore)==null?void 0:e.user)==null?void 0:t.role)!=null&&n.includes("Admin")||(l=(o=(d=this.appStore)==null?void 0:d.user)==null?void 0:o.role)!=null&&l.includes("Partner Editor")||!this.model.id||new Date-new Date(this.model.date)<T.timeToEditSinceDistribution||this.model.createdAt&&new Date-new Date(this.model.createdAt)<T.timeToEditSinceCreation)return!0},dialog(){const e=document.querySelector("html"),t=Object.keys(this.model).length>0;return e.classList[t?"add":"remove"]("overflow-hidden"),t}},methods:{countFamilyStats(){this.model.familyStats=ne([...this.model.familyMembers,this.model.headOfHousehold])},formatAddress:oe,createFamilyMembersIds(){var d;const e=this.model.taxId||this.model.passport||re(),t=P(this.model,e);let n=[];return(d=this.model)!=null&&d.familyMembers&&(n=this.model.familyMembers.map(o=>P(o,e))),[t,...n]},async removeData(){if(!await this.$confirm({title:"Delete assistance",description:"Would you like to delete data about the assistance?"}))return!1;this.$loading(!0);const{assistances:t}=this.$storage;let n;try{n=await delete t[this.model.id]}catch(d){await this.$error(d)}if(this.$loading(!1),!n)return!1;await this.$showResult(),this.model=void 0,this.$emit("loadItems")},async saveData(){var n,d,o,l,m;if(!await this.$confirm({title:"Save assistance",description:"Would you like to save data about the assistance?"}))return!1;(n=this.model)!=null&&n.headOfHousehold&&(this.model.headOfHousehold=ie(this.model.headOfHousehold)),(d=this.model)!=null&&d.headOfHousehold&&this.model.household&&((l=(o=this.model)==null?void 0:o.address)!=null&&l.pCode4&&(this.model.household.pCode4=this.model.address.pCode4,this.model.household.admin4=this.model.address.admin4),this.model.household.fullAddress=this.formatAddress(this.model.household,"en"),this.model.household.translation.uk.fullAddress=this.formatAddress(this.model.household,"uk")),this.countFamilyStats(),this.model.familyMembersIds=this.createFamilyMembersIds(),this.model.taxIds=[H((m=this.model)==null?void 0:m.headOfHousehold),...(this.model.familyMembers||[]).map(H)].filter(Boolean);let t;try{const{assistances:p}=this.$storage;this.model.id||(t=await p.push(this.model)),this.model.id&&(t=await p.update(this.model.id,this.model))}catch(p){return this.$loading(!1),await this.$error(p)}this.$loading(!1),await this.$showResult(),this.model=void 0,this.$emit("loadItems")}}},Me={key:0,class:"main-part"},$e={class:"text-h5 mb-2 offset-md1 black--text"},Ue={class:"text-h5 mb-2 offset-md1 black--text"};function ze(e,t,n,d,o,l){const m=G,p=Q,V=X,S=ee,i=te,v=ae,x=se,I=le;return f(),g(L,{tile:"",class:"fill-height scroll custom-thumb pb-4"},{default:a(()=>[l.model.headOfHousehold?(f(),g(O,{key:0,style:{"font-size":"0.875rem"}},{default:a(()=>[s(m,{modelValue:l.model.headOfHousehold,"onUpdate:modelValue":t[0]||(t[0]=h=>l.model.headOfHousehold=h),onSetId:t[1]||(t[1]=h=>l.model.householdId=h),onSetFamilyMembers:t[2]||(t[2]=h=>l.model.familyMembers=h),onSetHousehold:t[3]||(t[3]=h=>l.model.household=h),id:l.model.id,householdId:l.model.id},null,8,["modelValue","id","householdId"]),l.model.id?(f(),w("div",Me,[s(p,{modelValue:l.model,"onUpdate:modelValue":t[4]||(t[4]=h=>l.model=h)},null,8,["modelValue"]),s(V,{modelValue:l.model.address,"onUpdate:modelValue":t[5]||(t[5]=h=>l.model.address=h)},null,8,["modelValue"]),l.model.headOfHousehold?(f(),g(S,{key:0,modelValue:l.model.headOfHousehold,"onUpdate:modelValue":t[6]||(t[6]=h=>l.model.headOfHousehold=h)},null,8,["modelValue"])):b("",!0),l.model.household?(f(),g(i,{key:1,modelValue:l.model.household,"onUpdate:modelValue":t[7]||(t[7]=h=>l.model.household=h),householdId:l.model.householdId},null,8,["modelValue","householdId"])):b("",!0),s(v,{modelValue:l.model.familyMembers,"onUpdate:modelValue":t[8]||(t[8]=h=>l.model.familyMembers=h)},null,8,["modelValue"]),s(x,{modelValue:l.model,"onUpdate:modelValue":t[9]||(t[9]=h=>l.model=h)},null,8,["modelValue"]),s(C,{class:"mb-4 mt-4"},{default:a(()=>[s(_,{cols:"12"},{default:a(()=>[u("div",$e,r(e.$t("Signature")),1),u("div",null,r(e.$t("Please sign the completed form")),1)]),_:1}),s(_,{cols:"12"},{default:a(()=>[s(I,{modelValue:l.model.signature,"onUpdate:modelValue":t[10]||(t[10]=h=>l.model.signature=h),mode:"edit"},null,8,["modelValue"])]),_:1})]),_:1}),s(C,{class:"mb-4 mt-4"},{default:a(()=>[s(_,{cols:"12"},{default:a(()=>[u("div",Ue,r(e.$t("Comment")),1),u("div",null,r(e.$t("You can add any additional comment")),1)]),_:1}),s(_,{cols:"12"},{default:a(()=>[s(ce,{modelValue:l.model.comment,"onUpdate:modelValue":t[11]||(t[11]=h=>l.model.comment=h),variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1})])):b("",!0)]),_:1})):b("",!0),s(R,null,{default:a(()=>[l.canEdit&&l.model.id?(f(),g(y,{key:0,onClick:l.removeData,color:"error",variant:"tonal",class:"ml-4"},{default:a(()=>[c(r(e.$t("Delete")),1)]),_:1},8,["onClick"])):b("",!0),s(j),l.canEdit?(f(),g(y,{key:1,onClick:t[12]||(t[12]=h=>this.model=void 0),color:"orange darken-2",variant:"text"},{default:a(()=>[c(r(e.$t("Cancel")),1)]),_:1})):b("",!0),l.canEdit?(f(),g(y,{key:2,onClick:l.saveData,color:"primary",variant:"tonal",class:"mr-4"},{default:a(()=>[c(r(e.$t("Save")),1)]),_:1},8,["onClick"])):b("",!0)]),_:1})]),_:1})}const Fe=M(Ie,[["render",ze]]),Oe={props:{dialog:{type:Boolean}},data(){return{loading:!1,search:void 0,items:[],selected:void 0}},methods:{setSearch(){if(this.search.length<3)return!1;this.loading=!0,this.debouncedSearch()},debouncedSearch:B(function(){this.getData()}),async getData(){if(!this.search||this.search.length<3)return!1;this.loading=!0;const{assistances:e}=this.$storage,t=await e.useIndex("taxIds").filter({taxIds:{$contains:this.search},distributionModality:["Cash","Voucher"]}).sort("date").reverse().slice(0,20).find();this.items=t.items,this.loading=!1},getTaxId(e){const t=this.search.replace(/[^А-ЯA-Z\d ]/g,""),n=e.filter(d=>d.match(t))[0];return n?n.replace(t,`<span class="highlight">${t}</span>`):""}}},Le={class:"ms-2"},Be={class:"pa-3"},Ne={key:0,class:"pa-3 h-100 d-flex flex-column align-center justify-center"},Te={key:1,class:"pa-3 h-100 d-flex flex-column align-center justify-center text-center"},He=["innerHTML"],Pe={class:"small mt-1 mb-1 text-primary"};function Ae(e,t,n,d,o,l){const m=Fe;return f(),g(ve,{modelValue:n.dialog,"onUpdate:modelValue":t[3]||(t[3]=p=>e.$emit("close",p)),class:"import-dialog",fullscreen:"",overlay:""},{default:a(()=>[s(fe,{style:{position:"relative"},ref:"dialogHeight"},{default:a(()=>[s(ye,{window:"",color:"primary",style:{top:"0px"},class:"d-flex justify-space-between"},{default:a(()=>[u("span",Le,r(e.$t("Search cash assistance")),1),s(U,{onClick:t[0]||(t[0]=p=>this.$emit("close")),color:"white",icon:"mdi-close",class:"ms-2 text-white cursor-pointer"})]),_:1}),s(Y,{class:"h-100 d-flex flex-column pa-lg-4",fluid:""},{default:a(()=>[s(C,{class:"h-100 mt-4"},{default:a(()=>[s(_,{md:"3",cols:"12",class:"h-100-overflow d-flex flex-column pa-0"},{default:a(()=>{var p,V,S;return[u("div",Be,[s(N,{modelValue:o.search,"onUpdate:modelValue":[t[1]||(t[1]=i=>o.search=i),l.setSearch],label:e.$t("Search by tax ID"),"prepend-inner-icon":"mdi-magnify",variant:"underlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue","label"])]),D(u("div",null,[s(be,{class:"mx-auto","max-width":"400",type:"list-item-three-line"})],512),[[k,o.loading]]),!o.loading&&((p=o.search)==null?void 0:p.length)>2&&!o.items.length?(f(),w("div",Ne,r(e.$t("Nothing found for your query")),1)):b("",!0),!o.loading&&!o.search||((V=o.search)==null?void 0:V.length)<3?(f(),w("div",Te,r(e.$t("To search for beneficiaries, enter at least 3 characters from the RNOKPP or passport number")),1)):b("",!0),D(s(J,{class:"custom-thumb",lines:"three","item-props":""},{default:a(()=>[(f(!0),w(z,null,F(o.items,i=>{var v;return f(),g(K,{onClick:x=>o.selected=i,active:((v=o.selected)==null?void 0:v.id)===i.id,class:"pt-2 pb-2 underlined"},{default:a(()=>[s(q,null,{default:a(()=>[u("strong",{class:"small",innerHTML:l.getTaxId(i.taxIds)},null,8,He)]),_:2},1024),s(_e,null,{default:a(()=>[u("div",Pe,r(new Date(i.date).toLocaleString("uk",{day:"numeric",month:"numeric",year:"numeric"}))+" · "+r(i.value)+" "+r(i.currency),1),u("div",null,r(e.$t(i.bundleName)),1)]),_:2},1024)]),_:2},1032,["onClick","active"])}),256))]),_:1},512),[[k,!o.loading&&((S=o.search)==null?void 0:S.length)>2]])]}),_:1}),s(_,{md:"9",cols:"12",class:"bg-grey-lighten-3 h-100 ma-0 pa-2"},{default:a(()=>{var p;return[o.selected?(f(),g(m,{modelValue:o.selected,"onUpdate:modelValue":t[2]||(t[2]=V=>o.selected=V),key:(p=o.selected)==null?void 0:p.id,onLoadItems:l.getData},null,8,["modelValue","onLoadItems"])):b("",!0)]}),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1},8,["modelValue"])}const Ee=M(Oe,[["render",Ae]]),Re={name:"Date",props:{modelValue:{type:[String,Date]},max:{type:Date},min:{type:Date},label:{type:String,default:"Date"},hint:{type:String},persistentHint:{type:Boolean},clearable:{type:Boolean}},mounted(){this.model&&(this.date=new Date(this.model).toLocaleDateString("sv-SE"))},data(){return{year:void 0,currentMode:"year",showCalendar:!1}},computed:{model:{get(){if(this.modelValue)return new Date(this.modelValue)},set(e){return!1}},date:{get(){if(this.model)return new Date(this.model).toLocaleString("sv").substring(0,10)},set(e){if(!e)return this.model=e;e.match(/^\d{4}-\d{2}-\d{2}$/)&&(this.model=e)}},maxDate(){if(this.max)return new Date(this.max).toLocaleDateString("sv")},minDate(){if(this.min)return this.min.toLocaleDateString("sv")}},methods:{setMonth(e){const t=new Date(this.year,e,1);this.$emit("update:modelValue",t),this.currentMode="year",this.showCalendar=!1},setYear(e){this.year=e,this.currentMode="months"}}};function je(e,t,n,d,o,l){return f(),g(W,{modelValue:o.showCalendar,"onUpdate:modelValue":t[1]||(t[1]=m=>o.showCalendar=m),"close-on-content-click":!1,"min-width":400,"min-height":600},{activator:a(({props:m})=>[s(y,de(m,{width:"170",color:"primary",variant:"text"}),{default:a(()=>[me(e.$slots,"default")]),_:2},1040)]),default:a(()=>[s(pe,{locale:e.$i18n.locale},{default:a(()=>[s(ge,{modelValue:l.model,"onUpdate:modelValue":t[0]||(t[0]=m=>l.model=m),"view-mode":o.currentMode,"onUpdate:month":l.setMonth,"onUpdate:year":l.setYear,title:e.$t("Select date"),max:l.maxDate,min:l.minDate,header:e.$t("Select date"),locale:e.$i18n.locale,color:"primary",format:"yyyy-mm-dd","input-text":"yyyy-mm-dd"},null,8,["modelValue","view-mode","onUpdate:month","onUpdate:year","title","max","min","header","locale"])]),_:1},8,["locale"])]),_:3},8,["modelValue"])}const Ye=M(Re,[["render",je]]),$=e=>{const[t,n]=e.split(/\./g);return n==="0"||t.length===3?t:e},Je=e=>e/10**9>1?$((e/10**9).toFixed(1))+"B":e/10**6>1?$((e/10**6).toFixed(1))+"M":e/10**3>1?$((e/10**3).toFixed(1))+"K":e,Ke={name:"CustomCashFilterButton",props:{organization:{type:Object,default(){return{}}},date:{type:Date,default:new Date}},data(){return{loading:!1,search:void 0,items:[],menu:!1}},computed:{title(){if(this.$i18n.locale==="en")return"organization.name";if(this.$i18n.locale!=="en")return["organization.translation",this.$i18n.locale,"name"].join(".")},key(){return"organization.id"},showItems(){if(!this.search)return this.items;const e=new RegExp(this.search.replace(/[|\\{}()[\]^$+*?.]/g,".").replace(/-/g,"\\-"),"gi");return this.items.filter(t=>value.match(e))}},methods:{setSearch:B(function(){if(!this.menu)return!1;this.loadItems()}),async loadItems(){this.loading=!0;let{assistances:e}=this.$storage;e=e.useIndex("date");const t=new Date(this.date.getFullYear(),this.date.getMonth(),1,1),n=new Date(this.date.getFullYear(),this.date.getMonth()+1,1),d={date:{$gte:t,$lte:n},distributionModality:["Cash","Voucher"]};e=e.filter(d),this.search&&(e=e.should({[this.title]:{$regex:this.search}})),e=e.sort([{value:"desc"},{[this.key]:"asc"}]);const o={groupBy:[this.key,"organization.name",["organization.translation",this.$i18n.locale,"name"].join(".")],aggs:{value:{variable:"id",operation:"count"}}};let l=await e.aggregate(o);l=l.map(m=>(m.key||(m.key=m[this.key],m.title=m[this.title]),m)),l.map(m=>m.key),this.items=l,this.loading=!1},switchFilter(e){const{organization:t}=E.object(e);t.id=e.key,this.$emit("setFilter",t)},simplifyCount:Je},watch:{menu(e){e&&this.loadItems()}}},qe={class:"mb-2"},We={class:"text-center"};function Ze(e,t,n,d,o,l){return f(),g(y,{color:"primary",variant:"text"},{default:a(()=>[c(r(n.organization.name)+" ",1),s(W,{activator:"parent",transition:"slide-y-transition","close-on-content-click":!1,modelValue:o.menu,"onUpdate:modelValue":t[2]||(t[2]=m=>o.menu=m)},{default:a(()=>[s(L,{"max-width":"350",width:"350"},{default:a(()=>[s(O,{class:"pa-0"},{default:a(()=>[s(Y,null,{default:a(()=>[s(C,null,{default:a(()=>[s(_,{cols:"12"},{default:a(()=>[u("div",qe,[u("strong",null,r(e.$t("Filter").toUpperCase()),1)]),s(N,{modelValue:o.search,"onUpdate:modelValue":t[0]||(t[0]=m=>o.search=m),label:e.$t("Search"),variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue","label"])]),_:1}),s(_,{cols:"12",class:"pa-0"},{default:a(()=>[D(u("div",We,[s(Se,{indeterminate:"",color:"primary"})],512),[[k,o.loading]]),D(s(J,{class:"custom-thumb",nav:"",density:"compact",lines:!1,"max-height":"200"},{default:a(()=>[(f(!0),w(z,null,F(l.showItems,m=>(f(),g(K,{onClick:p=>l.switchFilter(m),key:m.key,density:"compact"},{append:a(()=>[s(De,{size:"x-small"},{default:a(()=>[c(r(l.simplifyCount(m.value)),1)]),_:2},1024)]),default:a(()=>[s(q,{class:"pr-2"},{default:a(()=>[c(r(m==null?void 0:m.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1},512),[[k,!o.loading]])]),_:1})]),_:1})]),_:1})]),_:1}),s(R,null,{default:a(()=>[s(j),s(y,{onClick:t[1]||(t[1]=m=>o.menu=!1),size:"x-small"},{default:a(()=>[c(r(e.$t("Close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const Ge=M(Ke,[["render",Ze]]),Z={name:"manage-cash",computed:{filters(){var n;const e=new Date(this.date.getFullYear(),this.date.getMonth(),1,1),t=new Date(this.date.getFullYear(),this.date.getMonth()+1,1);return{...this.currentFilters,"organization.id":(n=this.organization)==null?void 0:n.id,date:{$gte:e,$lte:t}}},filteredData(){let e=JSON.parse(JSON.stringify(this.items));if(e=e.map(n=>{var o;const d=JSON.parse(JSON.stringify(n));return(o=d==null?void 0:d.address)!=null&&o.pCode4&&(d.address.admin1=this.$t(d.address.pCode4.substring(0,4),this.$i18n.locale),d.address.admin2=this.$t(d.address.pCode4.substring(0,6),this.$i18n.locale),d.address.admin3=this.$t(d.address.pCode4.substring(0,9),this.$i18n.locale),d.address.admin4=this.$t(d.address.pCode4,this.$i18n.locale)),d}),this.datatable.search){const n=new RegExp(this.datatable.search.replace(/[.?*{}\[\]()<>]/g,""),"gi");e=e.filter(d=>JSON.stringify(d).match(n))}const t=Object.entries(this.datatable.filters);return t.length&&(e=e.filter(n=>{for(const[d,o]of t)if(!o.includes(he(d,n)))return!1;return!0})),e}},data(){return{search:void 0,index:"publicId",datatable:{search:"",searchKeys:[],start:void 0,end:void 0,filters:{},sortBy:[{date:"asc"}]},loading:!1,searchDialog:!1,organization:void 0,date:new Date,month:void 0,items:[],groupBy:["date","organization.name","distributionModality","address.pCode4","bundleName","populationType"],aggs:{"familyStats.households":{variable:"id",operation:"count"},"familyStats.all":{variable:"familyStats.all",operation:"sum"},value:{variable:"value",operation:"sum"}},currentFilters:{distributionModality:["Cash","Voucher"]},headers:[{title:"View",align:"center",value:"id"},{title:"Date",align:"start",value:"date",sortable:!0},{title:"Bundle name",align:"start",value:"bundleName",sortable:!0,filterable:!0,type:"term"},{title:"Modality",align:"start",value:"distributionModality",sortable:!0,filterable:!0,type:"term"},{title:"Oblast",align:"start",value:"address.admin1",sortable:!0,filterable:!0,type:"term"},{title:"Raion",align:"start",value:"address.admin2",sortable:!0,filterable:!0,type:"term"},{title:"Hromada",align:"start",value:"address.admin3",sortable:!0,filterable:!0,type:"term"},{title:"Locality",align:"start",value:"address.admin4",sortable:!0,filterable:!0,type:"term"},{title:"Population type",align:"start",value:"populationType",filterable:!0,type:"term"},{title:"Households",align:"start",value:"familyStats.households",sortable:!0,align:"end"},{title:"Individuals",align:"start",value:"familyStats.all",sortable:!0,align:"end"},{title:"Value",align:"start",value:"value",sortable:!0,sortable:!0,align:"end"},{title:"Organization",align:"start",value:"organization",sortable:!0}]}},created(){this.organization=this.appStore.user.organization,this.appStore.loading=!1,this.loadItems()},methods:{setSearch:B(function(e){this.datatable.search=e}),async loadItems(){this.loading=!0;let{assistances:e}=this.$storage;e=e.useIndex("date"),e.filter(this.filters);let t=await e.aggregate({groupBy:this.groupBy,aggs:this.aggs});t=t.map(n=>E.object(n)),this.items=t,this.loading=!1},setFilter(e){this.datatable.filters=e},nextMonth(){this.date=new Date(new Date(this.date).setMonth(this.date.getMonth()+1)),this.loadItems()},prevMonth(){this.date=new Date(new Date(this.date).setMonth(this.date.getMonth()-1)),this.loadItems()},formatNumber(e){return new Intl.NumberFormat("fr-FR").format(e)},createURL(e){const t=ue(e,["date","bundleName","distributionModality","populationType"]);return t.pCode4=e.address.pCode4,typeof t.date=="number"&&(t.date=new Date(t.date).toLocaleDateString("sv-SE")),`/cash/view?${new URLSearchParams(t).toString()}`}},watch:{"$i18n.locale"(){this.datatable.filters={}}}},Qe={class:"distribution-points pa-2"},Xe={class:"text-h4 font-weight-bold"},et={class:"w-100"},tt={class:"bg-grey-lighten-4 d-inline-block mr-4"},at={class:"bg-grey-lighten-4 d-inline-block"},lt={class:"flex-shrink-0"},st={class:"text-no-wrap"},ot={class:"text-no-wrap"},it={class:"text-no-wrap"},rt={class:"text-no-wrap"},nt={class:"text-no-wrap"};function dt(e,t,n,d,o,l){const m=Ge,p=Ye,V=we,S=Ee;return f(),w("div",Qe,[s(C,{class:"mb-0 mt-0"},{default:a(()=>[s(_,{cols:"12",md:"12",class:"mb-0 mt-0 pb-4 pt-0 pl-md-8 pr-md-8"},{default:a(()=>[u("div",Xe,r(e.$t("Cash interventions")),1)]),_:1})]),_:1}),s(C,{class:"mb-0 mt-0"},{default:a(()=>[s(_,{cols:"12",md:"12",class:"mb-0 mt-0 pb-0 pt-0 pl-md-8 pr-md-8"},{default:a(()=>[s(L,null,{default:a(()=>[s(O,{class:"mb-0 pb-0 ml-2 pr-8 d-flex w-100"},{default:a(()=>[u("div",et,[u("div",tt,[s(m,{onSetFilter:t[0]||(t[0]=i=>o.organization=i),date:o.date,organization:o.organization},null,8,["date","organization"])]),u("div",at,[s(y,{onClick:l.prevMonth,color:"primary",variant:"text"},{default:a(()=>[s(U,null,{default:a(()=>t[12]||(t[12]=[c("mdi-chevron-left")])),_:1})]),_:1},8,["onClick"]),s(p,{modelValue:o.date,"onUpdate:modelValue":[t[1]||(t[1]=i=>o.date=i),l.loadItems],color:"primary",variant:"text"},{default:a(()=>[c(r(o.date.toLocaleDateString(this.$i18n.locale,{timeZone:"Europe/Kyiv",month:"long",year:"numeric"})),1)]),_:1},8,["modelValue","onUpdate:modelValue"]),s(y,{onClick:l.nextMonth,color:"primary",variant:"text"},{default:a(()=>[s(U,null,{default:a(()=>t[13]||(t[13]=[c("mdi-chevron-right")])),_:1})]),_:1},8,["onClick"])]),s(y,{onClick:t[2]||(t[2]=i=>o.searchDialog=!0),color:"primary",variant:"tonal","prepend-icon":"mdi-magnify",class:"ml-4"},{default:a(()=>[c(r(e.$t("Search")),1)]),_:1})]),u("div",lt,[s(y,{onClick:t[3]||(t[3]=i=>e.$router.push("/cash/delete")),color:"error",variant:"flat","prepend-icon":"mdi-delete",class:"mr-4"},{default:a(()=>[c(r(e.$t("Delete")),1)]),_:1}),s(y,{onClick:t[4]||(t[4]=i=>e.$router.push("/cash/new")),color:"primary",variant:"flat","prepend-icon":"mdi-plus"},{default:a(()=>[c(r(e.$t("Add")),1)]),_:1})])]),_:1})]),_:1}),s(ke,{"sort-by":o.datatable.sortBy,"onUpdate:sortBy":t[8]||(t[8]=i=>o.datatable.sortBy=i),"items-per-page":0,height:e.$vuetify.display.height-390<320?320:e.$vuetify.display.height-390,headers:o.headers,items:l.filteredData,loading:o.loading,"loading-text":e.$t("Loading... Please wait"),"items-per-page-text":e.$t("Records per page"),"item-value":"_id","hide-default-footer":""},{top:a(()=>[D(s(Ce,{flat:"",color:"white"},{default:a(()=>[s(xe,{style:{"min-width":"150px"}},{default:a(()=>[c(r(e.$t("Summary")),1)]),_:1}),s(Ve,{class:"mx-4",inset:"",vertical:""}),s(N,{modelValue:o.search,"onUpdate:modelValue":[t[5]||(t[5]=i=>o.search=i),l.setSearch],label:e.$t("Search"),variant:"outlined",density:"compact","prepend-icon":"mdi-magnify","hide-details":"",class:"mr-4 w-100",clearable:""},null,8,["modelValue","onUpdate:modelValue","label"])]),_:1},512),[[k,!e.$vuetify.display.xs]])]),headers:a(({columns:i,toggleSort:v})=>[u("tr",null,[(f(!0),w(z,null,F(i,x=>(f(),g(V,{key:x.key,onSetSort:t[6]||(t[6]=I=>o.datatable.sortBy=[I]),onSetFilter:t[7]||(t[7]=I=>l.setFilter(I)),column:x,"parent-items":l.filteredData,datatable:o.datatable},null,8,["column","parent-items","datatable"]))),128))])]),"item.date":a(({item:i})=>[u("span",st,r(new Date(i.date).toLocaleDateString("uk")),1)]),"item.bundleName":a(({item:i})=>[u("span",ot,r(e.$t(i.bundleName)),1)]),"item.distributionModality":a(({item:i})=>[u("span",it,r(e.$t(i.distributionModality)),1)]),"item.populationType":a(({item:i})=>[u("span",rt,r(e.$t(i.populationType)),1)]),"item.organization":a(({item:i})=>{var v;return[u("span",nt,r((v=i.organization)==null?void 0:v.name),1)]}),"item.address.admin1":a(({item:i})=>[c(r(i.address.admin1),1)]),"item.address.admin2":a(({item:i})=>[c(r(i.address.admin2),1)]),"item.address.admin3":a(({item:i})=>[c(r(i.address.admin3),1)]),"item.address.admin4":a(({item:i})=>[c(r(i.address.admin4),1)]),"item.familyStats.all":a(({item:i})=>[c(r(l.formatNumber(i.familyStats.all)),1)]),"item.familyStats.households":a(({item:i})=>[c(r(l.formatNumber(i.familyStats.households)),1)]),"item.value":a(({item:i})=>[c(r(l.formatNumber(i.value)),1)]),"item.id":a(({item:i})=>[s(y,{to:l.createURL(i),color:"grey-dakren-2",variant:"tonal",rounded:"1",icon:"mdi-magnify",size:"x-small"},null,8,["to"])]),"no-data":a(()=>[u("div",null,r(e.$t("No data found")),1)]),_:2},1032,["sort-by","height","headers","items","loading","loading-text","items-per-page-text"])]),_:1})]),_:1}),D(s(y,{onClick:t[9]||(t[9]=i=>e.$router.push("/cash/new")),style:{position:"fixed",bottom:"15px",right:"15px"},color:"primary",rounded:"1",icon:"mdi-plus",size:"large"},null,512),[[k,e.$vuetify.display.xs]]),s(S,{modelValue:o.searchDialog,"onUpdate:modelValue":t[10]||(t[10]=i=>o.searchDialog=i),onClose:t[11]||(t[11]=i=>o.searchDialog=!1)},null,8,["modelValue"])])}typeof A=="function"&&A(Z);const sa=M(Z,[["render",dt]]);export{sa as default};
