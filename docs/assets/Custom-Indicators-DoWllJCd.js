import{_ as M}from"./ReportsIndicators-VUt3YENQ.js";import{_ as S}from"./CustomDate-BvE_k-Ie.js";import{_}from"./CustomBundle-pHbbXnxx.js";import{_ as D,a5 as C,ab as v,F as O,a as o,w as l,o as V,z as h,A as g,C as b}from"./index-BYWsBYtF.js";import{b as N}from"./route-block-B_A1xBdJ.js";import{a as y,V as f}from"./VRow-D5QUgmxK.js";import{V as w,a as E}from"./VCard-C8It3tDs.js";import{V as $}from"./VChip-BnTEbD1P.js";import"./CustomTableHeaderStatic--V9Vxjnk.js";import"./debouncer-Whu4ZLob.js";import"./index-CqdMy8lr.js";import"./VMenu-BAWQ3Wct.js";import"./VOverlay-uyg0Ioz0.js";import"./forwardRefs-D3j0TLhE.js";import"./dialog-transition-CdzLxCw9.js";import"./VBtn-DEU8AXzn.js";import"./group-BcbT0sDe.js";import"./VContainer-rOsYQHyZ.js";/* empty css              */import"./VTextField-CLSPMm7c.js";import"./index-bmXFo_Al.js";import"./VInput-CwTs2RKk.js";import"./VImg-wiXIkP7s.js";import"./VList-wnBQ6eUC.js";import"./VAvatar-Bm8XvpvO.js";import"./VSpacer-D4hnwTqC.js";import"./index-D0pvfY44.js";import"./VDataTableVirtual-BO58bCzO.js";import"./VDataTable-DS7yi-Dm.js";import"./VPagination-BBLVO-bG.js";import"./filter-5KaMYqe0.js";import"./VCheckboxBtn-B1hdxoeT.js";import"./VToolbar-Jw3O4Zrq.js";import"./VTooltip-CKohhaj7.js";const d=["organization.name","date$month","address.pCode4","collectiveCenter.name","collectiveCenter.code","populationType"],u={households:{operation:"count",variable:"id"},familySize:{variable:"familyMembersIds",operation:"countDistinct"},girls:{variable:"familyMembersIds",filter:"Female;(children|NA)",operation:"countDistinct"},boys:{variable:"familyMembersIds",filter:"Male;(children|NA)",operation:"countDistinct"},women:{variable:"familyMembersIds",filter:"Female;adult",operation:"countDistinct"},men:{variable:"familyMembersIds",filter:"Male;adult",operation:"countDistinct"},seniorWomen:{variable:"familyMembersIds",filter:"Female;senior",operation:"countDistinct"},seniorMen:{variable:"familyMembersIds",filter:"Male;senior",operation:"countDistinct"},disabled:{variable:"familyMembersIds",filter:";DS",operation:"countDistinct"}},k={"SN101-2024":[async(e,a)=>{const t="Output 10M – War-affected population supported with immediate shelter needs",r="# of households supported with emergency shelter kits",{assistances:n}=e;let s=await n.useIndex("bundleName").filter({...a,items:{$nested:{key:["Emergency Shelter Kit"],value:{$gt:0}}}}).aggregate({groupBy:d,aggs:u});return s=s.map(i=>({...i,indicator:r,output:t,distributionModality:"Partner"})),s},async(e,a)=>{const t="Output 10M – War-affected population supported with immediate shelter needs",r="# of households supported with emergency shelter kits and emergency shelter materials",{assistances:n}=e;let s=await n.useIndex("bundleName").filter({...a,items:{$nested:{key:["Tarpaulin (separate)","Transparent plastic sheeting, 3x10m (separate)","OSB (separate)"],value:{$gt:0}}}}).should([{items:{$nested:{key:["Emergency Shelter Kit"],value:{$gt:0}}}}]).aggregate({groupBy:d,aggs:u});return s=s.map(i=>({...i,indicator:r,output:t,distributionModality:"Partner"})),s},async(e,a)=>{const t="Output 10M – War-affected population supported with immediate shelter needs",r="# of households supported with emergency shelter materials",{assistances:n}=e;let s=await n.useIndex("bundleName").filter({...a,items:{$nested:{key:["Tarpaulin (separate)","Transparent plastic sheeting, 3x10m (separate)","OSB (separate)"],value:{$gt:0}}}}).should([{items:{$nested:{key:{$isNotOneOf:["Emergency Shelter Kit"]}}}},{items:{$nested:{key:["Emergency Shelter Kit"],value:{$eq:0}}}}]).aggregate({groupBy:d,aggs:u});return s=s.map(i=>({...i,indicator:r,output:t,distributionModality:"Partner"})),s},async(e,a)=>{const t="Output 10M – War-affected population supported with immediate shelter needs",r="# of households supported with installation of emergency shelter materials or ESK",{assistances:n}=e;let s=await n.useIndex("bundleName").filter({...a,strings:{$nested:{key:["Assistance status"],value:{$eq:"Assisted by partner"}}}}).aggregate({groupBy:d,aggs:u});return s=s.map(i=>({...i,indicator:r,output:t,distributionModality:"Partner"})),s}],"SN104-2024":[async(e,a)=>{const t="Output 10K – Emergency response provided to help people meet their basic needs",r="# of elderly receiving incontinence items",{households:n,seniorMen:s,seniorWomen:i}=u,{assistances:m}=e;let p=await m.useIndex("bundleName").filter({...a,items:{$nested:{key:["Adult diapers"],value:{$gt:0}}}}).aggregate({groupBy:d,aggs:{households:n,seniorMen:s,seniorWomen:i}});return p=p.map(c=>({...c,indicator:r,output:t,distributionModality:"Partner"})),p},async(e,a)=>{const t="Output 10K – Emergency response provided to help people meet their basic needs",r="# of households receiving non-standard NFIs",{assistances:n}=e;let s=await n.useIndex("bundleName").filter({...a,items:{$nested:{key:["Adult diapers","Baby diapers","Beds","Buckets","Folding beds","Inflated mats","Partition","Other"],value:{$gt:0}}}}).aggregate({groupBy:d,aggs:u});return s=s.map(i=>({...i,indicator:r,output:t,distributionModality:"Partner"})),s},async(e,a)=>{const t="Output 10K – Emergency response provided to help people meet their basic needs",r="# of households supported with heating appliances (in-kind)",{assistances:n}=e;let s=await n.useIndex("bundleName").filter({...a,items:{$nested:{key:["Heaters"],value:{$gt:0}}}}).aggregate({groupBy:d,aggs:u});return s=s.map(i=>({...i,indicator:r,output:t,distributionModality:"Partner"})),s},async(e,a)=>{const t="Output 10K – Emergency response provided to help people meet their basic needs",r="# of people receiving hygiene packs/kits",{assistances:n}=e;let s=await n.useIndex("bundleName").filter({...a,items:{$nested:{key:["Hygiene kit"],value:{$gt:0}}}}).aggregate({groupBy:d,aggs:u});return s=s.map(i=>({...i,indicator:r,output:t,distributionModality:"Partner"})),s},async(e,a)=>{const t="Output 10K – Emergency response provided to help people meet their basic needs",r="# of people receiving other items (clothes, shoes, etc.)",{assistances:n}=e;let s=await n.useIndex("bundleName").filter({...a,items:{$nested:{key:["Clothes/Shoes","Clothes","Shoes"],value:{$gt:0}}}}).aggregate({groupBy:d,aggs:u});return s=s.map(i=>({...i,indicator:r,output:t,distributionModality:"Partner"})),s},async(e,a)=>{const t="Output 10K – Emergency response provided to help people meet their basic needs",r="# of households receiving UNHCR standard non-food items (Kit)",{assistances:n}=e;let s=await n.useIndex("bundleName").filter({...a,items:{$nested:{key:["NFI kit"],value:{$gt:0}}}}).aggregate({groupBy:d,aggs:u});return s=s.map(i=>({...i,indicator:r,output:t,distributionModality:"Partner"})),s},async(e,a)=>{const t="Output 10K – Emergency response provided to help people meet their basic needs",r="# of households receiving UNHCR standard non-food items (Non-Kit)",{assistances:n}=e;let s=await n.useIndex("bundleName").filter({...a,items:{$nested:{key:["Bed linen set","Towels","Blankets/Quilts","Jerrycans","Kitchen set","Mattress","Pillow","Reinforced bag","Sleeping bag","Solar / Power bank lamp","Thermos"],value:{$gt:0}}}}).should([{items:{$nested:{key:["NFI kit"],value:{$lte:0}}}}]).aggregate({groupBy:d,aggs:u});return s=s.map(i=>({...i,indicator:r,output:t,distributionModality:"Partner"})),s}]},I={name:"custom-indicators",beforeMount(){var a,t;const e=localStorage.getItem("unhcr-rais-plus-recent-indicators");e||(this.filters={date:{$gte:new Date().toLocaleDateString("sv-SE").replace(/-\d+$/,"-01"),$lte:new Date().toLocaleDateString("sv-SE")}}),this.organizations=[(t=(a=this.appStore)==null?void 0:a.user)==null?void 0:t.organization].filter(Boolean),e&&Object.assign(this.filters,JSON.parse(e)),this.getFiltersData(),this.appStore.loading=!1},computed:{isAdmin(){var e,a,t;return(t=(a=(e=this.appStore)==null?void 0:e.user)==null?void 0:a.role)==null?void 0:t.includes("Admin")}},data:()=>({organizations:[],filters:{bundleName:"SN101-2024",date:{$lte:void 0,$gte:void 0}},indicators:[],indicatorsLoading:!0}),methods:{async getFiltersData(){const{organizations:e}=this.$storage,a=await e.slice(0,500).filter({functionalType:["UN Agency","Operational partner","Implementing partner"]}).include(["id","name","translation.uk.name"]).sort([{name:"asc"}]).find();this.organizations=a.items},async getIndicators(){if(this.indicatorsLoading=!0,!this.filters.bundleName||!k[this.filters.bundleName])return this.indicators=[],this.indicatorsLoading=!1;let e;try{e=await Promise.all(k[this.filters.bundleName].map(t=>t(this.$storage,this.filters)))}catch(t){console.log(t)}const a=e.flat().map(t=>{var r,n,s,i,m,p;return t=C.object(t),t.items&&(t.items=v(t.items)),t.strings&&(t.strings=v(t.strings)),t.address.pCode1=(n=(r=t.address)==null?void 0:r.pCode4)==null?void 0:n.substring(0,4),t.address.pCode2=(i=(s=t.address)==null?void 0:s.pCode4)==null?void 0:i.substring(0,6),t.address.pCode3=(p=(m=t.address)==null?void 0:m.pCode4)==null?void 0:p.substring(0,9),t});this.indicators=a,this.indicatorsLoading=!1},getData(){this.getIndicators()}},watch:{filters:{deep:!0,handler(e){localStorage.setItem("unhcr-rais-plus-recent-indicators",JSON.stringify(e)),this.getData()}}}},K={class:"indicators pa-2"},P={class:"text-h5 mb-2 offset-md1 black--text"},B={class:"mb-4"},A={class:"text-h5 mb-2 offset-md1 black--text"};function F(e,a,t,r,n,s){const i=_,m=S,p=M;return V(),O("div",K,[o(y,{class:"mb-0 mt-0"},{default:l(()=>[o(f,{cols:"12",md:"12",class:"mb-0 mt-0 pb-0 pt-0"},{default:l(()=>[o(w,null,{default:l(()=>[o(E,null,{default:l(()=>[o(y,null,{default:l(()=>[o(f,{cols:"12",md:"3",class:"pl-md-4"},{default:l(()=>[h("div",P,g(e.$t("Filters")),1),h("div",B,g(e.$t("Define the filters for your report")),1),h("div",null,[o(i,{modelValue:e.filters.bundleName,"onUpdate:modelValue":a[0]||(a[0]=c=>e.filters.bundleName=c)},null,8,["modelValue"]),o(m,{modelValue:e.filters.date.$gte,"onUpdate:modelValue":a[1]||(a[1]=c=>e.filters.date.$gte=c),label:e.$t("Start of report period"),class:"mt-4"},null,8,["modelValue","label"]),o(m,{modelValue:e.filters.date.$lte,"onUpdate:modelValue":a[2]||(a[2]=c=>e.filters.date.$lte=c),label:e.$t("End of report period")},null,8,["modelValue","label"])])]),_:1}),o(f,{cols:"12",md:"9",class:"pr-md-4"},{default:l(()=>[o(y,null,{default:l(()=>[o(f,{cols:"12"},{default:l(()=>[o($,{link:"",to:"/reports",class:"mr-2"},{default:l(()=>[b(g(e.$t("Summaries")),1)]),_:1}),o($,{link:"",to:"/indicators",class:"mr-2"},{default:l(()=>[b(g(e.$t("Indicators")),1)]),_:1}),o($,{color:"primary"},{default:l(()=>[b(g(e.$t("Custom indicators")),1)]),_:1})]),_:1}),o(f,{cols:"12"},{default:l(()=>[h("div",A,g(e.$t("Custom indicators")),1)]),_:1}),o(f,null,{default:l(()=>[o(p,{data:e.indicators,filters:e.filters,startDate:e.filters.date.$gte,endDate:e.filters.date.$lte,loading:e.indicatorsLoading},null,8,["data","filters","startDate","endDate","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}typeof N=="function"&&N(I);const ye=D(I,[["render",F]]);export{ye as default};
